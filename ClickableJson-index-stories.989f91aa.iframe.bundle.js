"use strict";(self.webpackChunkclickable_json=self.webpackChunkclickable_json||[]).push([[922],{"./src/ClickableJson/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FormalAndCompact:()=>FormalAndCompact,Interactive:()=>Interactive,InteractiveEmpty:()=>InteractiveEmpty,InteractiveLarge:()=>InteractiveLarge,Post:()=>Post,Primary:()=>Primary,Readonly:()=>Readonly,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("./node_modules/react/index.js"),useClickAway=__webpack_require__("./node_modules/react-use/lib/useClickAway.js"),useMountedState=__webpack_require__("./node_modules/react-use/lib/useMountedState.js");const context=react.createContext({hoverPointer:null,setHoverPointer:()=>{},activePointer:null,setActivePointer:()=>{},isInputFocused:!1});var lib=__webpack_require__("./node_modules/use-t/lib/index.js"),iconista_lib=__webpack_require__("./node_modules/iconista/lib/index.js"),nano_theme_lib=__webpack_require__("./node_modules/nano-theme/lib/index.js");const blue=nano_theme_lib.theme.color.sem.blue[0],negative=nano_theme_lib.theme.color.sem.negative[0],block=(0,nano_theme_lib.rule)({d:"inline-block",ff:"monospace",col:nano_theme_lib.theme.g(.1)}),object=(0,nano_theme_lib.rule)({pos:"relative",d:"inline-block"}),ValueColor={nil:[nano_theme_lib.theme.g(.6),nano_theme_lib.darkTheme.g(.6)],str:["#CC2336","#CC2336"],bool:["#411888","#9168c8"],num:["#0a8F3F","#0FaF4F"],float:["#015833","#51a883"]},css_property=((0,nano_theme_lib.rule)({col:"#E84D3D"}),(0,nano_theme_lib.rule)({pad:"0",fw:"bold"})),activeInput={col:nano_theme_lib.theme.g(.2),pad:"5px",bg:nano_theme_lib.theme.bg,bd:`1px solid ${nano_theme_lib.theme.g(.7)}`,mar:"-6px",out:0},input=(0,nano_theme_lib.rule)({z:2,pos:"relative",bd:0,mar:0,pad:0,bg:"transparent",bdrad:"5px",d:"inline-block",minW:"auto",w:"auto","&:focus":activeInput}),inputActive=(0,nano_theme_lib.rule)(activeInput),colon=(0,nano_theme_lib.rule)({pad:"0 8px 0 0px","&>span":{pad:"0 2px"},"&:hover":{"&>span":{out:`1px dotted ${blue}`}}}),list=(0,nano_theme_lib.rule)({d:"block",listStyleType:"none",pad:0,mar:"0 0 0 32px"}),line=(0,nano_theme_lib.rule)({d:"block",listStyle:"none",pad:0,mar:0}),lineInner=(0,nano_theme_lib.rule)({d:"inline-block"}),hoverable=(0,nano_theme_lib.rule)({bxz:"border-box",pad:"3px",bdrad:"3px",trs:"background-color .3s ease-out"}),hoverableCompact=(0,nano_theme_lib.rule)({pad:"1px 3px"}),hovered=(0,nano_theme_lib.rule)({bgc:nano_theme_lib.theme.blue(.1)}),active=(0,nano_theme_lib.rule)({out:`1px dotted ${blue}`,pos:"relative"}),collapser=(0,nano_theme_lib.rule)({pad:"0 6px",pos:"absolute",top:"0px",left:"-24px",cur:"default",userSelect:"none"}),css_collapsed=(0,nano_theme_lib.rule)({col:blue}),bracketHovered=(0,nano_theme_lib.rule)({out:`1px dotted ${blue}`}),insArrBlock=(0,nano_theme_lib.rule)({pos:"relative",h:"0px",w:"0px"}),insArrDot=(0,nano_theme_lib.rule)({pos:"absolute",top:"0px",left:"-4px",w:"3px",h:"3px",bdrad:"50%",bg:blue,pointerEvents:"none",[`.${insArrBlock.trim()}:hover &`]:{top:"-1px",left:"-5px",w:"5px",h:"5px"}}),insArrLine=(0,nano_theme_lib.rule)({pos:"absolute",top:"1px",left:"-56px",w:"50px",h:"0px",bdt:`1px dotted ${blue}`,pointerEvents:"none",[`.${insArrBlock.trim()}:hover &`]:{left:"-58px",w:"54px",bdt:`1px solid ${blue}`}}),insArrButton=(0,nano_theme_lib.rule)({pos:"absolute",top:"-7px",left:"-75px"}),insButton=(0,nano_theme_lib.rule)({w:"17px",h:"17px",bdrad:"2px",pad:0,mar:0,out:0,ff:"monospace",lh:"16px",cur:"pointer",bd:`1px dotted ${blue}`,col:blue,fw:"normal","&:hover":{fw:"bold",bg:blue}}),useInsButton=(0,nano_theme_lib.makeRule)((theme=>({bg:theme.bg,"&:hover":{col:theme.bg},"&:active":{col:theme.g(.9),bg:theme.g(.1),bd:`1px solid ${theme.g(.1)}`}}))),tooltip=(0,nano_theme_lib.rule)({...nano_theme_lib.theme.font.ui1,pos:"absolute",top:"-32px",left:"0px",d:"inline-block",bg:"rgba(0,0,0,.8)",col:"#fff",fz:13/13.4+"em",pad:"4px 6px 6px",bdrad:"2px",z:3,pointerEvents:"none",userSelect:"none"}),insArrTooltip=(0,nano_theme_lib.rule)({pos:"absolute",top:"-36px",left:"-75px",vis:"hidden",[`.${insArrBlock.trim()}:hover &`]:{vis:"visible"}}),deleteButton=(0,nano_theme_lib.rule)({d:"flex",justifyContent:"center",alignItems:"center",w:"20px",h:"20px",pos:"absolute",top:"-11px",left:"-11px",z:2,bdrad:"50%",svg:{fill:blue},"&:hover":{bg:negative,bd:`1px solid ${negative}`,svg:{fill:"#fff"}},"&:active":{bg:nano_theme_lib.theme.g(.1),bd:`1px solid ${nano_theme_lib.theme.g(.1)}`}}),deleteButtonTooltip=(0,nano_theme_lib.rule)({pos:"absolute",top:"-30px",left:"0px",vis:"hidden",[`.${deleteButton.trim()}:hover &`]:{vis:"visible"}});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const JsonHoverable=_ref=>{let{pointer,children}=_ref;const[t]=(0,lib.NT)(),{hoverPointer,setHoverPointer,activePointer,setActivePointer,formal,compact,onChange,isInputFocused}=react.useContext(context),[draggedOver,setDraggedOver]=react.useState(!1),[deleteHovered,setDeleteHovered]=react.useState(!1),theme=(0,nano_theme_lib.useTheme)(),useInsButtonClass=useInsButton(),onDragEnter=formal?void 0:e=>{e.preventDefault(),e.stopPropagation(),setDraggedOver(!0)},onDragLeave=formal?void 0:e=>{e.preventDefault(),e.stopPropagation(),setDraggedOver(!1)},onDragOver=formal?void 0:e=>{e.preventDefault(),e.stopPropagation()},onDrop=formal?void 0:e=>{e.preventDefault(),e.stopPropagation(),setDraggedOver(!1);const from=e.dataTransfer.getData("text/plain");onChange&&onChange([{op:"move",from,path:pointer}])},onDragStart=formal?void 0:e=>{e.stopPropagation(),e.dataTransfer.setData("text/plain",pointer)},isHovered=hoverPointer===pointer,isActive=activePointer===pointer;let subChildren=children.props.children;return pointer&&(subChildren=(0,jsx_runtime.jsx)("span",{onDrop,onDragOver,onDragEnter,onDragLeave,style:{outline:draggedOver?`1px solid ${theme.blue}`:void 0},children:(0,jsx_runtime.jsx)("span",{draggable:!formal,onDragStart,children:subChildren})})),onChange&&!isInputFocused&&pointer===activePointer&&(subChildren=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[subChildren,(0,jsx_runtime.jsxs)("button",{className:insButton+useInsButtonClass+deleteButton,onClick:()=>onChange([{op:"remove",path:pointer}]),onMouseEnter:()=>setDeleteHovered(!0),onMouseOver:()=>setDeleteHovered(!0),onMouseLeave:()=>setDeleteHovered(!1),children:[(0,jsx_runtime.jsx)(iconista_lib.Z,{set:"atlaskit",icon:"cross",width:10,height:10}),(0,jsx_runtime.jsx)("span",{className:tooltip+deleteButtonTooltip,children:t("Delete")})]})]})),react.cloneElement(children,{onMouseMove:e=>{formal||e.preventDefault(),e.stopPropagation(),hoverPointer!==pointer&&setHoverPointer(pointer)},onMouseEnter:e=>{e.preventDefault(),e.stopPropagation(),setHoverPointer(pointer)},onMouseLeave:()=>{setHoverPointer(null)},onClick:e=>{e.preventDefault(),e.stopPropagation(),setActivePointer(pointer)},className:(children.props.className||"")+hoverable+(compact?hoverableCompact:"")+(isHovered?hovered:"")+(isActive?active:""),style:{...children.props.style||{},outline:deleteHovered?`1px dotted ${negative}`:void 0}},subChildren)};try{JsonHoverable.displayName="JsonHoverable",JsonHoverable.__docgenInfo={description:"",displayName:"JsonHoverable",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonHoverable.tsx#JsonHoverable"]={docgenInfo:JsonHoverable.__docgenInfo,name:"JsonHoverable",path:"src/ClickableJson/JsonHoverable.tsx#JsonHoverable"})}catch(__react_docgen_typescript_loader_error){}var AutosizeInput=__webpack_require__("./src/AutosizeInput/index.tsx");const JsonProperty=_ref=>{let{pointer,onChange}=_ref;const{formal:selectable}=react.useContext(context),steps=react.useMemo((()=>pointer.split("/")),[pointer]),property=react.useMemo((()=>steps[steps.length-1]),[steps]),[proposed,setProposed]=react.useState(property),inputRef=react.useRef(null),[focused,setFocused]=react.useState(!1),theme=(0,nano_theme_lib.useTheme)(),style={color:theme.g(.1)};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[onChange?(0,jsx_runtime.jsx)(AutosizeInput.Z,{inputRef:el=>inputRef.current=el,inputClassName:css_property+input,inputStyle:style,value:focused?proposed:property,onChange:e=>setProposed(e.target.value),onFocus:()=>setFocused(!0),onBlur:e=>{setFocused(!1),(e=>{e&&e.preventDefault(),e&&e.stopPropagation(),onChange&&onChange([{op:"move",from:pointer,path:steps.slice(0,steps.length-1).join("/")+"/"+proposed}])})(e)},onKeyDown:e=>{"Enter"===e.key?inputRef.current&&inputRef.current.blur():"Escape"===e.key&&inputRef.current&&inputRef.current.blur()}}):(0,jsx_runtime.jsx)("span",{className:css_property,style,children:selectable?JSON.stringify(property):property}),(0,jsx_runtime.jsx)("span",{className:colon,style:{color:theme.g(.5)},children:(0,jsx_runtime.jsx)("span",{children:":"})})]})};try{JsonProperty.displayName="JsonProperty",JsonProperty.__docgenInfo={description:"",displayName:"JsonProperty",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonProperty.tsx#JsonProperty"]={docgenInfo:JsonProperty.__docgenInfo,name:"JsonProperty",path:"src/ClickableJson/JsonProperty.tsx#JsonProperty"})}catch(__react_docgen_typescript_loader_error){}const valueColor=(isDark,value)=>{switch(typeof value){case"boolean":return ValueColor.bool[~~isDark];case"string":return ValueColor.str[~~isDark];case"number":return value===Math.round(value)?ValueColor.num[~~isDark]:ValueColor.float[~~isDark];case"object":return null===value?ValueColor.nil[~~isDark]:void 0}},inputColor=(isDark,input)=>{if(input){if("true"===(input=input.trim())||"false"===input)return ValueColor.bool[~~isDark];if("null"===input)return ValueColor.nil[~~isDark];if(input.length<24&&("-"===input[0]||input[0]>="0"&&input[0]<="9"))try{const parsed=JSON.parse(input);if("number"==typeof parsed)return parsed===Math.round(parsed)?ValueColor.num[~~isDark]:ValueColor.float[~~isDark]}catch{}if("["!==input[0]&&"{"!==input[0])return ValueColor.str[~~isDark]}},inputStyle=(theme,isDark,input)=>({color:inputColor(isDark,input)||theme.g(.1),background:theme.bg,borderColor:theme.g(.7)}),ValueInput=props=>{const{value,onChange}=props,inputRef=react.useRef(null),theme=(0,nano_theme_lib.useTheme)(),json=react.useMemo((()=>null===value?"null":"boolean"==typeof value?value?"true":"false":"string"==typeof value?JSON.stringify(value):String(value)),[value,theme]),[proposed,setProposed]=react.useState(json),[focused,setFocused]=react.useState(!1);react.useEffect((()=>{setProposed(json)}),[json]);return(0,jsx_runtime.jsx)(AutosizeInput.Z,{inputRef:el=>inputRef.current=el,inputClassName:input,inputStyle:focused?inputStyle(theme,!theme.isLight,proposed):{color:valueColor(!theme.isLight,value)},value:focused?proposed:json,onChange:e=>setProposed(e.target.value),onFocus:()=>setFocused(!0),onBlur:()=>setFocused(!1),onKeyDown:e=>{"Enter"===e.key?(inputRef.current&&inputRef.current.blur(),(e=>{let newValue;e&&e.preventDefault(),e&&e.stopPropagation();try{newValue=JSON.parse(proposed)}catch{newValue=String(proposed)}onChange&&onChange(newValue)})(e)):"Escape"===e.key&&(json!==proposed?setProposed(json):inputRef.current&&inputRef.current.blur())}})};ValueInput.displayName="ValueInput";try{ValueInput.displayName="ValueInput",ValueInput.__docgenInfo={description:"",displayName:"ValueInput",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"unknown"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: unknown) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/ ValueInput.tsx#ValueInput"]={docgenInfo:ValueInput.__docgenInfo,name:"ValueInput",path:"src/ClickableJson/ ValueInput.tsx#ValueInput"})}catch(__react_docgen_typescript_loader_error){}const JsonValue=props=>{const{pointer,property,doc,comma,onChange}=props,theme=(0,nano_theme_lib.useTheme)(),value=react.useMemo((()=>null===doc?"null":"boolean"==typeof doc?doc?"true":"false":"string"==typeof doc?JSON.stringify(doc):String(doc)),[doc,theme]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["string"==typeof property&&(0,jsx_runtime.jsx)(JsonProperty,{pointer,onChange}),onChange?(0,jsx_runtime.jsx)(ValueInput,{value:doc,onChange:newValue=>{onChange&&onChange([{op:"replace",path:pointer,value:newValue}])}}):(0,jsx_runtime.jsx)("span",{style:{color:valueColor(!theme.isLight,doc)},children:value}),!!comma&&","]})};try{JsonValue.displayName="JsonValue",JsonValue.__docgenInfo={description:"",displayName:"JsonValue",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},property:{defaultValue:null,description:"",name:"property",required:!1,type:{name:"string | number"}},doc:{defaultValue:null,description:"",name:"doc",required:!0,type:{name:"unknown"}},comma:{defaultValue:null,description:"",name:"comma",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonValue.tsx#JsonValue"]={docgenInfo:JsonValue.__docgenInfo,name:"JsonValue",path:"src/ClickableJson/JsonValue.tsx#JsonValue"})}catch(__react_docgen_typescript_loader_error){}var json_pointer=__webpack_require__("./node_modules/json-joy/lib/json-pointer/index.js");const JsonObjectInsert=_ref=>{let{pointer,visible}=_ref;const[t]=(0,lib.NT)(),{onChange}=react.useContext(context),[editing,setEditing]=react.useState(!1),[property,setProperty]=react.useState(""),[value,setValue]=react.useState(""),inputPropertyRef=react.useRef(null),inputValueRef=react.useRef(null),insButtonClass=useInsButton(),theme=(0,nano_theme_lib.useTheme)();if(!onChange)return null;return editing?(0,jsx_runtime.jsxs)("span",{style:{display:visible?void 0:"none"},children:[(0,jsx_runtime.jsx)(AutosizeInput.Z,{inputRef:el=>{inputPropertyRef.current=el,el&&el.focus()},inputClassName:css_property+input+inputActive,inputStyle:{color:theme.g(.1),background:theme.bg,borderColor:theme.g(.7)},value:property,onChange:e=>setProperty(e.target.value),onFocus:()=>{},onBlur:()=>{inputValueRef.current&&inputValueRef.current.focus()},onKeyDown:e=>{"Escape"===e.key?property?setProperty(""):value?setValue(""):setEditing(!1):"Enter"===e.key&&inputValueRef.current&&inputValueRef.current.focus()}}),(0,jsx_runtime.jsx)("span",{className:colon,children:(0,jsx_runtime.jsx)("span",{children:":"})}),(0,jsx_runtime.jsx)(AutosizeInput.Z,{inputRef:el=>{inputValueRef.current=el},inputClassName:input+inputActive,inputStyle:inputStyle(theme,!theme.isLight,value),value,onChange:e=>setValue(e.target.value),onFocus:()=>{},onBlur:()=>{},onKeyDown:e=>{"Escape"===e.key?value?setValue(""):inputPropertyRef.current&&inputPropertyRef.current.focus():"Enter"===e.key&&(inputValueRef.current&&inputValueRef.current.blur(),(()=>{let newValue;try{newValue=JSON.parse(value)}catch{newValue=String(value)}onChange([{op:"add",path:pointer+"/"+(0,json_pointer.escapeComponent)(property),value:newValue}]),setProperty(""),setValue(""),setEditing(!1)})())}})]}):(0,jsx_runtime.jsxs)("span",{className:insArrBlock,style:{display:visible?void 0:"none"},onClick:()=>setEditing(!0),children:[(0,jsx_runtime.jsx)("span",{className:insArrDot}),(0,jsx_runtime.jsx)("span",{className:insArrLine}),(0,jsx_runtime.jsx)("button",{className:insButton+insButtonClass+insArrButton,children:"+"}),(0,jsx_runtime.jsx)("span",{className:tooltip+insArrTooltip,children:t("Add key")})]})};JsonObjectInsert.displayName="JsonObjectInsert";try{JsonObjectInsert.displayName="JsonObjectInsert",JsonObjectInsert.__docgenInfo={description:"",displayName:"JsonObjectInsert",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonObjectInsert.tsx#JsonObjectInsert"]={docgenInfo:JsonObjectInsert.__docgenInfo,name:"JsonObjectInsert",path:"src/ClickableJson/JsonObjectInsert.tsx#JsonObjectInsert"})}catch(__react_docgen_typescript_loader_error){}const JsonArrayInsert=_ref=>{let{pointer,visible}=_ref;const[t]=(0,lib.NT)(),{onChange}=react.useContext(context),[editing,setEditing]=react.useState(!1),[value,setValue]=react.useState(""),inputRef=react.useRef(null),insButtonClass=useInsButton(),theme=(0,nano_theme_lib.useTheme)();if(!onChange)return null;return editing?(0,jsx_runtime.jsx)("span",{style:{display:visible?void 0:"none"},children:(0,jsx_runtime.jsx)(AutosizeInput.Z,{inputRef:el=>{inputRef.current=el,el&&el.focus()},inputClassName:input,inputStyle:inputStyle(theme,!theme.isLight,value),value,onChange:e=>setValue(e.target.value),onFocus:()=>{},onBlur:()=>{setEditing(!1)},onKeyDown:e=>{"Escape"===e.key?value?setValue(""):setEditing(!1):"Enter"===e.key&&(inputRef.current&&inputRef.current.blur(),(()=>{let newValue;try{newValue=JSON.parse(value)}catch{newValue=String(value)}onChange([{op:"add",path:pointer,value:newValue}]),setValue(""),setEditing(!1)})())}})}):(0,jsx_runtime.jsxs)("span",{className:insArrBlock,style:{display:visible?void 0:"none"},onClick:()=>setEditing(!0),children:[(0,jsx_runtime.jsx)("span",{className:insArrDot}),(0,jsx_runtime.jsx)("span",{className:insArrLine}),(0,jsx_runtime.jsx)("button",{className:insArrButton+insButton+insButtonClass,children:"+"}),(0,jsx_runtime.jsx)("span",{className:tooltip+insArrTooltip,children:t("Insert")})]})};JsonArrayInsert.displayName="JsonArrayInsert";try{JsonArrayInsert.displayName="JsonArrayInsert",JsonArrayInsert.__docgenInfo={description:"",displayName:"JsonArrayInsert",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonArrayInsert.tsx#JsonArrayInsert"]={docgenInfo:JsonArrayInsert.__docgenInfo,name:"JsonArrayInsert",path:"src/ClickableJson/JsonArrayInsert.tsx#JsonArrayInsert"})}catch(__react_docgen_typescript_loader_error){}const JsonObject=_ref=>{let{property,doc,pointer,comma,onChange}=_ref;const{activePointer,formal,keepOrder}=react.useContext(context),keys=react.useMemo((()=>{const k=Object.keys(doc);return keepOrder?k:k.sort()}),[doc]),[collapsed,setCollapsed]=react.useState(!1),[brackedHovered,setBracketHovered]=react.useState(!1),theme=(0,nano_theme_lib.useTheme)(),onBracketMouseEnter=()=>{setBracketHovered(!0)},onBracketMouseLeave=()=>{setBracketHovered(!1)},handleBracketClick=()=>{collapsed||pointer!==activePointer||setCollapsed(!0)},bracketColor=theme.g(.3);return(0,jsx_runtime.jsxs)("span",{className:object,onClick:()=>{collapsed&&setCollapsed(!1)},children:[(0,jsx_runtime.jsx)("span",{className:collapser,style:{color:theme.g(.6)},onClick:()=>setCollapsed((x=>!x)),children:collapsed?"+":"—"}),(0,jsx_runtime.jsxs)("span",{children:["string"==typeof property&&(0,jsx_runtime.jsx)(JsonProperty,{pointer,onChange}),(0,jsx_runtime.jsx)("span",{style:{display:collapsed?"none":void 0,color:bracketColor},className:brackedHovered?bracketHovered:"",onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"{"}),(0,jsx_runtime.jsxs)("span",{className:css_collapsed,style:{display:collapsed?void 0:"none"},children:[(0,jsx_runtime.jsx)("span",{style:{color:bracketColor},children:"{"}),!!keys.length&&(0,jsx_runtime.jsx)("strong",{children:keys.length}),(0,jsx_runtime.jsx)("span",{style:{color:bracketColor},children:"}"})]})]}),(0,jsx_runtime.jsxs)("span",{className:list,style:{display:collapsed?"none":void 0},children:[keys.map(((key,index)=>{const itemPointer=`${pointer}/${key}`;return(0,jsx_runtime.jsx)("span",{className:line,children:(0,jsx_runtime.jsx)(JsonHoverable,{pointer:itemPointer,children:(0,jsx_runtime.jsx)("span",{className:lineInner,children:(0,jsx_runtime.jsx)(JsonDoc,{property:key,doc:doc[key],pointer:itemPointer,comma:formal&&index<keys.length-1,onChange})})})},key)})),(0,jsx_runtime.jsx)(JsonObjectInsert,{pointer,visible:activePointer===pointer})]}),(0,jsx_runtime.jsx)("span",{style:{display:collapsed?"none":void 0,color:bracketColor},className:brackedHovered?bracketHovered:"",onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"}"}),!!comma&&","]})};JsonObject.displayName="JsonObject";const JsonArray=_ref2=>{let{property,doc,pointer,comma,onChange}=_ref2;const[collapsed,setCollapsed]=react.useState(!1),[brackedHovered,setBracketHovered]=react.useState(!1),{activePointer,formal:selectable}=react.useContext(context),theme=(0,nano_theme_lib.useTheme)(),onBracketMouseEnter=()=>{setBracketHovered(!0)},onBracketMouseLeave=()=>{setBracketHovered(!1)},handleBracketClick=()=>{collapsed||pointer!==activePointer||setCollapsed(!0)},bracketColor=theme.g(.3);return(0,jsx_runtime.jsxs)("span",{className:object,onClick:()=>{collapsed&&setCollapsed(!1)},children:[(0,jsx_runtime.jsx)("span",{className:collapser,style:{color:theme.g(.6)},onClick:()=>setCollapsed((x=>!x)),children:collapsed?"+":"—"}),(0,jsx_runtime.jsxs)("span",{children:["string"==typeof property&&(0,jsx_runtime.jsx)(JsonProperty,{pointer,onChange}),(0,jsx_runtime.jsx)("span",{style:{display:collapsed?"none":void 0,color:bracketColor},className:brackedHovered?bracketHovered:"",onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"["}),(0,jsx_runtime.jsxs)("span",{className:css_collapsed,style:{display:collapsed?void 0:"none"},children:[(0,jsx_runtime.jsx)("span",{style:{color:bracketColor},children:"["}),!!doc.length&&(0,jsx_runtime.jsx)("strong",{children:doc.length}),(0,jsx_runtime.jsx)("span",{style:{color:bracketColor},children:"]"})]})]}),(0,jsx_runtime.jsxs)("span",{className:list,style:{display:collapsed?"none":void 0},children:[doc.map(((value,index)=>{const itemPointer=`${pointer}/${index}`;return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)(JsonArrayInsert,{pointer:`${pointer}/${index}`,visible:activePointer===pointer}),(0,jsx_runtime.jsx)("span",{className:line,children:(0,jsx_runtime.jsx)(JsonHoverable,{pointer:itemPointer,children:(0,jsx_runtime.jsx)("span",{className:lineInner,children:(0,jsx_runtime.jsx)(JsonDoc,{doc:doc[index],pointer:itemPointer,comma:selectable&&index<doc.length-1,onChange})})})})]},index)})),(0,jsx_runtime.jsx)(JsonArrayInsert,{pointer:`${pointer}/-`,visible:activePointer===pointer})]}),(0,jsx_runtime.jsx)("span",{style:{display:collapsed?"none":void 0,color:bracketColor},className:brackedHovered?bracketHovered:"",onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"]"}),!!comma&&","]})};JsonArray.displayName="JsonArray";const JsonDoc=props=>{const{doc,comma}=props;return doc&&"object"==typeof doc?Array.isArray(doc)?(0,jsx_runtime.jsx)(JsonArray,{...props,doc,comma}):(0,jsx_runtime.jsx)(JsonObject,{...props,doc,comma}):(0,jsx_runtime.jsx)(JsonValue,{...props,comma})};try{JsonDoc.displayName="JsonDoc",JsonDoc.__docgenInfo={description:"",displayName:"JsonDoc",props:{property:{defaultValue:null,description:"",name:"property",required:!1,type:{name:"string | number"}},doc:{defaultValue:null,description:"",name:"doc",required:!0,type:{name:"unknown"}},pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},comma:{defaultValue:null,description:"",name:"comma",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonDoc.tsx#JsonDoc"]={docgenInfo:JsonDoc.__docgenInfo,name:"JsonDoc",path:"src/ClickableJson/JsonDoc.tsx#JsonDoc"})}catch(__react_docgen_typescript_loader_error){}const ClickableJson=props=>{const isMounted=(0,useMountedState.Z)(),[hoverPointer,setHoverPointer]=react.useState(null),[activePointer,setActivePointer]=react.useState(null),[isInputFocused,setIsInputFocused]=react.useState(!1),ref=react.useRef(null);return(0,useClickAway.Z)(ref,(()=>{isMounted&&setActivePointer(null)})),react.useEffect((()=>{const onFocusIn=()=>{setIsInputFocused(!!document.activeElement&&"INPUT"===document.activeElement.tagName)};return document.addEventListener("focus",onFocusIn,!0),document.addEventListener("blur",onFocusIn,!0),()=>{document.removeEventListener("focus",onFocusIn),document.removeEventListener("blur",onFocusIn)}}),[]),(0,jsx_runtime.jsx)(context.Provider,{value:{hoverPointer,setHoverPointer:value=>{isMounted&&setHoverPointer(value)},activePointer,setActivePointer:value=>{isMounted&&setActivePointer(value)},onChange:props.onChange,formal:props.formal,compact:props.compact,keepOrder:props.keepOrder,isInputFocused},children:(0,jsx_runtime.jsx)(JsonHoverable,{pointer:"",children:(0,jsx_runtime.jsx)("span",{ref,className:block,style:{fontSize:props.fontSize||"13.4px"},children:(0,jsx_runtime.jsx)(JsonDoc,{...props,pointer:""})})})})};ClickableJson.displayName="ClickableJson";try{ClickableJson.displayName="ClickableJson",ClickableJson.__docgenInfo={description:"",displayName:"ClickableJson",props:{doc:{defaultValue:null,description:"",name:"doc",required:!0,type:{name:"unknown"}},formal:{defaultValue:null,description:"",name:"formal",required:!1,type:{name:"boolean"}},keepOrder:{defaultValue:null,description:"",name:"keepOrder",required:!1,type:{name:"boolean"}},fontSize:{defaultValue:null,description:"",name:"fontSize",required:!1,type:{name:"string"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/index.tsx#ClickableJson"]={docgenInfo:ClickableJson.__docgenInfo,name:"ClickableJson",path:"src/ClickableJson/index.tsx#ClickableJson"})}catch(__react_docgen_typescript_loader_error){}var json_patch=__webpack_require__("./node_modules/json-joy/lib/json-patch/index.js");const index_stories={title:"ClickableJson",component:ClickableJson,parameters:{layout:"centered"},tags:["autodocs"],argTypes:{}},doc1={support:"https://github.com/sponsors/streamich",license:"use it if you support me",foo:null,test:123,developer:{name:"@streamich"}},doc2={id:"pj7ryzaia1",model:1.6,cid:"og6f0o9v1c",type:"p",created:1596445997247,modified:1596445997381,pid:"92lmu7fs9a",depth:1,mime:"image/png",ext:"png",file:"image.png",w:624,h:1390,omark:[{x1:.027777777777777776,y1:.8438848920863309,x2:.25,y2:.8827338129496403}],isPost:!0,isMature:!1,parent:null,poster:{id:"xxsdfasdf-asdf-asdf-asdf-asdfasdfasdf",name:"Muhammad",list:[1,!0,!1,null,"asdf"]}},Primary={args:{doc:doc1,onChange:patch=>console.log("onChange",patch)}},Post={args:{doc:doc2,onChange:patch=>console.log("onChange",patch)}},Readonly={args:{doc:doc1}},FormalAndCompact={args:{doc:doc1,formal:!0,compact:!0}},Demo=props=>{const[doc,setDoc]=react.useState(props.doc);return(0,jsx_runtime.jsx)("div",{style:{padding:"32px 64px"},children:(0,jsx_runtime.jsx)(ClickableJson,{doc,onChange:patch=>{const result=(0,json_patch.applyPatch)(doc,patch,{mutate:!1});setDoc(result.doc)}})})};Demo.displayName="Demo";const Interactive={render:()=>(0,jsx_runtime.jsx)(Demo,{doc:doc1}),parameters:{layout:"fullscreen"}},InteractiveEmpty={render:()=>(0,jsx_runtime.jsx)(Demo,{doc:null}),parameters:{layout:"fullscreen"}},InteractiveLarge={render:()=>(0,jsx_runtime.jsx)(Demo,{doc:doc2}),parameters:{layout:"fullscreen"}};Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc1,\n    onChange: (patch: unknown) => console.log('onChange', patch)\n  } as any)\n}",...Primary.parameters?.docs?.source}}},Post.parameters={...Post.parameters,docs:{...Post.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc2,\n    onChange: (patch: unknown) => console.log('onChange', patch)\n  } as any)\n}",...Post.parameters?.docs?.source}}},Readonly.parameters={...Readonly.parameters,docs:{...Readonly.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc1\n  } as any)\n}",...Readonly.parameters?.docs?.source}}},FormalAndCompact.parameters={...FormalAndCompact.parameters,docs:{...FormalAndCompact.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc1,\n    formal: true,\n    compact: true\n  } as any)\n}",...FormalAndCompact.parameters?.docs?.source}}},Interactive.parameters={...Interactive.parameters,docs:{...Interactive.parameters?.docs,source:{originalSource:"{\n  render: () => <Demo doc={doc1} />,\n  parameters: {\n    layout: 'fullscreen'\n  }\n}",...Interactive.parameters?.docs?.source}}},InteractiveEmpty.parameters={...InteractiveEmpty.parameters,docs:{...InteractiveEmpty.parameters?.docs,source:{originalSource:"{\n  render: () => <Demo doc={null} />,\n  parameters: {\n    layout: 'fullscreen'\n  }\n}",...InteractiveEmpty.parameters?.docs?.source}}},InteractiveLarge.parameters={...InteractiveLarge.parameters,docs:{...InteractiveLarge.parameters?.docs,source:{originalSource:"{\n  render: () => <Demo doc={doc2} />,\n  parameters: {\n    layout: 'fullscreen'\n  }\n}",...InteractiveLarge.parameters?.docs?.source}}};const __namedExportsOrder=["Primary","Post","Readonly","FormalAndCompact","Interactive","InteractiveEmpty","InteractiveLarge"]},"./src/AutosizeInput/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>AutosizeInput,Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const sizerStyle={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},INPUT_PROPS_BLACKLIST=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],copyStyles=(styles,node)=>{node.style.fontSize=styles.fontSize,node.style.fontFamily=styles.fontFamily,node.style.fontWeight=styles.fontWeight,node.style.fontStyle=styles.fontStyle,node.style.letterSpacing=styles.letterSpacing,node.style.textTransform=styles.textTransform},isIE=!("undefined"==typeof window||!window.navigator)&&/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent),generateId=()=>isIE?"_"+Math.random().toString(36).substr(2,12):void 0;class AutosizeInput extends react__WEBPACK_IMPORTED_MODULE_0__.Component{mounted=!1;constructor(props,context){super(props,context),this.state={inputWidth:props.minWidth||0,inputId:props.id||generateId()}}componentDidMount(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}UNSAFE_componentWillReceiveProps(nextProps){const{id}=nextProps;id!==this.props.id&&this.setState({inputId:id||generateId()})}componentDidUpdate(prevProps,prevState){prevState.inputWidth!==this.state.inputWidth&&"function"==typeof this.props.onAutosize&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}componentWillUnmount(){this.mounted=!1}inputRef=el=>{this.input=el,"function"==typeof this.props.inputRef&&this.props.inputRef(el)};placeHolderSizerRef=el=>{this.placeHolderSizer=el};sizerRef=el=>{this.sizer=el};copyInputStyles(){if(!this.mounted||!window.getComputedStyle)return;const inputStyles=this.input&&window.getComputedStyle(this.input);inputStyles&&(copyStyles(inputStyles,this.sizer),this.placeHolderSizer&&copyStyles(inputStyles,this.placeHolderSizer))}updateInputWidth(){if(!this.mounted||!this.sizer||void 0===this.sizer.scrollWidth)return;let newInputWidth;newInputWidth=this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:this.sizer.scrollWidth+2;newInputWidth+="number"===this.props.type&&void 0===this.props.extraWidth?16:parseInt(this.props.extraWidth,10)||0,newInputWidth<(this.props.minWidth||0)&&(newInputWidth=this.props.minWidth),newInputWidth!==this.state.inputWidth&&this.setState({inputWidth:newInputWidth})}getInput(){return this.input}focus(){this.input.focus()}blur(){this.input.blur()}select(){this.input.select()}render(){const sizerValue=[this.props.defaultValue,this.props.value,""].reduce(((previousValue,currentValue)=>null!=previousValue?previousValue:currentValue)),wrapperStyle={...this.props.style};wrapperStyle.display||(wrapperStyle.display="inline-block");const inputStyle={boxSizing:"content-box",width:`${this.state.inputWidth}px`,...this.props.inputStyle},{...inputProps}=this.props;return(inputProps=>{INPUT_PROPS_BLACKLIST.forEach((field=>delete inputProps[field]))})(inputProps),inputProps.className=this.props.inputClassName,inputProps.id=this.state.inputId,inputProps.style=inputStyle,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("div",{className:this.props.className,style:wrapperStyle,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("input",{...inputProps,ref:this.inputRef}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{ref:this.sizerRef,style:sizerStyle,children:sizerValue}),this.props.placeholder?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{ref:this.placeHolderSizerRef,style:sizerStyle,children:this.props.placeholder}):null]})}}AutosizeInput.displayName="AutosizeInput";const __WEBPACK_DEFAULT_EXPORT__=AutosizeInput;try{AutosizeInput.displayName="AutosizeInput",AutosizeInput.__docgenInfo={description:"",displayName:"AutosizeInput",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},inputStyle:{defaultValue:null,description:"",name:"inputStyle",required:!1,type:{name:"CSSProperties"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},inputClassName:{defaultValue:null,description:"",name:"inputClassName",required:!1,type:{name:"string"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"number"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},placeholderIsMinWidth:{defaultValue:null,description:"",name:"placeholderIsMinWidth",required:!1,type:{name:"boolean"}},extraWidth:{defaultValue:null,description:"",name:"extraWidth",required:!1,type:{name:"any"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},onAutosize:{defaultValue:null,description:"",name:"onAutosize",required:!1,type:{name:"((inputWidth: number) => void)"}},inputRef:{defaultValue:null,description:"",name:"inputRef",required:!1,type:{name:"((el: any) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/AutosizeInput/index.tsx#AutosizeInput"]={docgenInfo:AutosizeInput.__docgenInfo,name:"AutosizeInput",path:"src/AutosizeInput/index.tsx#AutosizeInput"})}catch(__react_docgen_typescript_loader_error){}}}]);