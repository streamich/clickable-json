"use strict";(self.webpackChunkclickable_json=self.webpackChunkclickable_json||[]).push([[922],{"./src/ClickableJson/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FormalAndCompact:()=>FormalAndCompact,Interactive:()=>Interactive,InteractiveEmpty:()=>InteractiveEmpty,InteractiveLarge:()=>InteractiveLarge,Primary:()=>Primary,Readonly:()=>Readonly,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("./node_modules/react/index.js"),useClickAway=__webpack_require__("./node_modules/react-use/lib/useClickAway.js"),useMountedState=__webpack_require__("./node_modules/react-use/lib/useMountedState.js");const context=react.createContext({hoverPointer:null,setHoverPointer:()=>{},activePointer:null,setActivePointer:()=>{},isInputFocused:!1});var lib=__webpack_require__("./node_modules/use-t/lib/index.js"),iconista_lib=__webpack_require__("./node_modules/iconista/lib/index.js"),nano_theme_lib=__webpack_require__("./node_modules/nano-theme/lib/index.js");const blue=nano_theme_lib.theme.color.sem.blue[0],negative=nano_theme_lib.theme.color.sem.negative[0],block=(0,nano_theme_lib.rule)({d:"inline-block",ff:"monospace",col:nano_theme_lib.theme.g(.1)}),object=(0,nano_theme_lib.rule)({pos:"relative",d:"inline-block"}),ValueColor={nil:[nano_theme_lib.theme.g(.6),nano_theme_lib.darkTheme.g(.6)],str:["#e00e44","#f01e54"],bool:["#411888","#9168c8"],num:["#0a8F3F","#0FaF4F"],float:["#016873","#51a8b3"]},css_property=((0,nano_theme_lib.rule)({col:"#E84D3D"}),(0,nano_theme_lib.rule)({pad:"0",fw:"bold",bxz:"border-box"})),activeInput={col:nano_theme_lib.theme.g(0),pd:"5px",bg:nano_theme_lib.theme.bg,bd:`1px solid ${nano_theme_lib.theme.g(.7)}`,mr:"-6px",out:0},input=(0,nano_theme_lib.rule)({z:2,pos:"relative",bd:0,mar:0,pad:0,bg:"transparent",bdrad:"5px",d:"inline-block",minW:"auto",w:"auto","&::selection":{col:"#fff",bgc:blue},input:{out:0}}),colon=((0,nano_theme_lib.rule)(activeInput),(0,nano_theme_lib.rule)({pd:"0 8px 0 0px",cur:"default","&>span":{pd:"0 2px"},"&:hover":{"&>span":{out:`1px dotted ${blue}`}}})),list=(0,nano_theme_lib.rule)({d:"block",listStyleType:"none",pd:0,mr:"0 0 0 32px"}),line=(0,nano_theme_lib.rule)({d:"block",ls:"none",pd:0,mr:0}),lineInner=(0,nano_theme_lib.rule)({d:"inline-block"}),hoverable=(0,nano_theme_lib.rule)({bxz:"border-box",pd:"3px",bdrad:"4px",trs:"background-color .3s ease-out"}),hoverableCompact=(0,nano_theme_lib.rule)({pd:"1px 3px"}),hovered=(0,nano_theme_lib.rule)({bgc:nano_theme_lib.theme.blue(.1)}),active=(0,nano_theme_lib.rule)({out:`1px dotted ${blue}`,pos:"relative"}),bracket=(0,nano_theme_lib.rule)({cur:"default"}),collapser=(0,nano_theme_lib.rule)({pd:"0 6px",pos:"absolute",t:"0px",l:"-24px",cur:"default",us:"none"}),css_collapsed=(0,nano_theme_lib.rule)({col:blue,cur:"default",fw:"bold",bg:nano_theme_lib.theme.blue(.1),pd:"2px",mr:"-2px",bdrad:"4px"}),bracketHovered=(0,nano_theme_lib.rule)({out:`1px dotted ${blue}`}),insArrBlock=(0,nano_theme_lib.rule)({pos:"relative",h:"0px",w:"0px"}),insArrDot=(0,nano_theme_lib.rule)({pos:"absolute",t:"0px",l:"-4px",w:"3px",h:"3px",bdrad:"50%",bg:blue,pe:"none",[`.${insArrBlock.trim()}:hover &`]:{top:"-1px",left:"-5px",w:"5px",h:"5px"}}),insArrLine=(0,nano_theme_lib.rule)({pos:"absolute",t:"1px",l:"-56px",w:"50px",h:"0px",bdt:`1px dotted ${blue}`,pe:"none",[`.${insArrBlock.trim()}:hover &`]:{l:"-58px",w:"54px",bdt:`1px solid ${blue}`}}),insArrButton=(0,nano_theme_lib.rule)({pos:"absolute",t:"-7px",l:"-75px"}),insButton=(0,nano_theme_lib.rule)({w:"17px",h:"17px",bdrad:"2px",pad:0,mr:0,out:0,ff:"monospace",lh:"16px",cur:"pointer",bd:`1px dotted ${blue}`,col:blue,fw:"normal","&:hover":{bg:blue}}),useInsButton=(0,nano_theme_lib.makeRule)((theme=>({bg:theme.bg,"&:hover":{col:theme.bg},"&:active":{col:theme.g(.9),bg:theme.g(.1),bd:`1px solid ${theme.g(.1)}`}}))),tooltip=(0,nano_theme_lib.rule)({...nano_theme_lib.theme.font.ui1,pos:"absolute",t:"-2.8em",l:"0px",d:"inline-block",bg:"rgba(0,0,0,.8)",col:"#fff",fz:12/13.4+"em",pad:".4em .8em",bdrad:".4em",z:3,pe:"none",us:"none"}),insArrTooltip=(0,nano_theme_lib.rule)({pos:"absolute",t:"-2.8em",l:"-75px",vis:"hidden",[`.${insArrBlock.trim()}:hover &`]:{vis:"visible"}}),deleteButton=(0,nano_theme_lib.rule)({d:"flex",jc:"center",ai:"center",w:"20px",h:"20px",pos:"absolute",t:"-11px",l:"-11px",z:2,bdrad:"50%",svg:{fill:blue},"&:hover":{bg:negative,bd:`1px solid ${negative}`,svg:{fill:"#fff"}},"&:active":{bg:nano_theme_lib.theme.g(.1),bd:`1px solid ${nano_theme_lib.theme.g(.1)}`}}),deleteButtonTooltip=(0,nano_theme_lib.rule)({pos:"absolute",t:"-30px",l:"0px",vis:"hidden",[`.${deleteButton.trim()}:hover &`]:{vis:"visible"}});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const JsonHoverable=_ref=>{let{pointer,children}=_ref;const[t]=(0,lib.NT)(),{hoverPointer,setHoverPointer,activePointer,setActivePointer,compact,onChange,isInputFocused}=react.useContext(context),[deleteHovered,setDeleteHovered]=react.useState(!1),useInsButtonClass=useInsButton(),isHovered=hoverPointer===pointer,isActive=activePointer===pointer;let subChildren=children.props.children;return onChange&&!isInputFocused&&pointer===activePointer&&(subChildren=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[subChildren,(0,jsx_runtime.jsxs)("button",{className:insButton+useInsButtonClass+deleteButton,onClick:()=>onChange([{op:"remove",path:pointer}]),onMouseEnter:()=>setDeleteHovered(!0),onMouseOver:()=>setDeleteHovered(!0),onMouseLeave:()=>setDeleteHovered(!1),children:[(0,jsx_runtime.jsx)(iconista_lib.Z,{set:"atlaskit",icon:"cross",width:10,height:10}),(0,jsx_runtime.jsx)("span",{className:tooltip+deleteButtonTooltip,children:t("Delete")})]})]})),react.cloneElement(children,{onMouseMove:e=>{e.stopPropagation(),hoverPointer!==pointer&&setHoverPointer(pointer)},onMouseEnter:e=>{e.preventDefault(),e.stopPropagation(),setHoverPointer(pointer)},onMouseLeave:()=>{setHoverPointer(null)},onClick:e=>{e.preventDefault(),e.stopPropagation(),setActivePointer(pointer)},className:(children.props.className||"")+hoverable+(compact?hoverableCompact:"")+(isHovered?hovered:"")+(isActive?active:""),style:{...children.props.style||{},outline:deleteHovered?`1px dotted ${negative}`:void 0}},subChildren)};try{JsonHoverable.displayName="JsonHoverable",JsonHoverable.__docgenInfo={description:"",displayName:"JsonHoverable",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonHoverable.tsx#JsonHoverable"]={docgenInfo:JsonHoverable.__docgenInfo,name:"JsonHoverable",path:"src/ClickableJson/JsonHoverable.tsx#JsonHoverable"})}catch(__react_docgen_typescript_loader_error){}var FlexibleInput=__webpack_require__("./src/FlexibleInput/index.tsx");const JsonProperty=_ref=>{let{pointer,onChange}=_ref;const{formal}=react.useContext(context),steps=react.useMemo((()=>pointer.split("/")),[pointer]),property=react.useMemo((()=>steps[steps.length-1]),[steps]),[proposed,setProposed]=react.useState(property),inputRef=react.useRef(null),[focused,setFocused]=react.useState(!1),theme=(0,nano_theme_lib.useTheme)(),style={color:theme.g(.1)};focused&&(style.background=theme.bg,style.border=`1px solid ${theme.g(.9)}`,style.fontWeight="bold",style.margin="-3px",style.padding="2px"),property&&-1===property.indexOf(" ")||(style.background=theme.blue(.1));return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[onChange?(0,jsx_runtime.jsx)("span",{className:css_property+input,style,children:(0,jsx_runtime.jsx)(FlexibleInput.o,{inp:el=>inputRef.current=el,value:focused?proposed:property,onChange:e=>setProposed(e.target.value),onFocus:e=>{const input=e.target,length=input.value.length;length&&length<6&&setTimeout((()=>{input.setSelectionRange(0,length,"forward")}),155),setFocused(!0)},onBlur:()=>{setFocused(!1)},onSubmit:e=>{inputRef.current&&(inputRef.current.blur(),setFocused(!1)),(e=>{e&&e.preventDefault(),e&&e.stopPropagation(),onChange&&onChange([{op:"move",from:pointer,path:steps.slice(0,steps.length-1).join("/")+"/"+proposed}])})(e)},onCancel:()=>{inputRef.current&&(inputRef.current.blur(),setFocused(!1))}})}):(0,jsx_runtime.jsx)("span",{className:css_property,style,children:formal?JSON.stringify(property):property}),(0,jsx_runtime.jsx)("span",{className:colon,style:{color:theme.g(.5)},children:(0,jsx_runtime.jsx)("span",{children:":"})})]})};try{JsonProperty.displayName="JsonProperty",JsonProperty.__docgenInfo={description:"",displayName:"JsonProperty",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonProperty.tsx#JsonProperty"]={docgenInfo:JsonProperty.__docgenInfo,name:"JsonProperty",path:"src/ClickableJson/JsonProperty.tsx#JsonProperty"})}catch(__react_docgen_typescript_loader_error){}const valueColor=(isDark,value)=>{switch(typeof value){case"boolean":return ValueColor.bool[~~isDark];case"string":return ValueColor.str[~~isDark];case"number":return value===Math.round(value)?ValueColor.num[~~isDark]:ValueColor.float[~~isDark];case"object":return null===value?ValueColor.nil[~~isDark]:void 0}},inputColor=(isDark,input)=>{if(input){if("true"===(input=input.trim())||"false"===input)return ValueColor.bool[~~isDark];if("null"===input)return ValueColor.nil[~~isDark];if(input.length<24&&("-"===input[0]||input[0]>="0"&&input[0]<="9"))try{const parsed=JSON.parse(input);if("number"==typeof parsed)return parsed===Math.round(parsed)?ValueColor.num[~~isDark]:ValueColor.float[~~isDark]}catch{}if("["!==input[0]&&"{"!==input[0])return ValueColor.str[~~isDark]}},inputStyle=(theme,isDark,input)=>({color:inputColor(isDark,input)||theme.g(.1),background:theme.bg,borderColor:theme.g(.7)}),typeahead=value=>{if(!value)return"";const length=value.length;return length>=5?"":"true".startsWith(value)?"true".slice(length):"false".startsWith(value)?"false".slice(length):"null".startsWith(value)?"null".slice(length):""};try{typeahead.displayName="typeahead",typeahead.__docgenInfo={description:"",displayName:"typeahead",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/utils.tsx#typeahead"]={docgenInfo:typeahead.__docgenInfo,name:"typeahead",path:"src/ClickableJson/utils.tsx#typeahead"})}catch(__react_docgen_typescript_loader_error){}const ValueInput=props=>{const{value,onChange}=props,inputRef=react.useRef(null),theme=(0,nano_theme_lib.useTheme)(),json=react.useMemo((()=>null===value?"null":"boolean"==typeof value?value?"true":"false":"string"==typeof value?JSON.stringify(value):String(value)),[value,theme]),[proposed,setProposed]=react.useState(json),[focused,setFocused]=react.useState(!1);react.useEffect((()=>{setProposed(json)}),[json]);return(0,jsx_runtime.jsx)("span",{className:input,style:focused?inputStyle(theme,!theme.isLight,proposed):{color:valueColor(!theme.isLight,value),background:!1===value||"number"==typeof value&&value<0?theme.red(.06):void 0},children:(0,jsx_runtime.jsx)(FlexibleInput.o,{inp:el=>inputRef.current=el,value:focused?proposed:json,typeahead:focused?typeahead(proposed):"",onChange:e=>setProposed(e.target.value),onFocus:e=>{const input=e.target,value=input.value,length=value.length;length&&length<40&&value===proposed&&setTimeout((()=>{if('"'===value[0]&&'"'===value[length-1])(length<17||-1===value.indexOf("\n")&&-1===value.indexOf(" "))&&input.setSelectionRange(1,length-1,"forward");else if("null"===value)input.setSelectionRange(0,4,"forward");else try{switch(typeof JSON.parse(value)){case"number":case"boolean":input.setSelectionRange(0,length,"forward")}}catch{}}),155),setFocused(!0)},onBlur:()=>{setFocused(!1)},onSubmit:e=>{inputRef.current&&inputRef.current.blur(),(e=>{let newValue;e&&e.preventDefault(),e&&e.stopPropagation();try{newValue=JSON.parse(proposed)}catch{newValue=String(proposed)}onChange&&onChange(newValue)})(e)},onCancel:()=>{json!==proposed?setProposed(json):inputRef.current&&inputRef.current.blur()},onTab:e=>{const ahead=typeahead(proposed);ahead&&(e.preventDefault(),setProposed(proposed+ahead))}})})};ValueInput.displayName="ValueInput";try{ValueInput.displayName="ValueInput",ValueInput.__docgenInfo={description:"",displayName:"ValueInput",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"unknown"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: unknown) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/ValueInput.tsx#ValueInput"]={docgenInfo:ValueInput.__docgenInfo,name:"ValueInput",path:"src/ClickableJson/ValueInput.tsx#ValueInput"})}catch(__react_docgen_typescript_loader_error){}const JsonValue=props=>{const{pointer,property,doc,comma,onChange}=props,theme=(0,nano_theme_lib.useTheme)(),value=react.useMemo((()=>null===doc?"null":"boolean"==typeof doc?doc?"true":"false":"string"==typeof doc?JSON.stringify(doc):String(doc)),[doc,theme]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["string"==typeof property&&(0,jsx_runtime.jsx)(JsonProperty,{pointer,onChange}),onChange?(0,jsx_runtime.jsx)(ValueInput,{value:doc,onChange:newValue=>{onChange&&onChange([{op:"replace",path:pointer,value:newValue}])}}):(0,jsx_runtime.jsx)("span",{style:{color:valueColor(!theme.isLight,doc)},children:value}),!!comma&&","]})};try{JsonValue.displayName="JsonValue",JsonValue.__docgenInfo={description:"",displayName:"JsonValue",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},property:{defaultValue:null,description:"",name:"property",required:!1,type:{name:"string | number"}},doc:{defaultValue:null,description:"",name:"doc",required:!0,type:{name:"unknown"}},comma:{defaultValue:null,description:"",name:"comma",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonValue.tsx#JsonValue"]={docgenInfo:JsonValue.__docgenInfo,name:"JsonValue",path:"src/ClickableJson/JsonValue.tsx#JsonValue"})}catch(__react_docgen_typescript_loader_error){}var json_pointer=__webpack_require__("./node_modules/json-joy/lib/json-pointer/index.js");const JsonObjectInsert=_ref=>{let{pointer,visible}=_ref;const[t]=(0,lib.NT)(),{onChange}=react.useContext(context),[editing,setEditing]=react.useState(!1),[property,setProperty]=react.useState(""),[value,setValue]=react.useState(""),inputPropertyRef=react.useRef(null),inputValueRef=react.useRef(null),insButtonClass=useInsButton(),theme=(0,nano_theme_lib.useTheme)();if(!onChange)return null;if(editing){const keyInput=(0,jsx_runtime.jsx)("span",{className:css_property+input,style:{color:theme.g(.1),background:theme.bg,display:visible?void 0:"none",margin:"-1px 0 -1px -2px",padding:"3px 4px",border:`1px solid ${theme.g(.85)}`,fontWeight:"bold"},children:(0,jsx_runtime.jsx)(FlexibleInput.o,{focus:!0,inp:el=>inputPropertyRef.current=el,value:property,onChange:e=>setProperty(e.target.value),onBlur:()=>{inputValueRef.current&&inputValueRef.current.focus()},onSubmit:()=>{inputValueRef.current&&inputValueRef.current.focus()},onCancel:()=>{property?setProperty(""):value?setValue(""):setEditing(!1)}})}),valueInput=(0,jsx_runtime.jsx)("span",{className:input,style:{...inputStyle(theme,!theme.isLight,value),display:visible?void 0:"none",margin:"-1px 0 -1px -2px",padding:"3px 4px",border:`1px solid ${theme.g(.85)}`},children:(0,jsx_runtime.jsx)(FlexibleInput.o,{inp:el=>inputValueRef.current=el,value,typeahead:typeahead(value),onChange:e=>setValue(e.target.value),onSubmit:()=>{inputValueRef.current&&inputValueRef.current.blur(),(()=>{let newValue;try{newValue=JSON.parse(value)}catch{newValue=String(value)}onChange([{op:"add",path:pointer+"/"+(0,json_pointer.escapeComponent)(property),value:newValue}]),setProperty(""),setValue(""),setEditing(!1)})()},onCancel:()=>{value?setValue(""):inputPropertyRef.current&&inputPropertyRef.current.focus()},onTab:e=>{const ahead=typeahead(value);ahead&&(e.preventDefault(),setValue(value+ahead))}})});return(0,jsx_runtime.jsxs)("span",{style:{display:visible?void 0:"none"},children:[keyInput,(0,jsx_runtime.jsx)("span",{className:colon,children:(0,jsx_runtime.jsx)("span",{children:":"})}),valueInput]})}return(0,jsx_runtime.jsxs)("span",{className:insArrBlock,style:{display:visible?void 0:"none"},onClick:()=>setEditing(!0),children:[(0,jsx_runtime.jsx)("span",{className:insArrDot}),(0,jsx_runtime.jsx)("span",{className:insArrLine}),(0,jsx_runtime.jsx)("button",{className:insButton+insButtonClass+insArrButton,children:"+"}),(0,jsx_runtime.jsx)("span",{className:tooltip+insArrTooltip,children:t("Add key")})]})};JsonObjectInsert.displayName="JsonObjectInsert";try{JsonObjectInsert.displayName="JsonObjectInsert",JsonObjectInsert.__docgenInfo={description:"",displayName:"JsonObjectInsert",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonObjectInsert.tsx#JsonObjectInsert"]={docgenInfo:JsonObjectInsert.__docgenInfo,name:"JsonObjectInsert",path:"src/ClickableJson/JsonObjectInsert.tsx#JsonObjectInsert"})}catch(__react_docgen_typescript_loader_error){}const JsonArrayInsert=_ref=>{let{pointer,visible}=_ref;const[t]=(0,lib.NT)(),{onChange}=react.useContext(context),[editing,setEditing]=react.useState(!1),[value,setValue]=react.useState(""),inputRef=react.useRef(null),insButtonClass=useInsButton(),theme=(0,nano_theme_lib.useTheme)();if(!onChange)return null;if(editing){const style=inputStyle(theme,!theme.isLight,value);return style.display=visible?void 0:"none",style.margin="-1px 0 -1px -2px",style.padding="3px 4px",style.border=`1px solid ${theme.g(.85)}`,(0,jsx_runtime.jsx)("span",{className:input,style,children:(0,jsx_runtime.jsx)(FlexibleInput.o,{focus:!0,inp:el=>inputRef.current=el,value,typeahead:typeahead(value),onChange:e=>setValue(e.target.value),onFocus:()=>{},onBlur:()=>{setEditing(!1)},onSubmit:()=>{inputRef.current&&inputRef.current.blur(),(()=>{let newValue;try{newValue=JSON.parse(value)}catch{newValue=String(value)}onChange([{op:"add",path:pointer,value:newValue}]),setValue(""),setEditing(!1)})()},onCancel:()=>{value?setValue(""):setEditing(!1)},onTab:e=>{const ahead=typeahead(value);ahead&&(e.preventDefault(),setValue(value+ahead))}})})}return(0,jsx_runtime.jsxs)("span",{className:insArrBlock,style:{display:visible?void 0:"none"},onClick:()=>setEditing(!0),children:[(0,jsx_runtime.jsx)("span",{className:insArrDot}),(0,jsx_runtime.jsx)("span",{className:insArrLine}),(0,jsx_runtime.jsx)("button",{className:insArrButton+insButton+insButtonClass,children:"+"}),(0,jsx_runtime.jsx)("span",{className:tooltip+insArrTooltip,children:t("Insert")})]})};JsonArrayInsert.displayName="JsonArrayInsert";try{JsonArrayInsert.displayName="JsonArrayInsert",JsonArrayInsert.__docgenInfo={description:"",displayName:"JsonArrayInsert",props:{pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonArrayInsert.tsx#JsonArrayInsert"]={docgenInfo:JsonArrayInsert.__docgenInfo,name:"JsonArrayInsert",path:"src/ClickableJson/JsonArrayInsert.tsx#JsonArrayInsert"})}catch(__react_docgen_typescript_loader_error){}const JsonObject=_ref=>{let{property,doc,pointer,comma,onChange}=_ref;const{activePointer,formal,keepOrder}=react.useContext(context),keys=react.useMemo((()=>{const k=Object.keys(doc);return keepOrder?k:k.sort()}),[doc]),[collapsed,setCollapsed]=react.useState(!1),[brackedHovered,setBracketHovered]=react.useState(!1),theme=(0,nano_theme_lib.useTheme)(),onBracketMouseEnter=()=>{setBracketHovered(!0)},onBracketMouseLeave=()=>{setBracketHovered(!1)},handleBracketClick=()=>{collapsed||pointer!==activePointer||setCollapsed(!0)},bracketColor=theme.g(.3);return(0,jsx_runtime.jsxs)("span",{className:object,onClick:()=>{collapsed&&setCollapsed(!1)},children:[(0,jsx_runtime.jsx)("span",{className:collapser,style:{color:theme.g(.6)},onClick:()=>setCollapsed((x=>!x)),children:collapsed?"+":"—"}),(0,jsx_runtime.jsxs)("span",{children:["string"==typeof property&&(0,jsx_runtime.jsx)(JsonProperty,{pointer,onChange}),(0,jsx_runtime.jsx)("span",{className:bracket+(brackedHovered?bracketHovered:""),style:{display:collapsed?"none":void 0,color:bracketColor},onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"{"}),(0,jsx_runtime.jsxs)("span",{className:css_collapsed,style:{display:collapsed?void 0:"none"},children:[(0,jsx_runtime.jsx)("span",{style:{color:blue},children:"{"}),!!keys.length&&(0,jsx_runtime.jsx)("strong",{children:keys.length}),(0,jsx_runtime.jsx)("span",{style:{color:blue},children:"}"})]})]}),(0,jsx_runtime.jsxs)("span",{className:list,style:{display:collapsed?"none":void 0},children:[keys.map(((key,index)=>{const itemPointer=`${pointer}/${key}`;return(0,jsx_runtime.jsx)("span",{className:line,children:(0,jsx_runtime.jsx)(JsonHoverable,{pointer:itemPointer,children:(0,jsx_runtime.jsx)("span",{className:lineInner,children:(0,jsx_runtime.jsx)(JsonDoc,{property:key,doc:doc[key],pointer:itemPointer,comma:formal&&index<keys.length-1,onChange})})})},key)})),(0,jsx_runtime.jsx)(JsonObjectInsert,{pointer,visible:activePointer===pointer})]}),(0,jsx_runtime.jsx)("span",{className:bracket+(brackedHovered?bracketHovered:""),style:{display:collapsed?"none":void 0,color:bracketColor},onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"}"}),!!comma&&","]})};JsonObject.displayName="JsonObject";const JsonArray=_ref2=>{let{property,doc,pointer,comma,onChange}=_ref2;const[collapsed,setCollapsed]=react.useState(!1),[brackedHovered,setBracketHovered]=react.useState(!1),{activePointer,formal:selectable}=react.useContext(context),theme=(0,nano_theme_lib.useTheme)(),onBracketMouseEnter=()=>{setBracketHovered(!0)},onBracketMouseLeave=()=>{setBracketHovered(!1)},handleBracketClick=()=>{collapsed||pointer!==activePointer||setCollapsed(!0)},bracketColor=theme.g(.3);return(0,jsx_runtime.jsxs)("span",{className:object,onClick:()=>{collapsed&&setCollapsed(!1)},children:[(0,jsx_runtime.jsx)("span",{className:collapser,style:{color:theme.g(.6)},onClick:()=>setCollapsed((x=>!x)),children:collapsed?"+":"—"}),(0,jsx_runtime.jsxs)("span",{children:["string"==typeof property&&(0,jsx_runtime.jsx)(JsonProperty,{pointer,onChange}),(0,jsx_runtime.jsx)("span",{className:bracket+(brackedHovered?bracketHovered:""),style:{display:collapsed?"none":void 0,color:bracketColor},onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"["}),(0,jsx_runtime.jsxs)("span",{className:css_collapsed,style:{display:collapsed?void 0:"none"},children:[(0,jsx_runtime.jsx)("span",{style:{color:blue},children:"["}),!!doc.length&&(0,jsx_runtime.jsx)("strong",{children:doc.length}),(0,jsx_runtime.jsx)("span",{style:{color:blue},children:"]"})]})]}),(0,jsx_runtime.jsxs)("span",{className:list,style:{display:collapsed?"none":void 0},children:[doc.map(((value,index)=>{const itemPointer=`${pointer}/${index}`;return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)(JsonArrayInsert,{pointer:`${pointer}/${index}`,visible:activePointer===pointer}),(0,jsx_runtime.jsx)("span",{className:line,children:(0,jsx_runtime.jsx)(JsonHoverable,{pointer:itemPointer,children:(0,jsx_runtime.jsx)("span",{className:lineInner,children:(0,jsx_runtime.jsx)(JsonDoc,{doc:doc[index],pointer:itemPointer,comma:selectable&&index<doc.length-1,onChange})})})})]},index)})),(0,jsx_runtime.jsx)(JsonArrayInsert,{pointer:`${pointer}/-`,visible:activePointer===pointer})]}),(0,jsx_runtime.jsx)("span",{className:bracket+(brackedHovered?bracketHovered:""),style:{display:collapsed?"none":void 0,color:bracketColor},onMouseEnter:onBracketMouseEnter,onMouseLeave:onBracketMouseLeave,onClick:handleBracketClick,children:"]"}),!!comma&&","]})};JsonArray.displayName="JsonArray";const JsonDoc=props=>{const{doc,comma}=props;return doc&&"object"==typeof doc?Array.isArray(doc)?(0,jsx_runtime.jsx)(JsonArray,{...props,doc,comma}):(0,jsx_runtime.jsx)(JsonObject,{...props,doc,comma}):(0,jsx_runtime.jsx)(JsonValue,{...props,comma})};try{JsonDoc.displayName="JsonDoc",JsonDoc.__docgenInfo={description:"",displayName:"JsonDoc",props:{property:{defaultValue:null,description:"",name:"property",required:!1,type:{name:"string | number"}},doc:{defaultValue:null,description:"",name:"doc",required:!0,type:{name:"unknown"}},pointer:{defaultValue:null,description:"",name:"pointer",required:!0,type:{name:"string"}},comma:{defaultValue:null,description:"",name:"comma",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/JsonDoc.tsx#JsonDoc"]={docgenInfo:JsonDoc.__docgenInfo,name:"JsonDoc",path:"src/ClickableJson/JsonDoc.tsx#JsonDoc"})}catch(__react_docgen_typescript_loader_error){}const ClickableJson=props=>{const isMounted=(0,useMountedState.Z)(),[hoverPointer,setHoverPointer]=react.useState(null),[activePointer,setActivePointer]=react.useState(null),[isInputFocused,setIsInputFocused]=react.useState(!1),ref=react.useRef(null);(0,useClickAway.Z)(ref,(()=>{isMounted&&setActivePointer(null)})),react.useEffect((()=>{const onFocusIn=()=>{setIsInputFocused(!!document.activeElement&&"INPUT"===document.activeElement.tagName)};return document.addEventListener("focus",onFocusIn,!0),document.addEventListener("blur",onFocusIn,!0),()=>{document.removeEventListener("focus",onFocusIn),document.removeEventListener("blur",onFocusIn)}}),[]);const onChange=props.readonly?void 0:props.onChange;return(0,jsx_runtime.jsx)(context.Provider,{value:{hoverPointer,setHoverPointer:value=>{isMounted&&setHoverPointer(value)},activePointer,setActivePointer:value=>{isMounted&&setActivePointer(value)},onChange,formal:props.formal,compact:props.compact,keepOrder:props.keepOrder,isInputFocused},children:(0,jsx_runtime.jsx)(JsonHoverable,{pointer:"",children:(0,jsx_runtime.jsx)("span",{ref,className:block,style:{fontSize:props.fontSize||"13.4px"},children:(0,jsx_runtime.jsx)(JsonDoc,{...props,pointer:"",onChange})})})})};ClickableJson.displayName="ClickableJson";try{ClickableJson.displayName="ClickableJson",ClickableJson.__docgenInfo={description:"",displayName:"ClickableJson",props:{doc:{defaultValue:null,description:"The JSON to display. Can be any JSON value.",name:"doc",required:!0,type:{name:"unknown"}},readonly:{defaultValue:{value:"false"},description:"If true, the JSON is not editable. Useful for displaying JSON.",name:"readonly",required:!1,type:{name:"boolean"}},formal:{defaultValue:{value:"false"},description:"Print the JSON in a more formal way. Adds quotes to keys and string values.\nAdds commas after each property.\n\nWorks only in readonly mode.",name:"formal",required:!1,type:{name:"boolean"}},keepOrder:{defaultValue:{value:"false"},description:"Keep the order of properties in objects. By default the properties are\nsorted alphabetically.",name:"keepOrder",required:!1,type:{name:"boolean"}},fontSize:{defaultValue:{value:"'13.4px'"},description:"Font size of the JSON.",name:"fontSize",required:!1,type:{name:"string"}},compact:{defaultValue:{value:"false"},description:"If true, the JSON is printed in a compact way. Reduces spacing between\nelements.",name:"compact",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"Callback called when the JSON is changed. The callback receives a [JSON Patch\n(RFC 6902)](https://datatracker.ietf.org/doc/html/rfc6902) as an argument.",name:"onChange",required:!1,type:{name:"OnChange"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ClickableJson/index.tsx#ClickableJson"]={docgenInfo:ClickableJson.__docgenInfo,name:"ClickableJson",path:"src/ClickableJson/index.tsx#ClickableJson"})}catch(__react_docgen_typescript_loader_error){}var json_patch=__webpack_require__("./node_modules/json-joy/lib/json-patch/index.js");const index_stories={title:"ClickableJson",component:ClickableJson,parameters:{layout:"centered"},tags:["autodocs"],argTypes:{}},doc1={support:"https://github.com/sponsors/streamich",license:"use it if you support me",foo:null,test:123,developer:{name:"@streamich"}},doc2={id:"pj7ryzaia1",model:1.6,cid:"og6f0o9v1c",type:"p",created:1596445997247,modified:1596445997381,pid:"92lmu7fs9a",depth:1,mime:"image/png",ext:"png",file:"image.png",w:624,h:1390,omark:[{x1:.027777777777777776,y1:.8438848920863309,x2:.25,y2:.8827338129496403}],isPost:!0,isMature:!1,parent:null,poster:{id:"xxsdfasdf-asdf-asdf-asdf-asdfasdfasdf",name:"Muhammad",list:[1,-5,!0,!1,null,"asdf"]}},Primary={args:{doc:doc1,onChange:patch=>console.log("onChange",patch)}},Readonly={args:{doc:doc1,onChange:void 0}},FormalAndCompact={args:{doc:doc1,readonly:!0,formal:!0,compact:!0}},Demo=props=>{const[doc,setDoc]=react.useState(props.doc);return(0,jsx_runtime.jsx)("div",{style:{padding:"32px 64px"},children:(0,jsx_runtime.jsx)(ClickableJson,{...props,doc,onChange:patch=>{const result=(0,json_patch.applyPatch)(doc,patch,{mutate:!1});setDoc(result.doc)}})})};Demo.displayName="Demo";const Interactive={render:()=>(0,jsx_runtime.jsx)(Demo,{doc:doc1}),parameters:{layout:"fullscreen"}},InteractiveEmpty={render:()=>(0,jsx_runtime.jsx)(Demo,{doc:null}),parameters:{layout:"fullscreen"}},InteractiveLarge={render:()=>(0,jsx_runtime.jsx)(Demo,{doc:doc2}),parameters:{layout:"fullscreen"}};Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc1,\n    onChange: (patch: unknown) => console.log('onChange', patch)\n  } as any)\n}",...Primary.parameters?.docs?.source}}},Readonly.parameters={...Readonly.parameters,docs:{...Readonly.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc1,\n    onChange: undefined\n  } as any)\n}",...Readonly.parameters?.docs?.source}}},FormalAndCompact.parameters={...FormalAndCompact.parameters,docs:{...FormalAndCompact.parameters?.docs,source:{originalSource:"{\n  args: ({\n    doc: doc1,\n    readonly: true,\n    formal: true,\n    compact: true\n  } as any)\n}",...FormalAndCompact.parameters?.docs?.source}}},Interactive.parameters={...Interactive.parameters,docs:{...Interactive.parameters?.docs,source:{originalSource:"{\n  render: () => <Demo doc={doc1} />,\n  parameters: {\n    layout: 'fullscreen'\n  }\n}",...Interactive.parameters?.docs?.source}}},InteractiveEmpty.parameters={...InteractiveEmpty.parameters,docs:{...InteractiveEmpty.parameters?.docs,source:{originalSource:"{\n  render: () => <Demo doc={null} />,\n  parameters: {\n    layout: 'fullscreen'\n  }\n}",...InteractiveEmpty.parameters?.docs?.source}}},InteractiveLarge.parameters={...InteractiveLarge.parameters,docs:{...InteractiveLarge.parameters?.docs,source:{originalSource:"{\n  render: () => <Demo doc={doc2} />,\n  parameters: {\n    layout: 'fullscreen'\n  }\n}",...InteractiveLarge.parameters?.docs?.source}}};const __namedExportsOrder=["Primary","Readonly","FormalAndCompact","Interactive","InteractiveEmpty","InteractiveLarge"]},"./src/FlexibleInput/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>FlexibleInput});var react=__webpack_require__("./node_modules/react/index.js"),lib=__webpack_require__("./node_modules/nano-theme/lib/index.js");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const blockClass=(0,lib.rule)({d:"inline-block",pos:"relative"}),inputClass=(0,lib.rule)({bxz:"border-box",ov:"hidden",pd:0,mr:0,bd:0,bg:0,out:0,col:"inherit",fw:"inherit",f:"inherit"}),sizerClass=(0,lib.rule)({pos:"absolute",ov:"hidden",pe:"none",us:"none",bxz:"border-box",t:0,l:0,ws:"pre"}),FlexibleInput=_ref=>{let{inp,value,typeahead="",extraWidth,minWidth=8,maxWidth,focus,onChange,onFocus,onBlur,onKeyDown,onSubmit,onCancel,onTab}=_ref;const inputRef=react.useRef(null),sizerRef=react.useRef(null),theme=(0,lib.useTheme)();return react.useLayoutEffect((()=>{inputRef.current&&sizerRef.current&&(focus&&inputRef.current.focus(),((from,to,which)=>{const styles=window.getComputedStyle(from);if(styles)for(const property of which)to.style[property]=styles[property]})(inputRef.current,sizerRef.current,["font","fontSize","fontFamily","fontWeight","fontStyle","lineHeight","letterSpacing","textTransform","height","boxSizing"]))}),[]),react.useLayoutEffect((()=>{if(!inputRef.current||!sizerRef.current)return;let width=sizerRef.current.scrollWidth;extraWidth&&(width+=extraWidth),minWidth&&(width=Math.max(width,minWidth)),maxWidth&&(width=Math.min(width,maxWidth)),inputRef.current.style.width=width+"px"}),[value,typeahead,extraWidth]),(0,jsx_runtime.jsxs)("div",{className:blockClass,children:[(0,jsx_runtime.jsx)("input",{ref:input=>{inputRef.current=input,inp&&inp(input)},className:inputClass,value,onChange,onFocus,onBlur,onKeyDown:e=>{"Enter"===e.key?onSubmit&&onSubmit(e):"Escape"===e.key?onCancel&&onCancel(e):"Tab"===e.key&&onTab&&onTab(e),onKeyDown&&onKeyDown(e)}}),(0,jsx_runtime.jsxs)("div",{ref:sizerRef,className:sizerClass,children:[(0,jsx_runtime.jsx)("span",{style:{visibility:"hidden"},children:value}),(0,jsx_runtime.jsx)("span",{style:{color:theme.g(.7)},children:typeahead})]})]})};FlexibleInput.displayName="FlexibleInput";try{FlexibleInput.displayName="FlexibleInput",FlexibleInput.__docgenInfo={description:"",displayName:"FlexibleInput",props:{inp:{defaultValue:null,description:"Ref to the input element.",name:"inp",required:!1,type:{name:"((el: HTMLInputElement | null) => void)"}},value:{defaultValue:null,description:"Value to display.",name:"value",required:!0,type:{name:"string"}},typeahead:{defaultValue:{value:""},description:"Typeahead string to add to the value. It is visible at half opacity.",name:"typeahead",required:!1,type:{name:"string"}},extraWidth:{defaultValue:null,description:"Addition width to add, for example, to account for number stepper.",name:"extraWidth",required:!1,type:{name:"number"}},minWidth:{defaultValue:{value:"8"},description:"Minimum width to allow.",name:"minWidth",required:!1,type:{name:"number"}},maxWidth:{defaultValue:null,description:"Maximum width to allow.",name:"maxWidth",required:!1,type:{name:"number"}},focus:{defaultValue:null,description:"Whether the input is focused on initial render.",name:"focus",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"Callback for when the value changes.",name:"onChange",required:!1,type:{name:"ChangeEventHandler<HTMLInputElement>"}},onFocus:{defaultValue:null,description:"Callback for when the input is focused.",name:"onFocus",required:!1,type:{name:"FocusEventHandler<HTMLInputElement>"}},onBlur:{defaultValue:null,description:"Callback for when the input is blurred.",name:"onBlur",required:!1,type:{name:"FocusEventHandler<HTMLInputElement>"}},onKeyDown:{defaultValue:null,description:"Callback for when a key is pressed.",name:"onKeyDown",required:!1,type:{name:"KeyboardEventHandler<HTMLInputElement>"}},onSubmit:{defaultValue:null,description:"Callback for when the Enter key is pressed.",name:"onSubmit",required:!1,type:{name:"KeyboardEventHandler<HTMLInputElement>"}},onCancel:{defaultValue:null,description:"Callback for when the Escape key is pressed.",name:"onCancel",required:!1,type:{name:"KeyboardEventHandler<HTMLInputElement>"}},onTab:{defaultValue:null,description:"Callback for when the Tab key is pressed.",name:"onTab",required:!1,type:{name:"KeyboardEventHandler<HTMLInputElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/FlexibleInput/index.tsx#FlexibleInput"]={docgenInfo:FlexibleInput.__docgenInfo,name:"FlexibleInput",path:"src/FlexibleInput/index.tsx#FlexibleInput"})}catch(__react_docgen_typescript_loader_error){}}}]);