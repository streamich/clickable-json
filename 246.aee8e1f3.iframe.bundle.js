(self.webpackChunkclickable_json=self.webpackChunkclickable_json||[]).push([[246],{"./node_modules/fast-diff/diff.js":module=>{var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;function diff_main(text1,text2,cursor_pos,cleanup,_fix_unicode){if(text1===text2)return text1?[[DIFF_EQUAL,text1]]:[];if(null!=cursor_pos){var editdiff=function find_cursor_edit_diff(oldText,newText,cursor_pos){var oldRange="number"==typeof cursor_pos?{index:cursor_pos,length:0}:cursor_pos.oldRange,newRange="number"==typeof cursor_pos?null:cursor_pos.newRange,oldLength=oldText.length,newLength=newText.length;if(0===oldRange.length&&(null===newRange||0===newRange.length)){var oldCursor=oldRange.index,oldBefore=oldText.slice(0,oldCursor),oldAfter=oldText.slice(oldCursor),maybeNewCursor=newRange?newRange.index:null,newCursor=oldCursor+newLength-oldLength;if((null===maybeNewCursor||maybeNewCursor===newCursor)&&!(newCursor<0||newCursor>newLength)){var newBefore=newText.slice(0,newCursor);if((newAfter=newText.slice(newCursor))===oldAfter){var prefixLength=Math.min(oldCursor,newCursor);if((oldPrefix=oldBefore.slice(0,prefixLength))===(newPrefix=newBefore.slice(0,prefixLength)))return make_edit_splice(oldPrefix,oldBefore.slice(prefixLength),newBefore.slice(prefixLength),oldAfter)}}if(null===maybeNewCursor||maybeNewCursor===oldCursor){var cursor=oldCursor,newAfter=(newBefore=newText.slice(0,cursor),newText.slice(cursor));if(newBefore===oldBefore){var suffixLength=Math.min(oldLength-cursor,newLength-cursor);if((oldSuffix=oldAfter.slice(oldAfter.length-suffixLength))===(newSuffix=newAfter.slice(newAfter.length-suffixLength)))return make_edit_splice(oldBefore,oldAfter.slice(0,oldAfter.length-suffixLength),newAfter.slice(0,newAfter.length-suffixLength),oldSuffix)}}}if(oldRange.length>0&&newRange&&0===newRange.length){var oldPrefix=oldText.slice(0,oldRange.index),oldSuffix=oldText.slice(oldRange.index+oldRange.length);if(!(newLength<(prefixLength=oldPrefix.length)+(suffixLength=oldSuffix.length))){var newPrefix=newText.slice(0,prefixLength),newSuffix=newText.slice(newLength-suffixLength);if(oldPrefix===newPrefix&&oldSuffix===newSuffix)return make_edit_splice(oldPrefix,oldText.slice(prefixLength,oldLength-suffixLength),newText.slice(prefixLength,newLength-suffixLength),oldSuffix)}}return null}(text1,text2,cursor_pos);if(editdiff)return editdiff}var commonlength=diff_commonPrefix(text1,text2),commonprefix=text1.substring(0,commonlength);commonlength=diff_commonSuffix(text1=text1.substring(commonlength),text2=text2.substring(commonlength));var commonsuffix=text1.substring(text1.length-commonlength),diffs=function diff_compute_(text1,text2){var diffs;if(!text1)return[[DIFF_INSERT,text2]];if(!text2)return[[DIFF_DELETE,text1]];var longtext=text1.length>text2.length?text1:text2,shorttext=text1.length>text2.length?text2:text1,i=longtext.indexOf(shorttext);if(-1!==i)return diffs=[[DIFF_INSERT,longtext.substring(0,i)],[DIFF_EQUAL,shorttext],[DIFF_INSERT,longtext.substring(i+shorttext.length)]],text1.length>text2.length&&(diffs[0][0]=diffs[2][0]=DIFF_DELETE),diffs;if(1===shorttext.length)return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]];var hm=function diff_halfMatch_(text1,text2){var longtext=text1.length>text2.length?text1:text2,shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||2*shorttext.length<longtext.length)return null;function diff_halfMatchI_(longtext,shorttext,i){for(var best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,seed=longtext.substring(i,i+Math.floor(longtext.length/4)),j=-1,best_common="";-1!==(j=shorttext.indexOf(seed,j+1));){var prefixLength=diff_commonPrefix(longtext.substring(i),shorttext.substring(j)),suffixLength=diff_commonSuffix(longtext.substring(0,i),shorttext.substring(0,j));best_common.length<suffixLength+prefixLength&&(best_common=shorttext.substring(j-suffixLength,j)+shorttext.substring(j,j+prefixLength),best_longtext_a=longtext.substring(0,i-suffixLength),best_longtext_b=longtext.substring(i+prefixLength),best_shorttext_a=shorttext.substring(0,j-suffixLength),best_shorttext_b=shorttext.substring(j+prefixLength))}return 2*best_common.length>=longtext.length?[best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,best_common]:null}var hm,text1_a,text1_b,text2_a,text2_b,hm1=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/4)),hm2=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/2));if(!hm1&&!hm2)return null;hm=hm2?hm1&&hm1[4].length>hm2[4].length?hm1:hm2:hm1;text1.length>text2.length?(text1_a=hm[0],text1_b=hm[1],text2_a=hm[2],text2_b=hm[3]):(text2_a=hm[0],text2_b=hm[1],text1_a=hm[2],text1_b=hm[3]);var mid_common=hm[4];return[text1_a,text1_b,text2_a,text2_b,mid_common]}(text1,text2);if(hm){var text1_a=hm[0],text1_b=hm[1],text2_a=hm[2],text2_b=hm[3],mid_common=hm[4],diffs_a=diff_main(text1_a,text2_a),diffs_b=diff_main(text1_b,text2_b);return diffs_a.concat([[DIFF_EQUAL,mid_common]],diffs_b)}return function diff_bisect_(text1,text2){for(var text1_length=text1.length,text2_length=text2.length,max_d=Math.ceil((text1_length+text2_length)/2),v_offset=max_d,v_length=2*max_d,v1=new Array(v_length),v2=new Array(v_length),x=0;x<v_length;x++)v1[x]=-1,v2[x]=-1;v1[v_offset+1]=0,v2[v_offset+1]=0;for(var delta=text1_length-text2_length,front=delta%2!=0,k1start=0,k1end=0,k2start=0,k2end=0,d=0;d<max_d;d++){for(var k1=-d+k1start;k1<=d-k1end;k1+=2){for(var k1_offset=v_offset+k1,y1=(x1=k1===-d||k1!==d&&v1[k1_offset-1]<v1[k1_offset+1]?v1[k1_offset+1]:v1[k1_offset-1]+1)-k1;x1<text1_length&&y1<text2_length&&text1.charAt(x1)===text2.charAt(y1);)x1++,y1++;if(v1[k1_offset]=x1,x1>text1_length)k1end+=2;else if(y1>text2_length)k1start+=2;else if(front){if((k2_offset=v_offset+delta-k1)>=0&&k2_offset<v_length&&-1!==v2[k2_offset])if(x1>=(x2=text1_length-v2[k2_offset]))return diff_bisectSplit_(text1,text2,x1,y1)}}for(var k2=-d+k2start;k2<=d-k2end;k2+=2){for(var x2,k2_offset=v_offset+k2,y2=(x2=k2===-d||k2!==d&&v2[k2_offset-1]<v2[k2_offset+1]?v2[k2_offset+1]:v2[k2_offset-1]+1)-k2;x2<text1_length&&y2<text2_length&&text1.charAt(text1_length-x2-1)===text2.charAt(text2_length-y2-1);)x2++,y2++;if(v2[k2_offset]=x2,x2>text1_length)k2end+=2;else if(y2>text2_length)k2start+=2;else if(!front){if((k1_offset=v_offset+delta-k2)>=0&&k1_offset<v_length&&-1!==v1[k1_offset]){var x1;y1=v_offset+(x1=v1[k1_offset])-k1_offset;if(x1>=(x2=text1_length-x2))return diff_bisectSplit_(text1,text2,x1,y1)}}}}return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]]}(text1,text2)}(text1=text1.substring(0,text1.length-commonlength),text2=text2.substring(0,text2.length-commonlength));return commonprefix&&diffs.unshift([DIFF_EQUAL,commonprefix]),commonsuffix&&diffs.push([DIFF_EQUAL,commonsuffix]),diff_cleanupMerge(diffs,_fix_unicode),cleanup&&function diff_cleanupSemantic(diffs){var changes=!1,equalities=[],equalitiesLength=0,lastequality=null,pointer=0,length_insertions1=0,length_deletions1=0,length_insertions2=0,length_deletions2=0;for(;pointer<diffs.length;)diffs[pointer][0]==DIFF_EQUAL?(equalities[equalitiesLength++]=pointer,length_insertions1=length_insertions2,length_deletions1=length_deletions2,length_insertions2=0,length_deletions2=0,lastequality=diffs[pointer][1]):(diffs[pointer][0]==DIFF_INSERT?length_insertions2+=diffs[pointer][1].length:length_deletions2+=diffs[pointer][1].length,lastequality&&lastequality.length<=Math.max(length_insertions1,length_deletions1)&&lastequality.length<=Math.max(length_insertions2,length_deletions2)&&(diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]),diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT,equalitiesLength--,pointer=--equalitiesLength>0?equalities[equalitiesLength-1]:-1,length_insertions1=0,length_deletions1=0,length_insertions2=0,length_deletions2=0,lastequality=null,changes=!0)),pointer++;changes&&diff_cleanupMerge(diffs);(function diff_cleanupSemanticLossless(diffs){function diff_cleanupSemanticScore_(one,two){if(!one||!two)return 6;var char1=one.charAt(one.length-1),char2=two.charAt(0),nonAlphaNumeric1=char1.match(nonAlphaNumericRegex_),nonAlphaNumeric2=char2.match(nonAlphaNumericRegex_),whitespace1=nonAlphaNumeric1&&char1.match(whitespaceRegex_),whitespace2=nonAlphaNumeric2&&char2.match(whitespaceRegex_),lineBreak1=whitespace1&&char1.match(linebreakRegex_),lineBreak2=whitespace2&&char2.match(linebreakRegex_),blankLine1=lineBreak1&&one.match(blanklineEndRegex_),blankLine2=lineBreak2&&two.match(blanklineStartRegex_);return blankLine1||blankLine2?5:lineBreak1||lineBreak2?4:nonAlphaNumeric1&&!whitespace1&&whitespace2?3:whitespace1||whitespace2?2:nonAlphaNumeric1||nonAlphaNumeric2?1:0}var pointer=1;for(;pointer<diffs.length-1;){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){var equality1=diffs[pointer-1][1],edit=diffs[pointer][1],equality2=diffs[pointer+1][1],commonOffset=diff_commonSuffix(equality1,edit);if(commonOffset){var commonString=edit.substring(edit.length-commonOffset);equality1=equality1.substring(0,equality1.length-commonOffset),edit=commonString+edit.substring(0,edit.length-commonOffset),equality2=commonString+equality2}for(var bestEquality1=equality1,bestEdit=edit,bestEquality2=equality2,bestScore=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);edit.charAt(0)===equality2.charAt(0);){equality1+=edit.charAt(0),edit=edit.substring(1)+equality2.charAt(0),equality2=equality2.substring(1);var score=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);score>=bestScore&&(bestScore=score,bestEquality1=equality1,bestEdit=edit,bestEquality2=equality2)}diffs[pointer-1][1]!=bestEquality1&&(bestEquality1?diffs[pointer-1][1]=bestEquality1:(diffs.splice(pointer-1,1),pointer--),diffs[pointer][1]=bestEdit,bestEquality2?diffs[pointer+1][1]=bestEquality2:(diffs.splice(pointer+1,1),pointer--))}pointer++}})(diffs),pointer=1;for(;pointer<diffs.length;){if(diffs[pointer-1][0]==DIFF_DELETE&&diffs[pointer][0]==DIFF_INSERT){var deletion=diffs[pointer-1][1],insertion=diffs[pointer][1],overlap_length1=diff_commonOverlap_(deletion,insertion),overlap_length2=diff_commonOverlap_(insertion,deletion);overlap_length1>=overlap_length2?(overlap_length1>=deletion.length/2||overlap_length1>=insertion.length/2)&&(diffs.splice(pointer,0,[DIFF_EQUAL,insertion.substring(0,overlap_length1)]),diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlap_length1),diffs[pointer+1][1]=insertion.substring(overlap_length1),pointer++):(overlap_length2>=deletion.length/2||overlap_length2>=insertion.length/2)&&(diffs.splice(pointer,0,[DIFF_EQUAL,deletion.substring(0,overlap_length2)]),diffs[pointer-1][0]=DIFF_INSERT,diffs[pointer-1][1]=insertion.substring(0,insertion.length-overlap_length2),diffs[pointer+1][0]=DIFF_DELETE,diffs[pointer+1][1]=deletion.substring(overlap_length2),pointer++),pointer++}pointer++}}(diffs),diffs}function diff_bisectSplit_(text1,text2,x,y){var text1a=text1.substring(0,x),text2a=text2.substring(0,y),text1b=text1.substring(x),text2b=text2.substring(y),diffs=diff_main(text1a,text2a),diffsb=diff_main(text1b,text2b);return diffs.concat(diffsb)}function diff_commonPrefix(text1,text2){if(!text1||!text2||text1.charAt(0)!==text2.charAt(0))return 0;for(var pointermin=0,pointermax=Math.min(text1.length,text2.length),pointermid=pointermax,pointerstart=0;pointermin<pointermid;)text1.substring(pointerstart,pointermid)==text2.substring(pointerstart,pointermid)?pointerstart=pointermin=pointermid:pointermax=pointermid,pointermid=Math.floor((pointermax-pointermin)/2+pointermin);return is_surrogate_pair_start(text1.charCodeAt(pointermid-1))&&pointermid--,pointermid}function diff_commonOverlap_(text1,text2){var text1_length=text1.length,text2_length=text2.length;if(0==text1_length||0==text2_length)return 0;text1_length>text2_length?text1=text1.substring(text1_length-text2_length):text1_length<text2_length&&(text2=text2.substring(0,text1_length));var text_length=Math.min(text1_length,text2_length);if(text1==text2)return text_length;for(var best=0,length=1;;){var pattern=text1.substring(text_length-length),found=text2.indexOf(pattern);if(-1==found)return best;length+=found,0!=found&&text1.substring(text_length-length)!=text2.substring(0,length)||(best=length,length++)}}function diff_commonSuffix(text1,text2){if(!text1||!text2||text1.slice(-1)!==text2.slice(-1))return 0;for(var pointermin=0,pointermax=Math.min(text1.length,text2.length),pointermid=pointermax,pointerend=0;pointermin<pointermid;)text1.substring(text1.length-pointermid,text1.length-pointerend)==text2.substring(text2.length-pointermid,text2.length-pointerend)?pointerend=pointermin=pointermid:pointermax=pointermid,pointermid=Math.floor((pointermax-pointermin)/2+pointermin);return is_surrogate_pair_end(text1.charCodeAt(text1.length-pointermid))&&pointermid--,pointermid}var nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,whitespaceRegex_=/\s/,linebreakRegex_=/[\r\n]/,blanklineEndRegex_=/\n\r?\n$/,blanklineStartRegex_=/^\r?\n\r?\n/;function diff_cleanupMerge(diffs,fix_unicode){diffs.push([DIFF_EQUAL,""]);for(var commonlength,pointer=0,count_delete=0,count_insert=0,text_delete="",text_insert="";pointer<diffs.length;)if(pointer<diffs.length-1&&!diffs[pointer][1])diffs.splice(pointer,1);else switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++,text_insert+=diffs[pointer][1],pointer++;break;case DIFF_DELETE:count_delete++,text_delete+=diffs[pointer][1],pointer++;break;case DIFF_EQUAL:var previous_equality=pointer-count_insert-count_delete-1;if(fix_unicode){if(previous_equality>=0&&ends_with_pair_start(diffs[previous_equality][1])){var stray=diffs[previous_equality][1].slice(-1);if(diffs[previous_equality][1]=diffs[previous_equality][1].slice(0,-1),text_delete=stray+text_delete,text_insert=stray+text_insert,!diffs[previous_equality][1]){diffs.splice(previous_equality,1),pointer--;var k=previous_equality-1;diffs[k]&&diffs[k][0]===DIFF_INSERT&&(count_insert++,text_insert=diffs[k][1]+text_insert,k--),diffs[k]&&diffs[k][0]===DIFF_DELETE&&(count_delete++,text_delete=diffs[k][1]+text_delete,k--),previous_equality=k}}if(starts_with_pair_end(diffs[pointer][1])){stray=diffs[pointer][1].charAt(0);diffs[pointer][1]=diffs[pointer][1].slice(1),text_delete+=stray,text_insert+=stray}}if(pointer<diffs.length-1&&!diffs[pointer][1]){diffs.splice(pointer,1);break}if(text_delete.length>0||text_insert.length>0){text_delete.length>0&&text_insert.length>0&&(0!==(commonlength=diff_commonPrefix(text_insert,text_delete))&&(previous_equality>=0?diffs[previous_equality][1]+=text_insert.substring(0,commonlength):(diffs.splice(0,0,[DIFF_EQUAL,text_insert.substring(0,commonlength)]),pointer++),text_insert=text_insert.substring(commonlength),text_delete=text_delete.substring(commonlength)),0!==(commonlength=diff_commonSuffix(text_insert,text_delete))&&(diffs[pointer][1]=text_insert.substring(text_insert.length-commonlength)+diffs[pointer][1],text_insert=text_insert.substring(0,text_insert.length-commonlength),text_delete=text_delete.substring(0,text_delete.length-commonlength)));var n=count_insert+count_delete;0===text_delete.length&&0===text_insert.length?(diffs.splice(pointer-n,n),pointer-=n):0===text_delete.length?(diffs.splice(pointer-n,n,[DIFF_INSERT,text_insert]),pointer=pointer-n+1):0===text_insert.length?(diffs.splice(pointer-n,n,[DIFF_DELETE,text_delete]),pointer=pointer-n+1):(diffs.splice(pointer-n,n,[DIFF_DELETE,text_delete],[DIFF_INSERT,text_insert]),pointer=pointer-n+2)}0!==pointer&&diffs[pointer-1][0]===DIFF_EQUAL?(diffs[pointer-1][1]+=diffs[pointer][1],diffs.splice(pointer,1)):pointer++,count_insert=0,count_delete=0,text_delete="",text_insert=""}""===diffs[diffs.length-1][1]&&diffs.pop();var changes=!1;for(pointer=1;pointer<diffs.length-1;)diffs[pointer-1][0]===DIFF_EQUAL&&diffs[pointer+1][0]===DIFF_EQUAL&&(diffs[pointer][1].substring(diffs[pointer][1].length-diffs[pointer-1][1].length)===diffs[pointer-1][1]?(diffs[pointer][1]=diffs[pointer-1][1]+diffs[pointer][1].substring(0,diffs[pointer][1].length-diffs[pointer-1][1].length),diffs[pointer+1][1]=diffs[pointer-1][1]+diffs[pointer+1][1],diffs.splice(pointer-1,1),changes=!0):diffs[pointer][1].substring(0,diffs[pointer+1][1].length)==diffs[pointer+1][1]&&(diffs[pointer-1][1]+=diffs[pointer+1][1],diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+diffs[pointer+1][1],diffs.splice(pointer+1,1),changes=!0)),pointer++;changes&&diff_cleanupMerge(diffs,fix_unicode)}function is_surrogate_pair_start(charCode){return charCode>=55296&&charCode<=56319}function is_surrogate_pair_end(charCode){return charCode>=56320&&charCode<=57343}function starts_with_pair_end(str){return is_surrogate_pair_end(str.charCodeAt(0))}function ends_with_pair_start(str){return is_surrogate_pair_start(str.charCodeAt(str.length-1))}function make_edit_splice(before,oldMiddle,newMiddle,after){return ends_with_pair_start(before)||starts_with_pair_end(after)?null:function remove_empty_tuples(tuples){for(var ret=[],i=0;i<tuples.length;i++)tuples[i][1].length>0&&ret.push(tuples[i]);return ret}([[DIFF_EQUAL,before],[DIFF_DELETE,oldMiddle],[DIFF_INSERT,newMiddle],[DIFF_EQUAL,after]])}function diff(text1,text2,cursor_pos,cleanup){return diff_main(text1,text2,cursor_pos,cleanup,!0)}diff.INSERT=DIFF_INSERT,diff.DELETE=DIFF_DELETE,diff.EQUAL=DIFF_EQUAL,module.exports=diff},"./node_modules/hyperdyperid/lib/randomU32.js":(__unused_webpack_module,exports)=>{var x=1+Math.round(4294967294*Math.random());exports.randomU32=function randomU32(min,max){return x^=x<<13,x^=x>>>17,((x^=x<<5)>>>0)%(max-min+1)+min}},"./node_modules/json-joy/es2020/json-crdt-patch/Patch.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Patch=void 0;const operations=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/operations.js")),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),binary_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/index.js");class Patch{constructor(){this.ops=[],this.meta=void 0}static fromBinary(data){return(0,binary_1.decode)(data)}getId(){const op=this.ops[0];if(op)return op.id}span(){let span=0;for(const op of this.ops)span+=op.span();return span}nextTime(){const ops=this.ops,length=ops.length;if(!length)return 0;const lastOp=ops[length-1];return lastOp.id.time+lastOp.span()}rewriteTime(ts){const patch=new Patch,ops=this.ops,length=ops.length,patchOps=patch.ops;for(let i=0;i<length;i++){const op=ops[i];op instanceof operations.DelOp?patchOps.push(new operations.DelOp(ts(op.id),ts(op.obj),op.what)):op instanceof operations.NewConOp?patchOps.push(new operations.NewConOp(ts(op.id),op.val)):op instanceof operations.NewVecOp?patchOps.push(new operations.NewVecOp(ts(op.id))):op instanceof operations.NewValOp?patchOps.push(new operations.NewValOp(ts(op.id))):op instanceof operations.NewObjOp?patchOps.push(new operations.NewObjOp(ts(op.id))):op instanceof operations.NewStrOp?patchOps.push(new operations.NewStrOp(ts(op.id))):op instanceof operations.NewBinOp?patchOps.push(new operations.NewBinOp(ts(op.id))):op instanceof operations.NewArrOp?patchOps.push(new operations.NewArrOp(ts(op.id))):op instanceof operations.InsArrOp?patchOps.push(new operations.InsArrOp(ts(op.id),ts(op.obj),ts(op.ref),op.data.map(ts))):op instanceof operations.InsStrOp?patchOps.push(new operations.InsStrOp(ts(op.id),ts(op.obj),ts(op.ref),op.data)):op instanceof operations.InsBinOp?patchOps.push(new operations.InsBinOp(ts(op.id),ts(op.obj),ts(op.ref),op.data)):op instanceof operations.InsValOp?patchOps.push(new operations.InsValOp(ts(op.id),ts(op.obj),ts(op.val))):op instanceof operations.InsObjOp?patchOps.push(new operations.InsObjOp(ts(op.id),ts(op.obj),op.data.map((([key,value])=>[key,ts(value)])))):op instanceof operations.NopOp&&patchOps.push(new operations.NopOp(ts(op.id),op.len))}return patch}rebase(serverTime,transformHorizon){const id=this.getId();if(!id)throw new Error("EMPTY_PATCH");const patchStartTime=id.time;if(patchStartTime===serverTime)return this;const delta=serverTime-patchStartTime;return this.rewriteTime((id=>{if(!(1===id.sid))return id;const time=id.time;return time<transformHorizon?id:(0,clock_1.ts)(1,time+delta)}))}clone(){return this.rewriteTime((id=>id))}toBinary(){return(0,binary_1.encode)(this)}toString(tab=""){const id=this.getId();let out=`${this.constructor.name} ${id?(0,clock_1.toDisplayString)(id):"(nil)"}!${this.span()}`;for(let i=0;i<this.ops.length;i++){const isLast=i===this.ops.length-1;out+=`\n${tab}${isLast?"└─":"├─"} ${this.ops[i].toString(tab+(isLast?"  ":"│ "))}`}return out}}exports.Patch=Patch},"./node_modules/json-joy/es2020/json-crdt-patch/PatchBuilder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PatchBuilder=void 0;const operations_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/operations.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),isUint8Array_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/isUint8Array.js"),Patch_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/Patch.js"),constants_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/constants.js"),Tuple_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/builder/Tuple.js"),Konst_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/builder/Konst.js"),DelayedValueBuilder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/builder/DelayedValueBuilder.js"),maybeConst=x=>{switch(typeof x){case"number":case"boolean":return!0;default:return null===x}};exports.PatchBuilder=class PatchBuilder{constructor(clock){this.clock=clock,this.patch=new Patch_1.Patch}nextTime(){return this.patch.nextTime()||this.clock.time}flush(){const patch=this.patch;return this.patch=new Patch_1.Patch,patch}obj(){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewObjOp(id)),id}arr(){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewArrOp(id)),id}vec(){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewVecOp(id)),id}str(){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewStrOp(id)),id}bin(){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewBinOp(id)),id}const(value){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewConOp(id,value)),id}val(){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.NewValOp(id)),id}root(val){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.InsValOp(id,constants_1.ORIGIN,val)),id}insObj(obj,data){if(this.pad(),!data.length)throw new Error("EMPTY_TUPLES");const id=this.clock.tick(1),op=new operations_1.InsObjOp(id,obj,data),span=op.span();return span>1&&this.clock.tick(span-1),this.patch.ops.push(op),id}insVec(obj,data){if(this.pad(),!data.length)throw new Error("EMPTY_TUPLES");const id=this.clock.tick(1),op=new operations_1.InsVecOp(id,obj,data),span=op.span();return span>1&&this.clock.tick(span-1),this.patch.ops.push(op),id}setVal(obj,val){this.pad();const id=this.clock.tick(1),op=new operations_1.InsValOp(id,obj,val);return this.patch.ops.push(op),id}insStr(obj,ref,data){if(this.pad(),!data.length)throw new Error("EMPTY_STRING");const id=this.clock.tick(1),op=new operations_1.InsStrOp(id,obj,ref,data),span=op.span();return span>1&&this.clock.tick(span-1),this.patch.ops.push(op),id}insBin(obj,ref,data){if(this.pad(),!data.length)throw new Error("EMPTY_BINARY");const id=this.clock.tick(1),op=new operations_1.InsBinOp(id,obj,ref,data),span=op.span();return span>1&&this.clock.tick(span-1),this.patch.ops.push(op),id}insArr(arr,ref,data){this.pad();const id=this.clock.tick(1),op=new operations_1.InsArrOp(id,arr,ref,data),span=op.span();return span>1&&this.clock.tick(span-1),this.patch.ops.push(op),id}del(obj,what){this.pad();const id=this.clock.tick(1);return this.patch.ops.push(new operations_1.DelOp(id,obj,what)),id}nop(span){this.pad();const id=this.clock.tick(span);return this.patch.ops.push(new operations_1.NopOp(id,span)),id}jsonObj(obj){const id=this.obj(),keys=Object.keys(obj);if(keys.length){const tuples=[];for(const k of keys){const value=obj[k],valueId=value instanceof clock_1.Timestamp?value:maybeConst(value)?this.const(value):this.json(value);tuples.push([k,valueId])}this.insObj(id,tuples)}return id}jsonArr(arr){const id=this.arr();if(arr.length){const values=[];for(const el of arr)values.push(this.json(el));this.insArr(id,id,values)}return id}jsonStr(str){const id=this.str();return str&&this.insStr(id,id,str),id}jsonBin(bin){const id=this.bin();return bin.length&&this.insBin(id,id,bin),id}jsonVal(value){const valId=this.val(),id=this.const(value);return this.setVal(valId,id),valId}jsonVec(vector){const id=this.vec(),length=vector.length;if(length){const writes=[];for(let i=0;i<length;i++)writes.push([i,this.constOrJson(vector[i])]);this.insVec(id,writes)}return id}json(json){if(json instanceof clock_1.Timestamp)return json;if(void 0===json)return this.const(json);if(json instanceof Array)return this.jsonArr(json);if((0,isUint8Array_1.isUint8Array)(json))return this.jsonBin(json);if(json instanceof Tuple_1.VectorDelayedValue)return this.jsonVec(json.slots);if(json instanceof Konst_1.Konst)return this.const(json.val);if(json instanceof DelayedValueBuilder_1.NodeBuilder)return json.build(this);switch(typeof json){case"object":return null===json?this.jsonVal(json):this.jsonObj(json);case"string":return this.jsonStr(json);case"number":case"boolean":return this.jsonVal(json)}throw new Error("INVALID_JSON")}constOrJson(value){return value instanceof clock_1.Timestamp?value:maybeConst(value)?this.const(value):this.json(value)}maybeConst(value){return value instanceof clock_1.Timestamp?value:this.const(value)}pad(){const nextTime=this.patch.nextTime();if(!nextTime)return;const drift=this.clock.time-nextTime;if(drift>0){const id=(0,clock_1.ts)(this.clock.sid,nextTime),padding=new operations_1.NopOp(id,drift);this.patch.ops.push(padding)}}}},"./node_modules/json-joy/es2020/json-crdt-patch/builder/DelayedValueBuilder.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.delayed=exports.NodeBuilder=void 0;class NodeBuilder{constructor(build){this.build=build}}exports.NodeBuilder=NodeBuilder;exports.delayed=build=>new NodeBuilder(build)},"./node_modules/json-joy/es2020/json-crdt-patch/builder/Konst.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.konst=exports.Konst=void 0;class Konst{constructor(val){this.val=val}}exports.Konst=Konst;exports.konst=val=>new Konst(val)},"./node_modules/json-joy/es2020/json-crdt-patch/builder/Tuple.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec=exports.VectorDelayedValue=void 0;class VectorDelayedValue{constructor(slots){this.slots=slots}}exports.VectorDelayedValue=VectorDelayedValue;exports.vec=(...slots)=>new VectorDelayedValue(slots)},"./node_modules/json-joy/es2020/json-crdt-patch/clock/clock.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServerClockVector=exports.ClockVector=exports.LogicalClock=exports.interval=exports.toDisplayString=exports.containsId=exports.contains=exports.compare=exports.equal=exports.tick=exports.tss=exports.ts=exports.Timespan=exports.Timestamp=void 0;class Timestamp{constructor(sid,time){this.sid=sid,this.time=time}}exports.Timestamp=Timestamp;class Timespan{constructor(sid,time,span){this.sid=sid,this.time=time,this.span=span}}exports.Timespan=Timespan;exports.ts=(sid,time)=>new Timestamp(sid,time);exports.tss=(sid,time,span)=>new Timespan(sid,time,span);exports.tick=(stamp,cycles)=>(0,exports.ts)(stamp.sid,stamp.time+cycles);exports.equal=(ts1,ts2)=>ts1.time===ts2.time&&ts1.sid===ts2.sid;exports.compare=(ts1,ts2)=>{const t1=ts1.time,t2=ts2.time;if(t1>t2)return 1;if(t1<t2)return-1;const s1=ts1.sid,s2=ts2.sid;return s1>s2?1:s1<s2?-1:0};exports.contains=(ts1,span1,ts2,span2)=>{if(ts1.sid!==ts2.sid)return!1;const t1=ts1.time,t2=ts2.time;return!(t1>t2)&&!(t1+span1<t2+span2)};exports.containsId=(ts1,span1,ts2)=>{if(ts1.sid!==ts2.sid)return!1;const t1=ts1.time,t2=ts2.time;return!(t1>t2)&&!(t1+span1<t2+1)};exports.toDisplayString=id=>{if(1===id.sid)return"."+id.time;let session=""+id.sid;return session.length>4&&(session=".."+session.slice(session.length-4)),session+"."+id.time};exports.interval=(ts,tick,span)=>new Timespan(ts.sid,ts.time+tick,span);class LogicalClock extends Timestamp{tick(cycles){const timestamp=new Timestamp(this.sid,this.time);return this.time+=cycles,timestamp}}exports.LogicalClock=LogicalClock;class ClockVector extends LogicalClock{constructor(){super(...arguments),this.peers=new Map}observe(id,span){const edge=id.time+span-1,sid=id.sid;if(sid!==this.sid){const clock=this.peers.get(id.sid);clock?edge>clock.time&&(clock.time=edge):this.peers.set(id.sid,(0,exports.ts)(sid,edge))}edge>=this.time&&(this.time=edge+1)}clone(){return this.fork(this.sid)}fork(sessionId){const clock=new ClockVector(sessionId,this.time);return sessionId!==this.sid&&clock.observe((0,exports.tick)(this,-1),1),this.peers.forEach((peer=>{clock.observe(peer,1)})),clock}toString(tab=""){const last=this.peers.size;let i=1,lines="";return this.peers.forEach((clock=>{lines+=`\n${tab}${i===last?"└─":"├─"} ${clock.sid}.${clock.time}`,i++})),`clock ${this.sid}.${this.time}${lines}`}}exports.ClockVector=ClockVector;class ServerClockVector extends LogicalClock{constructor(){super(...arguments),this.peers=new Map}observe(ts,span){if(1!==ts.sid)throw new Error("INVALID_SERVER_SESSION");if(this.time<ts.time)throw new Error("TIME_TRAVEL");const time=ts.time+span;time>this.time&&(this.time=time)}clone(){return this.fork()}fork(){return new ServerClockVector(1,this.time)}}exports.ServerClockVector=ServerClockVector},"./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/types.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/clock.js"),exports)},"./node_modules/json-joy/es2020/json-crdt-patch/clock/types.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},"./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/Decoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Decoder=void 0;const CrdtReader_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtReader.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),PatchBuilder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/PatchBuilder.js"),CborDecoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/cbor/CborDecoder.js");class Decoder extends CborDecoder_1.CborDecoder{constructor(reader=new CrdtReader_1.CrdtReader){super(reader)}decode(data){const reader=this.reader;reader.reset(data);const sid=reader.vu57(),time=reader.vu57(),clock=1===sid?new clock_1.ServerClockVector(1,time):new clock_1.ClockVector(sid,time);this.patchSid=clock.sid;const builder=this.builder=new PatchBuilder_1.PatchBuilder(clock),map=this.val();return map instanceof Array&&(builder.patch.meta=map[0]),this.decodeOperations(),builder.patch}decodeId(){const reader=this.reader,[isSessionDifferent,x]=reader.b1vu56();return isSessionDifferent?new clock_1.Timestamp(reader.vu57(),x):new clock_1.Timestamp(this.patchSid,x)}decodeTss(){const id=this.decodeId(),span=this.reader.vu57();return(0,clock_1.interval)(id,0,span)}decodeOperations(){const length=this.reader.vu57();for(let i=0;i<length;i++)this.decodeOperation()}decodeOperation(){const builder=this.builder,reader=this.reader,octet=reader.u8();switch(octet>>3){case 0:{const length=7&octet;builder.const(length?this.decodeId():this.val());break}case 1:builder.val();break;case 2:builder.obj();break;case 3:builder.vec();break;case 4:builder.str();break;case 5:builder.bin();break;case 6:builder.arr();break;case 9:{const obj=this.decodeId(),val=this.decodeId();builder.setVal(obj,val);break}case 10:{const length=7&octet||reader.vu57(),obj=this.decodeId(),tuples=[];for(let i=0;i<length;i++){const key=this.val();if("string"!=typeof key)continue;const value=this.decodeId();tuples.push([key,value])}builder.insObj(obj,tuples);break}case 11:{const length=7&octet||reader.vu57(),obj=this.decodeId(),tuples=[];for(let i=0;i<length;i++){const index=this.val();if("number"!=typeof index)continue;const value=this.decodeId();tuples.push([index,value])}builder.insVec(obj,tuples);break}case 12:{const length=7&octet||reader.vu57(),obj=this.decodeId(),after=this.decodeId(),str=reader.utf8(length);builder.insStr(obj,after,str);break}case 13:{const length=7&octet||reader.vu57(),obj=this.decodeId(),after=this.decodeId(),buf=reader.buf(length);if(!(buf instanceof Uint8Array))return;builder.insBin(obj,after,buf);break}case 14:{const length=7&octet||reader.vu57(),obj=this.decodeId(),after=this.decodeId(),elements=[];for(let i=0;i<length;i++)elements.push(this.decodeId());builder.insArr(obj,after,elements);break}case 16:{const length=7&octet||reader.vu57(),obj=this.decodeId(),what=[];for(let i=0;i<length;i++)what.push(this.decodeTss());builder.del(obj,what);break}case 17:{const length=7&octet||reader.vu57();builder.nop(length);break}default:throw new Error("UNKNOWN_OP")}}}exports.Decoder=Decoder},"./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/Encoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Encoder=void 0;const operations=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/operations.js")),CrdtWriter_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtWriter.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),CborEncoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/cbor/CborEncoder.js");class Encoder extends CborEncoder_1.CborEncoder{constructor(writer=new CrdtWriter_1.CrdtWriter){super(writer),this.writer=writer,this.patchSid=0}encode(patch){this.writer.reset();const id=patch.getId(),sid=this.patchSid=id.sid,writer=this.writer;writer.vu57(sid),writer.vu57(id.time);const meta=patch.meta;return void 0===meta?this.writeUndef():this.writeArr([meta]),this.encodeOperations(patch),writer.flush()}encodeOperations(patch){const ops=patch.ops,length=ops.length;this.writer.vu57(length);for(let i=0;i<length;i++)this.encodeOperation(ops[i])}encodeId(id){const sessionId=id.sid,time=id.time,writer=this.writer;sessionId===this.patchSid?writer.b1vu56(0,time):(writer.b1vu56(1,time),writer.vu57(sessionId))}encodeTss(span){this.encodeId(span),this.writer.vu57(span.span)}writeInsStr(length,obj,ref,str){const writer=this.writer;return length<=7?writer.u8(96+length):(writer.u8(96),writer.vu57(length)),this.encodeId(obj),this.encodeId(ref),writer.utf8(str)}encodeOperation(op){const writer=this.writer;switch(op.constructor){case operations.NewConOp:{const val=op.val;val instanceof clock_1.Timestamp?(writer.u8(1),this.encodeId(val)):(writer.u8(0),this.writeAny(val));break}case operations.NewValOp:writer.u8(8);break;case operations.NewObjOp:writer.u8(16);break;case operations.NewVecOp:writer.u8(24);break;case operations.NewStrOp:writer.u8(32);break;case operations.NewBinOp:writer.u8(40);break;case operations.NewArrOp:writer.u8(48);break;case operations.InsValOp:{const operation=op;writer.u8(72),this.encodeId(operation.obj),this.encodeId(operation.val);break}case operations.InsObjOp:{const operation=op,data=operation.data,length=data.length;length<=7?writer.u8(80+length):(writer.u8(80),writer.vu57(length)),this.encodeId(operation.obj);for(let i=0;i<length;i++){const tuple=data[i];this.writeStr(tuple[0]),this.encodeId(tuple[1])}break}case operations.InsVecOp:{const operation=op,data=operation.data,length=data.length;length<=7?writer.u8(88+length):(writer.u8(88),writer.vu57(length)),this.encodeId(operation.obj);for(let i=0;i<length;i++){const tuple=data[i];writer.u8(tuple[0]),this.encodeId(tuple[1])}break}case operations.InsStrOp:{const operation=op,obj=operation.obj,ref=operation.ref,str=operation.data,len1=str.length;writer.ensureCapacity(24+4*len1);const x=writer.x,len2=this.writeInsStr(len1,obj,ref,str);len1!==len2&&(writer.x=x,this.writeInsStr(len2,obj,ref,str));break}case operations.InsBinOp:{const operation=op,buf=operation.data,length=buf.length;length<=7?writer.u8(104+length):(writer.u8(104),writer.vu57(length)),this.encodeId(operation.obj),this.encodeId(operation.ref),writer.buf(buf,length);break}case operations.InsArrOp:{const operation=op,elements=operation.data,length=elements.length;length<=7?writer.u8(112+length):(writer.u8(112),writer.vu57(length)),this.encodeId(operation.obj),this.encodeId(operation.ref);for(let i=0;i<length;i++)this.encodeId(elements[i]);break}case operations.DelOp:{const operation=op,what=operation.what,length=what.length;length<=7?writer.u8(128+length):(writer.u8(128),writer.vu57(length)),this.encodeId(operation.obj);for(let i=0;i<length;i++)this.encodeTss(what[i]);break}case operations.NopOp:{const length=op.len;length<=7?writer.u8(136+length):(writer.u8(136),writer.vu57(length));break}default:throw new Error("UNKNOWN_OP")}}}exports.Encoder=Encoder},"./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/Encoder.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/Decoder.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/shared.js"),exports)},"./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/shared.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decode=exports.decoder=exports.encode=exports.encoder=void 0;const Encoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/Encoder.js"),Decoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/binary/Decoder.js"),writer=new(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtWriter.js").CrdtWriter)(4096);exports.encoder=new Encoder_1.Encoder(writer);exports.encode=patch=>exports.encoder.encode(patch),exports.decoder=new Decoder_1.Decoder;exports.decode=buf=>exports.decoder.decode(buf)},"./node_modules/json-joy/es2020/json-crdt-patch/codec/clock/ClockDecoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClockDecoder=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js");class ClockDecoder{static fromArr(arr){const decoder=new ClockDecoder(arr[0],arr[1]),length=arr.length;for(let i=2;i<length;i+=2)decoder.pushTuple(arr[i],arr[i+1]);return decoder}constructor(sid,time){this.table=[],this.clock=new clock_1.ClockVector(sid,time+1),this.table.push((0,clock_1.ts)(sid,time))}pushTuple(sid,time){const id=(0,clock_1.ts)(sid,time);this.clock.observe(id,1),this.table.push(id)}decodeId(sessionIndex,timeDiff){if(!sessionIndex)return(0,clock_1.ts)(0,timeDiff);const clock=this.table[sessionIndex-1];if(!clock)throw new Error("INVALID_CLOCK_TABLE");return(0,clock_1.ts)(clock.sid,clock.time-timeDiff)}}exports.ClockDecoder=ClockDecoder},"./node_modules/json-joy/es2020/json-crdt-patch/codec/clock/ClockEncoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClockEncoder=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),RelativeTimestamp_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/clock/RelativeTimestamp.js");class ClockTableEntry{constructor(index,clock){this.index=index,this.clock=clock}}exports.ClockEncoder=class ClockEncoder{constructor(){this.table=new Map,this.index=1,this.clock=null}reset(clock){this.index=1,this.clock=clock;const entry=new ClockTableEntry(this.index++,(0,clock_1.tick)(clock,-1));this.table.clear(),this.table.set(clock.sid,entry)}append(ts){const time=ts.time,sid=ts.sid;let entry=this.table.get(sid);if(!entry){let clock=this.clock.peers.get(sid);clock||(clock=new clock_1.Timestamp(sid,this.clock.time-1)),entry=new ClockTableEntry(this.index++,clock),this.table.set(sid,entry)}const timeDiff=entry.clock.time-time;if(timeDiff<0)throw new Error("TIME_TRAVEL");return new RelativeTimestamp_1.RelativeTimestamp(entry.index,timeDiff)}toJson(){const out=[];return this.table.forEach((entry=>{const clock=entry.clock;out.push(clock.sid,clock.time)})),out}}},"./node_modules/json-joy/es2020/json-crdt-patch/codec/clock/RelativeTimestamp.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RelativeTimestamp=void 0;exports.RelativeTimestamp=class RelativeTimestamp{constructor(sessionIndex,timeDiff){this.sessionIndex=sessionIndex,this.timeDiff=timeDiff}}},"./node_modules/json-joy/es2020/json-crdt-patch/constants.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ORIGIN=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js");exports.ORIGIN=(0,clock_1.ts)(0,0)},"./node_modules/json-joy/es2020/json-crdt-patch/operations.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NopOp=exports.DelOp=exports.InsArrOp=exports.InsBinOp=exports.InsStrOp=exports.InsVecOp=exports.InsObjOp=exports.InsValOp=exports.NewArrOp=exports.NewBinOp=exports.NewStrOp=exports.NewVecOp=exports.NewObjOp=exports.NewValOp=exports.NewConOp=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js");exports.NewConOp=class NewConOp{constructor(id,val){this.id=id,this.val=val}span(){return 1}name(){return"new_con"}toString(tab=""){const val=this.val,valFormatted=val instanceof clock_1.Timestamp?`{ ${(0,clock_1.toDisplayString)(val)} }`:val instanceof Uint8Array?val.length<13?`Uint8Array { ${(""+val).replaceAll(",",", ")} }`:`Uint8Array(${val.length})`:`{ ${JSON.stringify(val)} }`;return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)} ${valFormatted}`}};exports.NewValOp=class NewValOp{constructor(id){this.id=id}span(){return 1}name(){return"new_val"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}`}};exports.NewObjOp=class NewObjOp{constructor(id){this.id=id}span(){return 1}name(){return"new_obj"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}`}};exports.NewVecOp=class NewVecOp{constructor(id){this.id=id}span(){return 1}name(){return"new_vec"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}`}};exports.NewStrOp=class NewStrOp{constructor(id){this.id=id}span(){return 1}name(){return"new_str"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}`}};exports.NewBinOp=class NewBinOp{constructor(id){this.id=id}span(){return 1}name(){return"new_bin"}toString(tab=""){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}`}};exports.NewArrOp=class NewArrOp{constructor(id){this.id=id}span(){return 1}name(){return"new_arr"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}`}};exports.InsValOp=class InsValOp{constructor(id,obj,val){this.id=id,this.obj=obj,this.val=val}span(){return 1}name(){return"ins_val"}toString(tab=""){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.span()}, obj = ${(0,clock_1.toDisplayString)(this.obj)}, val = ${(0,clock_1.toDisplayString)(this.val)}`}};exports.InsObjOp=class InsObjOp{constructor(id,obj,data){this.id=id,this.obj=obj,this.data=data}span(){return 1}name(){return"ins_obj"}toString(tab=""){let out=`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.span()}, obj = ${(0,clock_1.toDisplayString)(this.obj)}`;for(let i=0;i<this.data.length;i++){out+=`\n${tab}  ${i===this.data.length-1?"└─":"├─"} ${JSON.stringify(this.data[i][0])}: ${(0,clock_1.toDisplayString)(this.data[i][1])}`}return out}};exports.InsVecOp=class InsVecOp{constructor(id,obj,data){this.id=id,this.obj=obj,this.data=data}span(){return 1}name(){return"ins_vec"}toString(tab=""){let out=`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.span()}, obj = ${(0,clock_1.toDisplayString)(this.obj)}`;for(let i=0;i<this.data.length;i++){out+=`\n${tab}  ${i===this.data.length-1?"└─":"├─"} ${JSON.stringify(this.data[i][0])}: ${(0,clock_1.toDisplayString)(this.data[i][1])}`}return out}};exports.InsStrOp=class InsStrOp{constructor(id,obj,ref,data){this.id=id,this.obj=obj,this.ref=ref,this.data=data}span(){return this.data.length}name(){return"ins_str"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.span()}, obj = ${(0,clock_1.toDisplayString)(this.obj)} { ${(0,clock_1.toDisplayString)(this.ref)} ← ${JSON.stringify(this.data)} }`}};exports.InsBinOp=class InsBinOp{constructor(id,obj,ref,data){this.id=id,this.obj=obj,this.ref=ref,this.data=data}span(){return this.data.length}name(){return"ins_bin"}toString(tab=""){const ref=(0,clock_1.toDisplayString)(this.ref);return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.span()}, obj = ${(0,clock_1.toDisplayString)(this.obj)} { ${ref} ← ${this.data} }`}};exports.InsArrOp=class InsArrOp{constructor(id,obj,ref,data){this.id=id,this.obj=obj,this.ref=ref,this.data=data}span(){return this.data.length}name(){return"ins_arr"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.span()}, obj = ${(0,clock_1.toDisplayString)(this.obj)} { ${(0,clock_1.toDisplayString)(this.ref)} ← ${this.data.map(clock_1.toDisplayString).join(", ")} }`}};exports.DelOp=class DelOp{constructor(id,obj,what){this.id=id,this.obj=obj,this.what=what}span(){return 1}name(){return"del"}toString(){const spans=this.what.map((span=>(0,clock_1.toDisplayString)(span)+"!"+span.span)).join(", ");return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}, obj = ${(0,clock_1.toDisplayString)(this.obj)} { ${spans} }`}};exports.NopOp=class NopOp{constructor(id,len){this.id=id,this.len=len}span(){return this.len}name(){return"nop"}toString(){return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)}!${this.len}`}}},"./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtReader.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CrdtReader=void 0;const Reader_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/Reader.js");class CrdtReader extends Reader_1.Reader{id(){const byte=this.u8();return byte<=127?[byte>>>4,15&byte]:(this.x--,[this.b1vu56()[1],this.vu57()])}idSkip(){this.u8()<=127||(this.x--,this.b1vu56(),this.vu57Skip())}vu57(){const o1=this.u8();if(o1<=127)return o1;const o2=this.u8();if(o2<=127)return o2<<7|127&o1;const o3=this.u8();if(o3<=127)return o3<<14|(127&o2)<<7|127&o1;const o4=this.u8();if(o4<=127)return o4<<21|(127&o3)<<14|(127&o2)<<7|127&o1;const o5=this.u8();if(o5<=127)return 268435456*o5+((127&o4)<<21|(127&o3)<<14|(127&o2)<<7|127&o1);const o6=this.u8();if(o6<=127)return 34359738368*o6+(268435456*(127&o5)+((127&o4)<<21|(127&o3)<<14|(127&o2)<<7|127&o1));const o7=this.u8();if(o7<=127)return 4398046511104*o7+(34359738368*(127&o6)+(268435456*(127&o5)+((127&o4)<<21|(127&o3)<<14|(127&o2)<<7|127&o1)));return 562949953421312*this.u8()+(4398046511104*(127&o7)+(34359738368*(127&o6)+(268435456*(127&o5)+((127&o4)<<21|(127&o3)<<14|(127&o2)<<7|127&o1))))}vu57Skip(){if(this.u8()<=127)return;if(this.u8()<=127)return;if(this.u8()<=127)return;if(this.u8()<=127)return;if(this.u8()<=127)return;if(this.u8()<=127)return;this.u8()<=127||this.x++}b1vu56(){const byte=this.u8(),flag=128&byte?1:0,o1=127&byte;if(o1<=63)return[flag,o1];const o2=this.u8();if(o2<=127)return[flag,o2<<6|63&o1];const o3=this.u8();if(o3<=127)return[flag,o3<<13|(127&o2)<<6|63&o1];const o4=this.u8();if(o4<=127)return[flag,o4<<20|(127&o3)<<13|(127&o2)<<6|63&o1];const o5=this.u8();if(o5<=127)return[flag,134217728*o5+((127&o4)<<20|(127&o3)<<13|(127&o2)<<6|63&o1)];const o6=this.u8();if(o6<=127)return[flag,17179869184*o6+(134217728*(127&o5)+((127&o4)<<20|(127&o3)<<13|(127&o2)<<6|63&o1))];const o7=this.u8();if(o7<=127)return[flag,2199023255552*o7+(17179869184*(127&o6)+(134217728*(127&o5)+((127&o4)<<20|(127&o3)<<13|(127&o2)<<6|63&o1)))];return[flag,281474976710656*this.u8()+(2199023255552*(127&o7)+(17179869184*(127&o6)+(134217728*(127&o5)+((127&o4)<<20|(127&o3)<<13|(127&o2)<<6|63&o1))))]}}exports.CrdtReader=CrdtReader},"./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtWriter.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CrdtWriter=void 0;const Writer_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/Writer.js");class CrdtWriter extends Writer_1.Writer{id(x,y){x<=7&&y<=15?this.u8(x<<4|y):(this.b1vu56(1,x),this.vu57(y))}vu57(num){if(num<=127)this.u8(num);else if(num<=16383){this.ensureCapacity(2);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=num>>>7}else if(num<=2097151){this.ensureCapacity(3);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=128|num>>>7&127,uint8[this.x++]=num>>>14}else if(num<=268435455){this.ensureCapacity(4);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=128|num>>>7&127,uint8[this.x++]=128|num>>>14&127,uint8[this.x++]=num>>>21}else{let lo32=0|num;lo32<0&&(lo32+=4294967296);const hi32=(num-lo32)/4294967296;if(num<=34359738367){this.ensureCapacity(5);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=128|num>>>7&127,uint8[this.x++]=128|num>>>14&127,uint8[this.x++]=128|num>>>21&127,uint8[this.x++]=hi32<<4|num>>>28}else if(num<=4398046511103){this.ensureCapacity(6);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=128|num>>>7&127,uint8[this.x++]=128|num>>>14&127,uint8[this.x++]=128|num>>>21&127,uint8[this.x++]=128|(7&hi32)<<4|num>>>28,uint8[this.x++]=hi32>>>3}else if(num<=562949953421311){this.ensureCapacity(7);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=128|num>>>7&127,uint8[this.x++]=128|num>>>14&127,uint8[this.x++]=128|num>>>21&127,uint8[this.x++]=128|(7&hi32)<<4|num>>>28,uint8[this.x++]=128|(1016&hi32)>>>3,uint8[this.x++]=hi32>>>10}else{this.ensureCapacity(8);const uint8=this.uint8;uint8[this.x++]=128|127&num,uint8[this.x++]=128|num>>>7&127,uint8[this.x++]=128|num>>>14&127,uint8[this.x++]=128|num>>>21&127,uint8[this.x++]=128|(7&hi32)<<4|num>>>28,uint8[this.x++]=128|(1016&hi32)>>>3,uint8[this.x++]=128|(130048&hi32)>>>10,uint8[this.x++]=hi32>>>17}}}b1vu56(flag,num){if(num<=63)this.u8(flag<<7|num);else{const firstByteMask=flag<<7|64;if(num<=8191){this.ensureCapacity(2);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=num>>>6}else if(num<=1048575){this.ensureCapacity(3);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=128|num>>>6&127,uint8[this.x++]=num>>>13}else if(num<=134217727){this.ensureCapacity(4);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=128|num>>>6&127,uint8[this.x++]=128|num>>>13&127,uint8[this.x++]=num>>>20}else{let lo32=0|num;lo32<0&&(lo32+=4294967296);const hi32=(num-lo32)/4294967296;if(num<=17179869183){this.ensureCapacity(5);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=128|num>>>6&127,uint8[this.x++]=128|num>>>13&127,uint8[this.x++]=128|num>>>20&127,uint8[this.x++]=hi32<<5|num>>>27}else if(num<=2199023255551){this.ensureCapacity(6);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=128|num>>>6&127,uint8[this.x++]=128|num>>>13&127,uint8[this.x++]=128|num>>>20&127,uint8[this.x++]=128|(3&hi32)<<5|num>>>27,uint8[this.x++]=hi32>>>2}else if(num<=0xffffffffffff){this.ensureCapacity(7);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=128|num>>>6&127,uint8[this.x++]=128|num>>>13&127,uint8[this.x++]=128|num>>>20&127,uint8[this.x++]=128|(3&hi32)<<5|num>>>27,uint8[this.x++]=128|(508&hi32)>>>2,uint8[this.x++]=hi32>>>9}else{this.ensureCapacity(8);const uint8=this.uint8;uint8[this.x++]=firstByteMask|63&num,uint8[this.x++]=128|num>>>6&127,uint8[this.x++]=128|num>>>13&127,uint8[this.x++]=128|num>>>20&127,uint8[this.x++]=128|(3&hi32)<<5|num>>>27,uint8[this.x++]=128|(508&hi32)>>>2,uint8[this.x++]=128|(65024&hi32)>>>9,uint8[this.x++]=hi32>>>16}}}}}exports.CrdtWriter=CrdtWriter},"./node_modules/json-joy/es2020/json-crdt/codec/structural/binary/Decoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Decoder=void 0;const nodes=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js")),ClockDecoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/clock/ClockDecoder.js"),CrdtReader_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtReader.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),Model_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/Model.js"),CborDecoderBase_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/cbor/CborDecoderBase.js");class Decoder extends CborDecoderBase_1.CborDecoderBase{constructor(){super(new CrdtReader_1.CrdtReader),this.time=-1,this.cStrChunk=()=>{const id=this.ts(),val=this.val();return"string"==typeof val?new nodes.StrChunk(id,val.length,val):new nodes.StrChunk(id,~~val,"")},this.cBinChunk=()=>{const id=this.ts(),reader=this.reader,[deleted,length]=reader.b1vu56();return deleted?new nodes.BinChunk(id,length,void 0):new nodes.BinChunk(id,length,reader.buf(length))},this.cArrChunk=()=>{const id=this.ts(),[deleted,length]=this.reader.b1vu56();if(deleted)return new nodes.ArrChunk(id,length,void 0);const ids=[];for(let i=0;i<length;i++)ids.push(this.cNode().id);return new nodes.ArrChunk(id,length,ids)}}decode(data,model){delete this.clockDecoder,this.time=-1;const reader=this.reader;reader.reset(data);if(128&reader.peak()){reader.x++;const time=this.time=reader.vu57();model||(model=Model_1.Model.withServerClock(time))}else if(this.decodeClockTable(),!model){const clock=this.clockDecoder.clock;model=Model_1.Model.withLogicalClock(clock)}return this.doc=model,model.root=new nodes.RootNode(this.doc,this.cRoot().id),delete this.clockDecoder,model}decodeClockTable(){const reader=this.reader,clockTableOffset=reader.u32(),offset=reader.x;reader.x+=clockTableOffset;const length=reader.vu57(),sessionId=reader.vu57(),time=reader.vu57();this.clockDecoder=new ClockDecoder_1.ClockDecoder(sessionId,time);for(let i=1;i<length;i++){const sid=reader.vu57(),time=reader.vu57();this.clockDecoder.pushTuple(sid,time)}reader.x=offset}ts(){if(this.time<0){const[sessionIndex,timeDiff]=this.reader.id();return this.clockDecoder.decodeId(sessionIndex,timeDiff)}return new clock_1.Timestamp(1,this.reader.vu57())}cRoot(){const reader=this.reader;return reader.uint8[reader.x]?this.cNode():Model_1.UNDEFINED}cNode(){const reader=this.reader,id=this.ts(),octet=reader.u8(),minor=31&octet;switch(octet>>5){case 0:return this.cCon(id,minor);case 1:return this.cVal(id);case 2:return this.cObj(id,31!==minor?minor:reader.vu57());case 3:return this.cVec(id,31!==minor?minor:reader.vu57());case 4:return this.cStr(id,31!==minor?minor:reader.vu57());case 5:return this.cBin(id,31!==minor?minor:reader.vu57());case 6:return this.cArr(id,31!==minor?minor:reader.vu57())}throw new Error("UNKNOWN_NODE")}cCon(id,length){const doc=this.doc,data=length?this.ts():this.val(),node=new nodes.ConNode(id,data);return doc.index.set(id,node),node}cVal(id){const child=this.cNode(),doc=this.doc,node=new nodes.ValNode(doc,id,child.id);return doc.index.set(id,node),node}cObj(id,length){const obj=new nodes.ObjNode(this.doc,id);for(let i=0;i<length;i++)this.cObjChunk(obj);return this.doc.index.set(id,obj),obj}cObjChunk(obj){const key=this.key();obj.keys.set(key,this.cNode().id)}cVec(id,length){const reader=this.reader,obj=new nodes.VecNode(this.doc,id),elements=obj.elements;for(let i=0;i<length;i++){reader.peak()?elements.push(this.cNode().id):(reader.x++,elements.push(void 0))}return this.doc.index.set(id,obj),obj}cStr(id,length){const node=new nodes.StrNode(id);return length&&node.ingest(length,this.cStrChunk),this.doc.index.set(id,node),node}cBin(id,length){const node=new nodes.BinNode(id);return length&&node.ingest(length,this.cBinChunk),this.doc.index.set(id,node),node}cArr(id,length){const obj=new nodes.ArrNode(this.doc,id);return length&&obj.ingest(length,this.cArrChunk),this.doc.index.set(id,obj),obj}}exports.Decoder=Decoder},"./node_modules/json-joy/es2020/json-crdt/codec/structural/binary/Encoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Encoder=void 0;const nodes=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js")),ClockEncoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/codec/clock/ClockEncoder.js"),CrdtWriter_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/util/binary/CrdtWriter.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),CborEncoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/cbor/CborEncoder.js");class Encoder extends CborEncoder_1.CborEncoder{constructor(writer){super(writer||new CrdtWriter_1.CrdtWriter),this.clockEncoder=new ClockEncoder_1.ClockEncoder,this.time=0,this.cTableEntry=entry=>{const clock=entry.clock,writer=this.writer;writer.vu57(clock.sid),writer.vu57(clock.time)},this.tsLogical=ts=>{const relativeId=this.clockEncoder.append(ts);this.writer.id(relativeId.sessionIndex,relativeId.timeDiff)},this.tsServer=ts=>{this.writer.vu57(ts.time)},this.ts=this.tsLogical,this.cKey=(val,key)=>{this.writeStr(key),this.cNode(this.doc.index.get(val))}}encode(doc){this.doc=doc;const writer=this.writer;return writer.reset(),1===doc.clock.sid?this.encodeServer(doc):this.encodeLogical(doc),writer.flush()}encodeLogical(model){const writer=this.writer;this.ts=this.tsLogical,this.clockEncoder.reset(model.clock),writer.ensureCapacity(4);const x0=writer.x0,x=writer.x;writer.x+=4,this.cRoot(model.root),this.encodeClockTable(x0,x)}encodeServer(model){this.ts=this.tsServer;const writer=this.writer;writer.u8(128),writer.vu57(this.time=model.clock.time),this.cRoot(model.root)}encodeClockTable(x0,x){const writer=this.writer,shift=writer.x0-x0;writer.view.setUint32(writer.x0+(x-x0),writer.x-x-shift-4);const table=this.clockEncoder.table,length=table.size;writer.vu57(length),table.forEach(this.cTableEntry)}cRoot(root){0===root.val.sid?this.writer.u8(0):this.cNode(root.node())}writeTL(majorOverlay,length){const writer=this.writer;length<31?writer.u8(majorOverlay|length):(writer.u8(31|majorOverlay),writer.vu57(length))}cNode(node){node instanceof nodes.ConNode?this.cCon(node):node instanceof nodes.ValNode?this.cVal(node):node instanceof nodes.StrNode?this.cStr(node):node instanceof nodes.ObjNode?this.cObj(node):node instanceof nodes.VecNode?this.cVec(node):node instanceof nodes.ArrNode?this.cArr(node):node instanceof nodes.BinNode&&this.cBin(node)}cCon(node){const val=node.val;this.ts(node.id),val instanceof clock_1.Timestamp?(this.writer.u8(1),this.ts(val)):(this.writer.u8(0),this.writeAny(val))}cVal(node){this.ts(node.id),this.writer.u8(32),this.cNode(node.node())}cObj(node){this.ts(node.id);const keys=node.keys;this.writeTL(64,keys.size),keys.forEach(this.cKey)}cVec(node){const elements=node.elements,length=elements.length;this.ts(node.id),this.writeTL(96,length);const index=this.doc.index;for(let i=0;i<length;i++){const elementId=elements[i];elementId?this.cNode(index.get(elementId)):this.writer.u8(0)}}cStr(node){const ts=this.ts;ts(node.id),this.writeTL(128,node.count);for(let chunk=node.first();chunk;chunk=node.next(chunk))ts(chunk.id),chunk.del?this.writeUInteger(chunk.span):this.writeStr(chunk.data)}cBin(node){const ts=this.ts,writer=this.writer;ts(node.id),this.writeTL(160,node.count);for(let chunk=node.first();chunk;chunk=node.next(chunk)){ts(chunk.id);const length=chunk.span,deleted=chunk.del;writer.b1vu56(~~deleted,length),deleted||writer.buf(chunk.data,length)}}cArr(node){const ts=this.ts,writer=this.writer;ts(node.id),this.writeTL(192,node.count);const index=this.doc.index;for(let chunk=node.first();chunk;chunk=node.next(chunk)){ts(chunk.id);const span=chunk.span,deleted=chunk.del;if(writer.b1vu56(~~deleted,span),deleted)continue;const nodes=chunk.data;for(let i=0;i<span;i++)this.cNode(index.get(nodes[i]))}}}exports.Encoder=Encoder},"./node_modules/json-joy/es2020/json-crdt/codec/structural/binary/shared.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decoder=exports.encoder=void 0;const Encoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/codec/structural/binary/Encoder.js"),Decoder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/codec/structural/binary/Decoder.js");exports.encoder=new Encoder_1.Encoder,exports.decoder=new Decoder_1.Decoder},"./node_modules/json-joy/es2020/json-crdt/extensions/Extensions.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extensions=void 0;const printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js");class Extensions{constructor(){this.ext={}}register(extension){this.ext[extension.id]=extension}get(id){return this.ext[id]}size(){return Object.keys(this.ext).length}clone(){const clone=new Extensions;for(const ext of Object.values(this.ext))clone.register(ext);return clone}toString(tab=""){const keys=Object.keys(this.ext).map((k=>+k)).sort();return this.constructor.name+(0,printTree_1.printTree)(tab,keys.map((k=>tab=>`${k}: ${this.ext[k].Node.name}`)))}}exports.Extensions=Extensions},"./node_modules/json-joy/es2020/json-crdt/extensions/types.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},"./node_modules/json-joy/es2020/json-crdt/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/extensions/types.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/index.js"),exports)},"./node_modules/json-joy/es2020/json-crdt/model/Model.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Model=exports.UNDEFINED=void 0;const operations=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/operations.js")),ConNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/con/ConNode.js"),shared_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/codec/structural/binary/shared.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),ModelApi_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/ModelApi.js"),constants_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/constants.js"),util_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/util.js"),nodes_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js"),Extensions_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/extensions/Extensions.js"),AvlMap_1=__webpack_require__("./node_modules/json-joy/es2020/util/trees/avl/AvlMap.js");exports.UNDEFINED=new ConNode_1.ConNode(constants_1.ORIGIN,void 0);class Model{static withLogicalClock(clockOrSessionId){const clock="number"==typeof clockOrSessionId?new clock_1.ClockVector(clockOrSessionId,1):clockOrSessionId||new clock_1.ClockVector((0,util_1.randomSessionId)(),1);return new Model(clock)}static withServerClock(time=0){const clock=new clock_1.ServerClockVector(1,time);return new Model(clock)}static fromBinary(data){return shared_1.decoder.decode(data)}constructor(clock){this.root=new nodes_1.RootNode(this,constants_1.ORIGIN),this.index=new AvlMap_1.AvlMap(clock_1.compare),this.ext=new Extensions_1.Extensions,this.tick=0,this.onchange=void 0,this.clock=clock,clock.time||(clock.time=1)}get api(){return this._api||(this._api=new ModelApi_1.ModelApi(this)),this._api}get find(){return this.api.r.proxy()}applyBatch(patches){const length=patches.length;for(let i=0;i<length;i++)this.applyPatch(patches[i])}applyPatch(patch){const ops=patch.ops,{length}=ops;for(let i=0;i<length;i++)this.applyOperation(ops[i]);this.tick++,this.onchange?.(0)}applyOperation(op){this.clock.observe(op.id,op.span());const index=this.index;if(op instanceof operations.InsStrOp){const node=index.get(op.obj);node instanceof nodes_1.StrNode&&node.ins(op.ref,op.id,op.data)}else if(op instanceof operations.NewObjOp){const id=op.id;index.get(id)||index.set(id,new nodes_1.ObjNode(this,id))}else if(op instanceof operations.NewArrOp){const id=op.id;index.get(id)||index.set(id,new nodes_1.ArrNode(this,id))}else if(op instanceof operations.NewStrOp){const id=op.id;index.get(id)||index.set(id,new nodes_1.StrNode(id))}else if(op instanceof operations.NewValOp){const id=op.id;index.get(id)||index.set(id,new nodes_1.ValNode(this,id,constants_1.ORIGIN))}else if(op instanceof operations.NewConOp){const id=op.id;index.get(id)||index.set(id,new ConNode_1.ConNode(id,op.val))}else if(op instanceof operations.InsObjOp){const node=index.get(op.obj),tuples=op.data,length=tuples.length;if(node instanceof nodes_1.ObjNode)for(let i=0;i<length;i++){const tuple=tuples[i],valueNode=index.get(tuple[1]);if(!valueNode)continue;if(node.id.time>=tuple[1].time)continue;const old=node.put(tuple[0]+"",valueNode.id);old&&this.deleteNodeTree(old)}}else if(op instanceof operations.InsVecOp){const node=index.get(op.obj),tuples=op.data,length=tuples.length;if(node instanceof nodes_1.VecNode)for(let i=0;i<length;i++){const tuple=tuples[i],valueNode=index.get(tuple[1]);if(!valueNode)continue;if(node.id.time>=tuple[1].time)continue;const old=node.put(Number(tuple[0]),valueNode.id);old&&this.deleteNodeTree(old)}}else if(op instanceof operations.InsValOp){const obj=op.obj,node=0===obj.sid&&0===obj.time?this.root:index.get(obj);if(node instanceof nodes_1.ValNode){if(index.get(op.val)){const old=node.set(op.val);old&&this.deleteNodeTree(old)}}}else if(op instanceof operations.InsArrOp){const node=index.get(op.obj);if(node instanceof nodes_1.ArrNode){const nodes=[],data=op.data,length=data.length;for(let i=0;i<length;i++){const stamp=data[i];index.get(stamp)&&(node.id.time>=stamp.time||nodes.push(stamp))}nodes.length&&node.ins(op.ref,op.id,nodes)}}else if(op instanceof operations.DelOp){const node=index.get(op.obj);if(node instanceof nodes_1.ArrNode){const length=op.what.length;for(let i=0;i<length;i++){const span=op.what[i];for(let j=0;j<span.span;j++){const id=node.getById(new clock_1.Timestamp(span.sid,span.time+j));id&&this.deleteNodeTree(id)}}node.delete(op.what)}else(node instanceof nodes_1.StrNode||node instanceof nodes_1.BinNode)&&node.delete(op.what)}else if(op instanceof operations.NewBinOp){const id=op.id;index.get(id)||index.set(id,new nodes_1.BinNode(id))}else if(op instanceof operations.InsBinOp){const node=index.get(op.obj);node instanceof nodes_1.BinNode&&node.ins(op.ref,op.id,op.data)}else if(op instanceof operations.NewVecOp){const id=op.id;index.get(id)||index.set(id,new nodes_1.VecNode(this,id))}}deleteNodeTree(value){if(0===value.sid)return;const node=this.index.get(value);if(!node)return;const api=node.api;api&&api.events.onDelete(),node.children((child=>this.deleteNodeTree(child.id))),this.index.del(value)}fork(sessionId=(0,util_1.randomSessionId)()){const copy=Model.fromBinary(this.toBinary());return copy.clock.sid!==sessionId&&copy.clock instanceof clock_1.ClockVector&&(copy.clock=copy.clock.fork(sessionId)),copy.ext=this.ext,copy}clone(){return this.fork(this.clock.sid)}reset(to){this.index=new AvlMap_1.AvlMap(clock_1.compare);const blob=to.toBinary();shared_1.decoder.decode(blob,this),this.clock=to.clock.clone(),this.ext=to.ext.clone();const api=this._api;api&&api.flush(),this.onchange?.(2)}view(){return this.root.view()}toBinary(){return shared_1.encoder.encode(this)}setSchema(schema){return this.clock.time<2&&this.api.root(schema),this}toString(tab=""){const nl=()=>"",hasExtensions=this.ext.size()>0;return"model"+(0,printTree_1.printTree)(tab,[tab=>this.root.toString(tab),nl,tab=>{const nodes=[];return this.index.forEach((item=>nodes.push(item.v))),`index (${nodes.length} nodes)`+(nodes.length?(0,printTree_1.printTree)(tab,nodes.map((node=>tab=>`${node.name()} ${(0,clock_1.toDisplayString)(node.id)}`))):"")},nl,tab=>`view${(0,printTree_1.printTree)(tab,[tab=>String(JSON.stringify(this.view(),null,2)).replace(/\n/g,"\n"+tab)])}`,nl,tab=>this.clock.toString(tab),hasExtensions?nl:null,hasExtensions?tab=>this.ext.toString(tab):null])}}exports.Model=Model},"./node_modules/json-joy/es2020/json-crdt/model/api/ModelApi.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModelApi=void 0;const fanout_1=__webpack_require__("./node_modules/json-joy/node_modules/thingies/es2020/fanout.js"),nodes_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js"),nodes_2=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/nodes.js"),Emitter_1=__webpack_require__("./node_modules/json-joy/es2020/util/events/Emitter.js"),PatchBuilder_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/PatchBuilder.js");exports.ModelApi=class ModelApi{constructor(model){this.model=model,this.next=0,this.changes=new fanout_1.FanOut,this.queuedChanges=void 0,this.queueChange=changeType=>{this.changes.emit(changeType);let changesQueued=this.queuedChanges;changesQueued?changesQueued.add(changeType):(changesQueued=this.queuedChanges=new Set,changesQueued.add(changeType),queueMicrotask((()=>{let changes=this.queuedChanges||new Set;this.queuedChanges=void 0;const et=this.et;changes.has(2)&&(changes=new Set([2])),et&&et.emit(new CustomEvent("change",{detail:changes}))})))},this.et=new Emitter_1.Emitter,this.subscribe=callback=>{const listener=()=>callback();return this.events.on("change",listener),()=>this.events.off("change",listener)},this.getSnapshot=()=>this.view(),this.builder=new PatchBuilder_1.PatchBuilder(this.model.clock),this.model.onchange=this.queueChange}get events(){return this.et}wrap(node){if(node instanceof nodes_1.ValNode)return node.api||(node.api=new nodes_2.ValApi(node,this));if(node instanceof nodes_1.StrNode)return node.api||(node.api=new nodes_2.StrApi(node,this));if(node instanceof nodes_1.BinNode)return node.api||(node.api=new nodes_2.BinApi(node,this));if(node instanceof nodes_1.ArrNode)return node.api||(node.api=new nodes_2.ArrApi(node,this));if(node instanceof nodes_1.ObjNode)return node.api||(node.api=new nodes_2.ObjApi(node,this));if(node instanceof nodes_1.ConNode)return node.api||(node.api=new nodes_2.ConApi(node,this));if(node instanceof nodes_1.VecNode)return node.api||(node.api=new nodes_2.VecApi(node,this));throw new Error("UNKNOWN_NODE")}get r(){return new nodes_2.ValApi(this.model.root,this)}get node(){return this.r.get()}in(path){return this.r.in(path)}find(path){return this.node.find(path)}val(path){return this.node.val(path)}vec(path){return this.node.tup(path)}str(path){return this.node.str(path)}bin(path){return this.node.bin(path)}arr(path){return this.node.arr(path)}obj(path){return this.node.obj(path)}const(path){return this.node.const(path)}root(json){const builder=this.builder;return builder.root(builder.json(json)),this.apply(),this}apply(){const ops=this.builder.patch.ops,length=ops.length,model=this.model;for(let i=this.next;i<length;i++)model.applyOperation(ops[i]);this.next=length,model.tick++,model.onchange?.(1)}advance(){this.next=this.builder.patch.ops.length;const model=this.model;model.tick++,model.onchange?.(1)}view(){return this.model.view()}flush(){const patch=this.builder.flush();this.next=0;const event=new CustomEvent("flush",{detail:patch});return this.events.emit(event),patch}}},"./node_modules/json-joy/es2020/json-crdt/model/api/events/NodeEvents.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NodeEvents=void 0;const fanout_1=__webpack_require__("./node_modules/json-joy/node_modules/thingies/es2020/fanout.js"),Emitter_1=__webpack_require__("./node_modules/json-joy/es2020/util/events/Emitter.js");class ChangesFanOut extends fanout_1.FanOut{constructor(api){super(),this.api=api,this._v=void 0,this._u=void 0}listen(listener){if(!this.listeners.size){const api=this.api;this._v=api.view(),this._u=api.api.changes.listen((()=>{const view=api.view();view!==this._v&&(this._v=view,this.emit(view))}))}const unsubscribe=super.listen(listener);return()=>{unsubscribe(),this.listeners.size||(this._u?.(),this._u=this._v=void 0)}}dispose(){this.listeners.clear(),this._u?.(),this._u=this._v=void 0}}class NodeEvents extends Emitter_1.Emitter{constructor(api){super(),this.api=api,this.viewSubs=new Set,this._view=void 0,this.onModelChange=()=>{const _view=this._view,view=this.api.node.view(),viewHasChanged=_view!==view;this._view=view,viewHasChanged&&this.emit(new CustomEvent("view"))},this.subscribe=callback=>this.changes.listen((()=>callback())),this.getSnapshot=()=>this.api.view(),this.changes=new ChangesFanOut(api)}setupViewEvents(){this._view=this.api.node.view(),this.api.api.events.on("change",this.onModelChange)}on(type,listener,options){"view"===type&&this.viewSubs.add(listener);1===this.viewSubs.size&&this.setupViewEvents(),super.on(type,listener,options)}off(type,listener,options){"view"===type&&this.viewSubs.delete(listener);1===this.viewSubs.size&&this.api.api.events.off("change",this.onModelChange),super.off(type,listener,options)}onDelete(){this.changes.dispose()}}exports.NodeEvents=NodeEvents},"./node_modules/json-joy/es2020/json-crdt/model/api/find.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.find=void 0;const json_pointer_1=__webpack_require__("./node_modules/json-joy/es2020/json-pointer/index.js"),nodes_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js");exports.find=(startNode,path)=>{const steps=(0,json_pointer_1.toPath)(path);let node=startNode;const length=steps.length;if(!length)return node;let i=0;for(;i<length&&node;){const step=steps[i++];if(node=node.container(),!node)throw new Error("NOT_CONTAINER");if(node instanceof nodes_1.ObjNode){const nextNode=node.get(String(step));if(!nextNode)throw new Error("NOT_FOUND");node=nextNode}else if(node instanceof nodes_1.ArrNode){const nextNode=node.getNode(Number(step));if(!nextNode)throw new Error("NOT_FOUND");node=nextNode}else if(node instanceof nodes_1.VecNode){const nextNode=node.get(Number(step));if(!nextNode)throw new Error("NOT_FOUND");node=nextNode}}return node}},"./node_modules/json-joy/es2020/json-crdt/model/api/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModelApi=void 0;const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var ModelApi_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/ModelApi.js");Object.defineProperty(exports,"ModelApi",{enumerable:!0,get:function(){return ModelApi_1.ModelApi}}),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/nodes.js"),exports)},"./node_modules/json-joy/es2020/json-crdt/model/api/nodes.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrApi=exports.BinApi=exports.StrApi=exports.ObjApi=exports.VecApi=exports.ValApi=exports.ConApi=exports.NodeApi=void 0;const find_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/find.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),nodes_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/index.js"),NodeEvents_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/events/NodeEvents.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js");class NodeApi{constructor(node,api){this.node=node,this.api=api,this.ev=void 0}get events(){return this.ev||(this.ev=new NodeEvents_1.NodeEvents(this))}find(path){const node=this.node;if(void 0===path){if("function"==typeof node.child){const child=node.child();if(!child)throw new Error("NO_CHILD");return child}throw new Error("CANNOT_IN")}return"string"==typeof path&&path&&"/"!==path[0]&&(path="/"+path),"number"==typeof path&&(path=[path]),(0,find_1.find)(this.node,path)}in(path){const node=this.find(path);return this.api.wrap(node)}asVal(){if(this.node instanceof nodes_1.ValNode)return this.api.wrap(this.node);throw new Error("NOT_VAL")}asStr(){if(this.node instanceof nodes_1.StrNode)return this.api.wrap(this.node);throw new Error("NOT_STR")}asBin(){if(this.node instanceof nodes_1.BinNode)return this.api.wrap(this.node);throw new Error("NOT_BIN")}asArr(){if(this.node instanceof nodes_1.ArrNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asTup(){if(this.node instanceof nodes_1.VecNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asObj(){if(this.node instanceof nodes_1.ObjNode)return this.api.wrap(this.node);throw new Error("NOT_OBJ")}asCon(){if(this.node instanceof nodes_1.ConNode)return this.api.wrap(this.node);throw new Error("NOT_CONST")}asExt(ext){let node=this.node;for(;node;){if(node instanceof ext.Node)return new ext.Api(node,this.api);node=node.child?node.child():void 0}throw new Error("NOT_EXT")}val(path){return this.in(path).asVal()}str(path){return this.in(path).asStr()}bin(path){return this.in(path).asBin()}arr(path){return this.in(path).asArr()}tup(path){return this.in(path).asTup()}obj(path){return this.in(path).asObj()}const(path){return this.in(path).asCon()}view(){return this.node.view()}toString(tab=""){return this.constructor.name+(0,printTree_1.printTree)(tab,[tab=>this.node.toString(tab)])}}exports.NodeApi=NodeApi;exports.ConApi=class ConApi extends NodeApi{proxy(){return{toApi:()=>this}}};exports.ValApi=class ValApi extends NodeApi{get(){return this.in()}set(json){const{api,node}=this,val=api.builder.constOrJson(json);return api.builder.setVal(node.id,val),api.apply(),this}proxy(){const self=this;return{toApi:()=>this,get val(){const childNode=self.node.node();return self.api.wrap(childNode).proxy()}}}};exports.VecApi=class VecApi extends NodeApi{get(key){return this.in(key)}set(entries){const{api,node}=this,{builder}=api;return builder.insVec(node.id,entries.map((([index,json])=>[index,builder.constOrJson(json)]))),api.apply(),this}proxy(){return new Proxy({},{get:(target,prop,receiver)=>{if("toApi"===prop)return()=>this;const index=Number(prop);if(Number.isNaN(index))throw new Error("INVALID_INDEX");const child=this.node.get(index);if(!child)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(child).proxy()}})}};exports.ObjApi=class ObjApi extends NodeApi{get(key){return this.in(key)}set(entries){const{api,node}=this,{builder}=api;return builder.insObj(node.id,Object.entries(entries).map((([key,json])=>[key,builder.constOrJson(json)]))),api.apply(),this}del(keys){const{api,node}=this,{builder}=api;return api.builder.insObj(node.id,keys.map((key=>[key,builder.const(void 0)]))),api.apply(),this}proxy(){const self=this;return new Proxy({},{get:(target,prop,receiver)=>{if("toApi"===prop)return()=>self;const key=String(prop),child=this.node.get(key);if(!child)throw new Error("NO_SUCH_KEY");return this.api.wrap(child).proxy()}})}};exports.StrApi=class StrApi extends NodeApi{ins(index,text){const{api,node}=this,builder=api.builder;builder.pad();const nextTime=api.builder.nextTime(),id=new clock_1.Timestamp(builder.clock.sid,nextTime),after=node.insAt(index,id,text);if(!after)throw new Error("OUT_OF_BOUNDS");return builder.insStr(node.id,after,text),api.advance(),this}del(index,length){const{api,node}=this,builder=api.builder;builder.pad();const spans=node.findInterval(index,length);if(!spans)throw new Error("OUT_OF_BOUNDS");return node.delete(spans),builder.del(node.id,spans),api.advance(),this}proxy(){return{toApi:()=>this}}};exports.BinApi=class BinApi extends NodeApi{ins(index,data){const{api,node}=this,after=index?node.find(index-1):node.id;if(!after)throw new Error("OUT_OF_BOUNDS");return api.builder.insBin(node.id,after,data),api.apply(),this}del(index,length){const{api,node}=this,spans=node.findInterval(index,length);if(!spans)throw new Error("OUT_OF_BOUNDS");return api.builder.del(node.id,spans),api.apply(),this}proxy(){return{toApi:()=>this}}};exports.ArrApi=class ArrApi extends NodeApi{get(index){return this.in(index)}ins(index,values){const{api,node}=this,{builder}=api,after=index?node.find(index-1):node.id;if(!after)throw new Error("OUT_OF_BOUNDS");const valueIds=[];for(let i=0;i<values.length;i++)valueIds.push(builder.json(values[i]));return builder.insArr(node.id,after,valueIds),api.apply(),this}del(index,length){const{api,node}=this,spans=node.findInterval(index,length);if(!spans)throw new Error("OUT_OF_BOUNDS");return api.builder.del(node.id,spans),api.apply(),this}length(){return this.node.length()}proxy(){return new Proxy({},{get:(target,prop,receiver)=>{if("toApi"===prop)return()=>this;const index=Number(prop);if(Number.isNaN(index))throw new Error("INVALID_INDEX");const child=this.node.getNode(index);if(!child)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(child).proxy()}})}}},"./node_modules/json-joy/es2020/json-crdt/model/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Model=void 0;const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var Model_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/Model.js");Object.defineProperty(exports,"Model",{enumerable:!0,get:function(){return Model_1.Model}}),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/api/index.js"),exports)},"./node_modules/json-joy/es2020/json-crdt/model/util.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.randomSessionId=void 0;exports.randomSessionId=()=>Math.floor(9007199254675456*Math.random()+65535)},"./node_modules/json-joy/es2020/json-crdt/nodes/arr/ArrNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrNode=exports.ArrChunk=void 0;const AbstractRga_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/rga/AbstractRga.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),printBinary_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printBinary.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js"),Empty=[];class ArrChunk{constructor(id,span,data){this.id=id,this.span=span,this.len=data?span:0,this.del=!data,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=data}merge(data){this.data.push(...data),this.span=this.data.length}split(ticks){const span=this.span;if(this.span=ticks,!this.del){const rightData=this.data.splice(ticks);return new ArrChunk((0,clock_1.tick)(this.id,ticks),span-ticks,rightData)}return new ArrChunk((0,clock_1.tick)(this.id,ticks),span-ticks,void 0)}delete(){this.del=!0,this.data=void 0}clone(){return new ArrChunk(this.id,this.span,this.data?[...this.data]:void 0)}}exports.ArrChunk=ArrChunk;class ArrNode extends AbstractRga_1.AbstractRga{constructor(doc,id){super(id),this.doc=doc,this._tick=0,this._view=Empty,this.api=void 0}get(position){const pair=this.findChunk(position);if(pair)return pair[0].data[pair[1]]}getNode(position){const id=this.get(position);if(id)return this.doc.index.get(id)}getById(id){const chunk=this.findById(id);if(!chunk||chunk.del)return;const offset=id.time-chunk.id.time;return chunk.data[offset]}createChunk(id,data){return new ArrChunk(id,data?data.length:0,data)}onChange(){this._view=Empty}toStringName(){return this.name()}child(){}container(){return this}view(){const doc=this.doc,tick=doc.clock.time+doc.tick,_view=this._view;if(this._tick===tick)return _view;const view=[],index=doc.index;let useCache=!0;for(let chunk=this.first();chunk;chunk=this.next(chunk))if(!chunk.del)for(const node of chunk.data){const elementNode=index.get(node);if(!elementNode){useCache=!1;continue}const element=elementNode.view();_view[view.length]!==element&&(useCache=!1),view.push(element)}return _view.length!==view.length&&(useCache=!1),useCache?_view:(this._tick=tick,this._view=view)}children(callback){const index=this.doc.index;for(let chunk=this.first();chunk;chunk=this.next(chunk))if(!chunk.del)for(const node of chunk.data)callback(index.get(node))}name(){return"arr"}printChunk(tab,chunk){const pos=this.pos(chunk);let valueTree="";if(!chunk.del){const index=this.doc.index;valueTree=(0,printTree_1.printTree)(tab,chunk.data.map((id=>index.get(id))).filter((node=>!!node)).map(((node,i)=>tab=>`[${pos+i}]: ${node.toString(tab+"    "+" ".repeat(String(i).length))}`)))}return this.formatChunk(chunk)+valueTree+(0,printBinary_1.printBinary)(tab,[chunk.l?tab=>this.printChunk(tab,chunk.l):null,chunk.r?tab=>this.printChunk(tab,chunk.r):null])}}exports.ArrNode=ArrNode},"./node_modules/json-joy/es2020/json-crdt/nodes/bin/BinNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BinNode=exports.BinChunk=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),AbstractRga_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/rga/AbstractRga.js");class BinChunk{constructor(id,span,buf){this.id=id,this.span=span,this.len=buf?span:0,this.del=!buf,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=buf}merge(data){const length=this.data.length,combined=new Uint8Array(length+data.length);combined.set(this.data),combined.set(data,length),this.data=combined,this.span=combined.length}split(ticks){if(!this.del){const data=this.data,rightBuffer=data.subarray(ticks),chunk=new BinChunk((0,clock_1.tick)(this.id,ticks),this.span-ticks,rightBuffer);return this.data=data.subarray(0,ticks),this.span=ticks,chunk}const chunk=new BinChunk((0,clock_1.tick)(this.id,ticks),this.span-ticks,void 0);return this.span=ticks,chunk}delete(){this.del=!0,this.data=void 0}clone(){return new BinChunk(this.id,this.span,this.data)}}exports.BinChunk=BinChunk;class BinNode extends AbstractRga_1.AbstractRga{constructor(){super(...arguments),this._view=null,this.api=void 0}view(){if(this._view)return this._view;const res=new Uint8Array(this.length());let offset=0,chunk=this.first();for(;chunk;){if(!chunk.del){const buf=chunk.data;res.set(buf,offset),offset+=buf.length}chunk=this.next(chunk)}return this._view=res}children(){}child(){}container(){}name(){return"bin"}createChunk(id,buf){return new BinChunk(id,buf?buf.length:0,buf)}onChange(){this._view=null}toStringName(){return this.name()}}exports.BinNode=BinNode},"./node_modules/json-joy/es2020/json-crdt/nodes/con/ConNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConNode=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js");exports.ConNode=class ConNode{constructor(id,val){this.id=id,this.val=val,this.api=void 0}children(){}child(){}container(){}view(){return this.val}name(){return"con"}toString(tab){const val=this.val,valFormatted=val instanceof Uint8Array?`Uint8Array { ${(""+val).replaceAll(",",", ")} }`:`{ ${val instanceof clock_1.Timestamp?(0,clock_1.toDisplayString)(val):JSON.stringify(val)} }`;return`${this.name()} ${(0,clock_1.toDisplayString)(this.id)} ${valFormatted}`}}},"./node_modules/json-joy/es2020/json-crdt/nodes/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/types.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/nodes.js"),exports)},"./node_modules/json-joy/es2020/json-crdt/nodes/nodes.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StrChunk=exports.StrNode=exports.BinChunk=exports.BinNode=exports.ArrChunk=exports.ArrNode=exports.ObjNode=exports.VecNode=exports.RootNode=exports.ValNode=exports.ConNode=void 0;var ConNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/con/ConNode.js");Object.defineProperty(exports,"ConNode",{enumerable:!0,get:function(){return ConNode_1.ConNode}});var ValNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/val/ValNode.js");Object.defineProperty(exports,"ValNode",{enumerable:!0,get:function(){return ValNode_1.ValNode}});var RootNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/root/RootNode.js");Object.defineProperty(exports,"RootNode",{enumerable:!0,get:function(){return RootNode_1.RootNode}});var VecNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/vec/VecNode.js");Object.defineProperty(exports,"VecNode",{enumerable:!0,get:function(){return VecNode_1.VecNode}});var ObjNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/obj/ObjNode.js");Object.defineProperty(exports,"ObjNode",{enumerable:!0,get:function(){return ObjNode_1.ObjNode}});var ArrNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/arr/ArrNode.js");Object.defineProperty(exports,"ArrNode",{enumerable:!0,get:function(){return ArrNode_1.ArrNode}}),Object.defineProperty(exports,"ArrChunk",{enumerable:!0,get:function(){return ArrNode_1.ArrChunk}});var BinNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/bin/BinNode.js");Object.defineProperty(exports,"BinNode",{enumerable:!0,get:function(){return BinNode_1.BinNode}}),Object.defineProperty(exports,"BinChunk",{enumerable:!0,get:function(){return BinNode_1.BinChunk}});var StrNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/str/StrNode.js");Object.defineProperty(exports,"StrNode",{enumerable:!0,get:function(){return StrNode_1.StrNode}}),Object.defineProperty(exports,"StrChunk",{enumerable:!0,get:function(){return StrNode_1.StrChunk}})},"./node_modules/json-joy/es2020/json-crdt/nodes/obj/ObjNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjNode=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js");exports.ObjNode=class ObjNode{constructor(doc,id){this.doc=doc,this.id=id,this.keys=new Map,this._tick=0,this._view={},this.api=void 0}get(key){const id=this.keys.get(key);if(id)return this.doc.index.get(id)}put(key,id){const currentId=this.keys.get(key);if(!(currentId&&(0,clock_1.compare)(currentId,id)>=0))return this.keys.set(key,id),currentId}nodes(callback){const index=this.doc.index;this.keys.forEach(((id,key)=>callback(index.get(id),key)))}children(callback){const index=this.doc.index;this.keys.forEach(((id,key)=>callback(index.get(id))))}child(){}container(){return this}view(){const doc=this.doc,tick=doc.clock.time+doc.tick,_view=this._view;if(this._tick===tick)return _view;const view={},index=doc.index;let useCache=!0;return this.keys.forEach(((id,key)=>{const valueNode=index.get(id);if(!valueNode)return void(useCache=!1);const value=valueNode.view();void 0!==value?(_view[key]!==value&&(useCache=!1),view[key]=value):void 0!==_view[key]&&(useCache=!1)})),useCache?_view:(this._tick=tick,this._view=view)}name(){return"obj"}toString(tab=""){return this.name()+" "+(0,clock_1.toDisplayString)(this.id)+(0,printTree_1.printTree)(tab,[...this.keys.entries()].filter((([,id])=>!!this.doc.index.get(id))).map((([key,id])=>tab=>JSON.stringify(key)+(0,printTree_1.printTree)(tab+" ",[tab=>this.doc.index.get(id).toString(tab)]))))}}},"./node_modules/json-joy/es2020/json-crdt/nodes/rga/AbstractRga.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractRga=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),isUint8Array_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/isUint8Array.js"),util_1=__webpack_require__("./node_modules/json-joy/es2020/util/trees/splay/util.js"),util2_1=__webpack_require__("./node_modules/json-joy/es2020/util/trees/splay/util2.js"),util2_2=__webpack_require__("./node_modules/json-joy/es2020/util/trees/util2.js"),printBinary_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printBinary.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js"),constants_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/constants.js"),compareById=(c1,c2)=>{const ts1=c1.id,ts2=c2.id;return ts1.sid-ts2.sid||ts1.time-ts2.time},updateLenOne=chunk=>{const l=chunk.l,r=chunk.r;chunk.len=(chunk.del?0:chunk.span)+(l?l.len:0)+(r?r.len:0)},updateLenOneLive=chunk=>{const l=chunk.l,r=chunk.r;chunk.len=chunk.span+(l?l.len:0)+(r?r.len:0)},dLen=(chunk,delta)=>{for(;chunk;)chunk.len+=delta,chunk=chunk.p},next=curr=>{const r=curr.r;if(r){let tmp;for(curr=r;tmp=curr.l;)curr=tmp;return curr}let p=curr.p;for(;p&&p.r===curr;)curr=p,p=p.p;return p};exports.AbstractRga=class AbstractRga{constructor(id){this.id=id,this.root=void 0,this.ids=void 0,this.count=0}ins(after,id,content){const rootId=this.id,afterTime=after.time,afterSid=after.sid;if(rootId.time===afterTime&&rootId.sid===afterSid)return void this.insAfterRoot(after,id,content);let curr=this.ids,chunk=curr;for(;curr;){const currId=curr.id,currIdSid=currId.sid;if(currIdSid>afterSid)curr=curr.l2;else if(currIdSid<afterSid)chunk=curr,curr=curr.r2;else{const currIdTime=currId.time;if(currIdTime>afterTime)curr=curr.l2;else{if(!(currIdTime<afterTime)){chunk=curr;break}chunk=curr,curr=curr.r2}}}if(!chunk)return;const atId=chunk.id,atIdTime=atId.time,atIdSid=atId.sid,atSpan=chunk.span;if(atIdSid!==afterSid)return;if(afterTime-atIdTime>=atSpan)return;const offsetInInsertAtChunk=afterTime-atIdTime;this.insAfterChunk(after,chunk,offsetInInsertAtChunk,id,content)}insAt(position,id,content){if(!position){const rootId=this.id;return this.insAfterRoot(rootId,id,content),rootId}const found=this.findChunk(position-1);if(!found)return;const[at,offset]=found,atId=at.id,after=0===offset?atId:new clock_1.Timestamp(atId.sid,atId.time+offset);return this.insAfterChunk(after,at,offset,id,content),after}insAfterRoot(after,id,content){const chunk=this.createChunk(id,content),first=this.first();if(first)if((0,clock_1.compare)(first.id,id)<0)this.insertBefore(chunk,first);else{if((0,clock_1.containsId)(first.id,first.span,id))return;this.insertAfterRef(chunk,after,first)}else this.setRoot(chunk)}insAfterChunk(after,chunk,chunkOffset,id,content){const atId=chunk.id,atIdTime=atId.time,atIdSid=atId.sid,atSpan=chunk.span,newChunk=this.createChunk(id,content);if(chunkOffset+1<atSpan){const idSid=id.sid,idTime=id.time;if(atIdSid===idSid&&atIdTime<=idTime&&atIdTime+atSpan-1>=idTime)return;if(idTime>after.time+1||idSid>after.sid)return this.insertInside(newChunk,chunk,chunkOffset+1),void this.splay(newChunk)}this.insertAfterRef(newChunk,after,chunk),this.splay(newChunk)}delete(spans){const length=spans.length;for(let i=0;i<length;i++)this.deleteSpan(spans[i]);this.onChange()}deleteSpan(span){const len=span.span,t1=span.time,t2=t1+len-1,start=this.findById(span);if(!start)return;let chunk=start,last=chunk;for(;chunk;){last=chunk;const id=chunk.id,chunkSpan=chunk.span,c1=id.time,c2=c1+chunkSpan-1;if(chunk.del){if(c2>=t2)break;chunk=chunk.s;continue}const deleteStartsInTheMiddle=t1<=c2;if(t1<=c1){if(!(t2>=c2)){const range=t2-c1+1,newChunk=this.split(chunk,range);chunk.delete(),updateLenOne(newChunk),dLen(chunk,-chunk.span);break}if(chunk.delete(),dLen(chunk,-chunk.span),t2<=c2)break}else if(deleteStartsInTheMiddle){if(!(t2>=c2)){const right=this.split(chunk,t2-c1+1),mid=this.split(chunk,t1-c1);mid.delete(),updateLenOne(right),updateLenOne(mid),dLen(chunk,-mid.span);break}{const offset=t1-c1,newChunk=this.split(chunk,offset);if(newChunk.delete(),newChunk.len=newChunk.r?newChunk.r.len:0,dLen(chunk,-newChunk.span),t2<=c2)break}}chunk=chunk.s}last&&this.mergeTombstones2(start,last)}find(position){let curr=this.root;for(;curr;){const l=curr.l,leftLength=l?l.len:0;let span;if(position<leftLength)curr=l;else if(curr.del)position-=leftLength,curr=curr.r;else{if(position<leftLength+(span=curr.span)){const ticks=position-leftLength,id=curr.id;return ticks?new clock_1.Timestamp(id.sid,id.time+ticks):id}position-=leftLength+span,curr=curr.r}}}findChunk(position){let curr=this.root;for(;curr;){const l=curr.l,leftLength=l?l.len:0;let span;if(position<leftLength)curr=l;else if(curr.del)position-=leftLength,curr=curr.r;else{if(position<leftLength+(span=curr.span))return[curr,position-leftLength];position-=leftLength+span,curr=curr.r}}}findInterval(position,length){const ranges=[];if(!length)return ranges;let curr=this.root,offset=0;for(;curr;){const leftLength=curr.l?curr.l.len:0;if(position<leftLength)curr=curr.l;else if(curr.del)position-=leftLength,curr=curr.r;else{if(position<leftLength+curr.span){offset=position-leftLength;break}position-=leftLength+curr.span,curr=curr.r}}if(!curr)return ranges;if(curr.span>=length+offset){const id=curr.id;return ranges.push((0,clock_1.tss)(id.sid,id.time+offset,length)),ranges}const len=curr.span-offset,id=curr.id;if(ranges.push((0,clock_1.tss)(id.sid,id.time+offset,len)),length-=len,curr=next(curr),!curr)return ranges;do{if(curr.del)continue;const id=curr.id,span=curr.span;if(length<=span)return ranges.push((0,clock_1.tss)(id.sid,id.time,length)),ranges;ranges.push((0,clock_1.tss)(id.sid,id.time,span)),length-=span}while((curr=next(curr))&&length>0);return ranges}findInterval2(from,to){const ranges=[];return this.range0(void 0,from,to,((chunk,off,len)=>{const id=chunk.id;ranges.push((0,clock_1.tss)(id.sid,id.time+off,len))})),ranges}range0(startChunk,from,to,callback){let chunk=startChunk||this.findById(from);if(startChunk)for(;chunk&&!(0,clock_1.containsId)(chunk.id,chunk.span,from);)chunk=next(chunk);if(chunk){if(chunk.del){if((0,clock_1.containsId)(chunk.id,chunk.span,to))return}else{const off=from.time-chunk.id.time;if((0,clock_1.containsId)(chunk.id,chunk.span,to)){return callback(chunk,off,to.time-from.time+1),chunk}callback(chunk,off,chunk.span-off)}for(chunk=next(chunk);chunk;){if((0,clock_1.containsId)(chunk.id,chunk.span,to))return chunk.del||callback(chunk,0,to.time-chunk.id.time+1),chunk;chunk.del||callback(chunk,0,chunk.span),chunk=next(chunk)}return chunk}}first(){let curr=this.root;for(;curr;){const l=curr.l;if(!l)return curr;curr=l}return curr}last(){let curr=this.root;for(;curr;){const r=curr.r;if(!r)return curr;curr=r}return curr}lastId(){const chunk=this.last();if(!chunk)return;const id=chunk.id,span=chunk.span;return 1===span?id:new clock_1.Timestamp(id.sid,id.time+span-1)}next(curr){return next(curr)}length(){const root=this.root;return root?root.len:0}size(){return this.count}pos(chunk){const p=chunk.p,l=chunk.l;if(!p)return l?l.len:0;const parentPos=this.pos(p);if(p.r===chunk)return parentPos+(p.del?0:p.span)+(l?l.len:0);const r=chunk.r;return parentPos-(chunk.del?0:chunk.span)-(r?r.len:0)}setRoot(chunk){this.root=chunk,this.insertId(chunk),this.onChange()}insertBefore(chunk,before){const l=before.l;before.l=chunk,chunk.l=l,chunk.p=before;let lLen=0;l&&(l.p=chunk,lLen=l.len),chunk.len=chunk.span+lLen,dLen(before,chunk.span),this.insertId(chunk),this.onChange()}insertAfter(chunk,after){const r=after.r;after.r=chunk,chunk.r=r,chunk.p=after;let rLen=0;r&&(r.p=chunk,rLen=r.len),chunk.len=chunk.span+rLen,dLen(after,chunk.span),this.insertId(chunk),this.onChange()}insertAfterRef(chunk,ref,left){const id=chunk.id,sid=id.sid,time=id.time;let isSplit=!1;for(;;){const leftId=left.id,leftNextTick=leftId.time+left.span;left.s||(isSplit=leftId.sid===sid&&leftNextTick===time&&leftNextTick-1===ref.time,isSplit&&(left.s=chunk));const right=next(left);if(!right)break;const rightId=right.id,rightIdTime=rightId.time,rightIdSid=rightId.sid;if(rightIdTime<time)break;if(rightIdTime===time){if(rightIdSid===sid)return;if(rightIdSid<sid)break}left=right}isSplit&&!left.del?(this.mergeContent(left,chunk.data),left.s=void 0):this.insertAfter(chunk,left)}mergeContent(chunk,content){const span1=chunk.span;chunk.merge(content),dLen(chunk,chunk.span-span1),this.onChange()}insertInside(chunk,at,offset){const p=at.p,l=at.l,r=at.r,s=at.s,len=at.len,at2=at.split(offset);if(at.s=at2,at2.s=s,at.l=at.r=at2.l=at2.r=void 0,at2.l=void 0,chunk.p=p,l){chunk.l=l,l.p=chunk;const a=l.r;l.r=at,at.p=l,at.l=a,a&&(a.p=at)}else chunk.l=at,at.p=chunk;if(r){chunk.r=r,r.p=chunk;const b=r.l;r.l=at2,at2.p=r,at2.r=b,b&&(b.p=at2)}else chunk.r=at2,at2.p=chunk;p?p.l===at?p.l=chunk:p.r=chunk:this.root=chunk,updateLenOne(at),updateLenOne(at2),l&&(l.len=(l.l?l.l.len:0)+at.len+(l.del?0:l.span)),r&&(r.len=(r.r?r.r.len:0)+at2.len+(r.del?0:r.span)),chunk.len=len+chunk.span;const span=chunk.span;let curr=chunk.p;for(;curr;)curr.len+=span,curr=curr.p;this.insertId(at2),this.insertIdFast(chunk),this.onChange()}split(chunk,ticks){const s=chunk.s,newChunk=chunk.split(ticks),r=chunk.r;return chunk.s=newChunk,newChunk.r=r,newChunk.s=s,chunk.r=newChunk,newChunk.p=chunk,this.insertId(newChunk),r&&(r.p=newChunk),newChunk}mergeTombstones(ch1,ch2){if(!ch1.del||!ch2.del)return!1;const id1=ch1.id,id2=ch2.id;return id1.sid===id2.sid&&(id1.time+ch1.span===id2.time&&(ch1.s=ch2.s,ch1.span+=ch2.span,this.deleteChunk(ch2),!0))}mergeTombstones2(start,end){let curr=start;for(;curr;){const nextCurr=next(curr);if(!nextCurr)break;if(!this.mergeTombstones(curr,nextCurr)){if(nextCurr===end){if(nextCurr){const n=next(nextCurr);n&&this.mergeTombstones(nextCurr,n)}break}curr=curr.s}}const left=(curr=>{const l=curr.l;if(l){let tmp;for(curr=l;tmp=curr.r;)curr=tmp;return curr}let p=curr.p;for(;p&&p.l===curr;)curr=p,p=p.p;return p})(start);left&&this.mergeTombstones(left,start)}removeTombstones(){let curr=this.first();const list=[];for(;curr;)curr.del&&list.push(curr),curr=next(curr);for(let i=0;i<list.length;i++)this.deleteChunk(list[i])}deleteChunk(chunk){this.deleteId(chunk);const p=chunk.p,l=chunk.l,r=chunk.r;if(chunk.id=constants_1.ORIGIN,l||r)if(l&&r){let mostRightChildFromLeft=l;for(;mostRightChildFromLeft.r;)mostRightChildFromLeft=mostRightChildFromLeft.r;mostRightChildFromLeft.r=r,r.p=mostRightChildFromLeft;const rLen=r.len;let curr;for(curr=mostRightChildFromLeft,p?(p.l===chunk?p.l=l:p.r=l,l.p=p):(this.root=l,l.p=void 0);curr&&curr!==p;)curr.len+=rLen,curr=curr.p}else{const child=l||r;child.p=p,p?p.l===chunk?p.l=child:p.r=child:this.root=child}else p?p.l===chunk?p.l=void 0:p.r=void 0:this.root=void 0}insertId(chunk){this.ids=(0,util2_2.insert2)(this.ids,chunk,compareById),this.count++,this.ids=(0,util2_1.splay2)(this.ids,chunk)}insertIdFast(chunk){this.ids=(0,util2_2.insert2)(this.ids,chunk,compareById),this.count++}deleteId(chunk){this.ids=(0,util2_2.remove2)(this.ids,chunk),this.count--}findById(after){const afterSid=after.sid,afterTime=after.time;let curr=this.ids,chunk=curr;for(;curr;){const currId=curr.id,currIdSid=currId.sid;if(currIdSid>afterSid)curr=curr.l2;else if(currIdSid<afterSid)chunk=curr,curr=curr.r2;else{const currIdTime=currId.time;if(currIdTime>afterTime)curr=curr.l2;else{if(!(currIdTime<afterTime)){chunk=curr;break}chunk=curr,curr=curr.r2}}}if(!chunk)return;const atId=chunk.id,atIdTime=atId.time,atIdSid=atId.sid,atSpan=chunk.span;if(atIdSid!==afterSid)return;if(afterTime<atIdTime)return;return afterTime-atIdTime>=atSpan?void 0:chunk}splay(chunk){const p=chunk.p;if(!p)return;const pp=p.p,l2=p.l===chunk;if(!pp)return l2?(0,util_1.rSplay)(chunk,p):(0,util_1.lSplay)(chunk,p),this.root=chunk,updateLenOne(p),void updateLenOneLive(chunk);const l1=pp.l===p;this.root=l1?l2?(0,util_1.llSplay)(this.root,chunk,p,pp):(0,util_1.lrSplay)(this.root,chunk,p,pp):l2?(0,util_1.rlSplay)(this.root,chunk,p,pp):(0,util_1.rrSplay)(this.root,chunk,p,pp),updateLenOne(pp),updateLenOne(p),updateLenOneLive(chunk),this.splay(chunk)}iterator(){let curr=this.first();return()=>{const res=curr;return curr&&(curr=next(curr)),res}}ingest(size,next){if(size<1)return;const splitLeftChunks=new Map;this.root=this._ingest(size,(()=>{const chunk=next(),id=chunk.id,key=id.sid+"."+id.time,split=splitLeftChunks.get(key);split&&(split.s=chunk,splitLeftChunks.delete(key));const nextStampAfterSpan=(0,clock_1.tick)(id,chunk.span);return splitLeftChunks.set(nextStampAfterSpan.sid+"."+nextStampAfterSpan.time,chunk),chunk}))}_ingest(size,next){const leftSize=size>>1,rightSize=size-leftSize-1,c1=leftSize>0?this._ingest(leftSize,next):void 0,c2=next();c1&&(c2.l=c1,c1.p=c2);const c3=rightSize>0?this._ingest(rightSize,next):void 0;return c3&&(c2.r=c3,c3.p=c2),updateLenOne(c2),this.insertId(c2),c2}toStringName(){return this.constructor.name}toString(tab=""){const view=this.view();let value="";(0,isUint8Array_1.isUint8Array)(view)?value+=` { ${(""+view).replaceAll(",",", ")} }`:"string"==typeof view&&(value+=`{ ${view.length>32?JSON.stringify(view.substring(0,32))+" …":JSON.stringify(view)} }`);return`${this.toStringName()} ${(0,clock_1.toDisplayString)(this.id)} ${value}`+(0,printTree_1.printTree)(tab,[tab=>this.root?this.printChunk(tab,this.root):"∅"])}printChunk(tab,chunk){return this.formatChunk(chunk)+(0,printBinary_1.printBinary)(tab,[chunk.l?tab=>this.printChunk(tab,chunk.l):null,chunk.r?tab=>this.printChunk(tab,chunk.r):null])}formatChunk(chunk){const id=(0,clock_1.toDisplayString)(chunk.id);let str=`${chunk.constructor.name} ${id}!${chunk.span} len:${chunk.len}`;if(chunk.del)str+=` [${chunk.span}]`;else if((0,isUint8Array_1.isUint8Array)(chunk.data))str+=` { ${chunk.data.toString().replaceAll(",",", ")} }`;else if("string"==typeof chunk.data){str+=` { ${chunk.data.length>32?JSON.stringify(chunk.data.substring(0,32))+" …":JSON.stringify(chunk.data)} }`}return str}}},"./node_modules/json-joy/es2020/json-crdt/nodes/root/RootNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RootNode=void 0;const constants_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/constants.js"),ValNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/val/ValNode.js");class RootNode extends ValNode_1.ValNode{constructor(doc,val){super(doc,constants_1.ORIGIN,val)}name(){return"root"}}exports.RootNode=RootNode},"./node_modules/json-joy/es2020/json-crdt/nodes/str/StrNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StrNode=exports.StrChunk=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),AbstractRga_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/rga/AbstractRga.js"),util_1=__webpack_require__("./node_modules/json-joy/es2020/util/trees/util.js");class StrChunk{constructor(id,span,str){this.id=id,this.span=span,this.len=str?span:0,this.del=!str,this.p=void 0,this.l=void 0,this.r=void 0,this.p2=void 0,this.l2=void 0,this.r2=void 0,this.s=void 0,this.data=str}merge(str){this.data+=str,this.span=this.data.length}split(ticks){if(!this.del){const chunk=new StrChunk((0,clock_1.tick)(this.id,ticks),this.span-ticks,this.data.slice(ticks));return this.data=this.data.slice(0,ticks),this.span=ticks,chunk}const chunk=new StrChunk((0,clock_1.tick)(this.id,ticks),this.span-ticks,"");return this.span=ticks,chunk}delete(){this.del=!0,this.data=""}clone(){return new StrChunk(this.id,this.span,this.data)}}exports.StrChunk=StrChunk;class StrNode extends AbstractRga_1.AbstractRga{constructor(){super(...arguments),this._view="",this.api=void 0}children(){}child(){}container(){}view(){if(this._view)return this._view;let str="";for(let chunk=this.first();chunk;chunk=(0,util_1.next)(chunk))str+=chunk.data;return this._view=str}name(){return"str"}createChunk(id,str){return new StrChunk(id,str?str.length:0,str||"")}onChange(){this._view=""}toStringName(){return this.name()}}exports.StrNode=StrNode},"./node_modules/json-joy/es2020/json-crdt/nodes/types.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},"./node_modules/json-joy/es2020/json-crdt/nodes/val/ValNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValNode=void 0;const clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js"),Model_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/model/Model.js");exports.ValNode=class ValNode{constructor(doc,id,val){this.doc=doc,this.id=id,this.val=val,this.api=void 0}set(val){if((0,clock_1.compare)(val,this.val)<=0&&0!==this.val.sid)return;if((0,clock_1.compare)(val,this.id)<=0)return;const oldVal=this.val;return this.val=val,oldVal}node(){return 0===this.val.sid?Model_1.UNDEFINED:this.child()}view(){return this.node()?.view()}children(callback){callback(this.node())}child(){return this.doc.index.get(this.val)}container(){const child=this.node();return child?child.container():void 0}name(){return"val"}toString(tab=""){const node=this.node();return this.name()+" "+(0,clock_1.toDisplayString)(this.id)+(0,printTree_1.printTree)(tab,[tab=>node?node.toString(tab):(0,clock_1.toDisplayString)(this.val)])}}},"./node_modules/json-joy/es2020/json-crdt/nodes/vec/VecNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VecNode=void 0;const ConNode_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt/nodes/con/ConNode.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js"),clock_1=__webpack_require__("./node_modules/json-joy/es2020/json-crdt-patch/clock/index.js");exports.VecNode=class VecNode{constructor(doc,id){this.doc=doc,this.id=id,this.elements=[],this._view=[],this.api=void 0}val(index){return this.elements[index]}get(index){const id=this.elements[index];if(id)return this.doc.index.get(id)}put(index,id){if(index>255)throw new Error("OUT_OF_BOUNDS");const currentId=this.val(index);if(!(currentId&&(0,clock_1.compare)(currentId,id)>=0)){if(index>this.elements.length)for(let i=this.elements.length;i<index;i++)this.elements.push(void 0);return index<this.elements.length?this.elements[index]=id:this.elements.push(id),currentId}}ext(){if(this.__extNode)return this.__extNode;const extensionId=this.getExtId();if(!(extensionId>=0))return;const extension=this.doc.ext.get(extensionId);return extension?(this.__extNode=new extension.Node(this.get(1)),this.__extNode):void 0}isExt(){return!!this.ext()}getExtId(){if(2!==this.elements.length)return-1;const type=this.get(0);if(!(type instanceof ConNode_1.ConNode))return-1;const buf=type.val,id=this.id;return buf instanceof Uint8Array&&3===buf.length&&buf[1]===id.sid%256&&buf[2]===id.time%256?buf[0]:-1}child(){return this.ext()}container(){return this}children(callback){if(this.isExt())return;const elements=this.elements,length=elements.length,index=this.doc.index;for(let i=0;i<length;i++){const id=elements[i];if(!id)continue;const node=index.get(id);node&&callback(node)}}view(){const extNode=this.ext();if(extNode)return extNode.view();let useCache=!0;const _view=this._view,arr=[],index=this.doc.index,elements=this.elements,length=elements.length;for(let i=0;i<length;i++){const id=elements[i],node=id?index.get(id):void 0,value=node?node.view():void 0;_view[i]!==value&&(useCache=!1),arr.push(value)}return useCache?_view:this._view=arr}name(){return"vec"}toString(tab=""){const extNode=this.ext(),header=this.name()+" "+(0,clock_1.toDisplayString)(this.id)+(extNode?` { extension = ${this.getExtId()} }`:"");if(extNode)return this.child().toString(tab);const index=this.doc.index;return header+(0,printTree_1.printTree)(tab,[...this.elements.map(((id,i)=>tab=>`${i}: ${id&&index.get(id)?index.get(id).toString(tab+"  "+" ".repeat((""+i).length)):"nil"}`)),...extNode?[tab=>`${this.child().toString(tab)}`]:[]])}}},"./node_modules/json-joy/es2020/json-pack/JsonPackExtension.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JsonPackExtension=void 0;exports.JsonPackExtension=class JsonPackExtension{constructor(tag,val){this.tag=tag,this.val=val}}},"./node_modules/json-joy/es2020/json-pack/JsonPackValue.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JsonPackValue=void 0;exports.JsonPackValue=class JsonPackValue{constructor(val){this.val=val}}},"./node_modules/json-joy/es2020/json-pack/cbor/CborDecoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CborDecoder=void 0;const CborDecoderBase_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/cbor/CborDecoderBase.js"),JsonPackValue_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/JsonPackValue.js");class CborDecoder extends CborDecoderBase_1.CborDecoderBase{readAsMap(){const octet=this.reader.u8(),minor=31&octet;if(5===octet>>5)return this.readMap(minor);throw 0}readMap(minor){const length=this.readMinorLen(minor);return length>=0?this.readMapRaw(length):this.readMapIndef()}readMapRaw(length){const map=new Map;for(let i=0;i<length;i++){const key=this.val(),value=this.val();map.set(key,value)}return map}readMapIndef(){const map=new Map;for(;255!==this.reader.peak();){const key=this.val();if(255===this.reader.peak())throw 7;const value=this.val();map.set(key,value)}return this.reader.x++,map}skipN(n){for(let i=0;i<n;i++)this.skipAny()}skipAny(){this.skipAnyRaw(this.reader.u8())}skipAnyRaw(octet){const minor=31&octet;switch(octet>>5){case 0:case 1:this.skipUNint(minor);break;case 2:this.skipBin(minor);break;case 3:this.skipStr(minor);break;case 4:this.skipArr(minor);break;case 5:this.skipObj(minor);break;case 7:this.skipTkn(minor);break;case 6:this.skipTag(minor)}}skipMinorLen(minor){if(minor<=23)return minor;switch(minor){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}skipUNint(minor){if(!(minor<=23))switch(minor){case 24:return this.reader.skip(1);case 25:return this.reader.skip(2);case 26:return this.reader.skip(4);case 27:return this.reader.skip(8);default:throw 1}}skipBin(minor){const length=this.skipMinorLen(minor);if(length>=0)this.reader.skip(length);else{for(;255!==this.reader.peak();)this.skipBinChunk();this.reader.x++}}skipBinChunk(){const octet=this.reader.u8(),minor=31&octet;if(2!==octet>>5)throw 2;if(minor>27)throw 3;this.skipBin(minor)}skipStr(minor){const length=this.skipMinorLen(minor);if(length>=0)this.reader.skip(length);else{for(;255!==this.reader.peak();)this.skipStrChunk();this.reader.x++}}skipStrChunk(){const octet=this.reader.u8(),minor=31&octet;if(3!==octet>>5)throw 4;if(minor>27)throw 5;this.skipStr(minor)}skipArr(minor){const length=this.skipMinorLen(minor);if(length>=0)this.skipN(length);else{for(;255!==this.reader.peak();)this.skipAny();this.reader.x++}}skipObj(minor){const length=this.readMinorLen(minor);if(length>=0)return this.skipN(2*length);for(;255!==this.reader.peak();){if(this.skipAny(),255===this.reader.peak())throw 7;this.skipAny()}this.reader.x++}skipTag(minor){if(this.skipMinorLen(minor)<0)throw 1;this.skipAny()}skipTkn(minor){switch(minor){case 24:return void this.reader.skip(1);case 25:return void this.reader.skip(2);case 26:return void this.reader.skip(4);case 27:return void this.reader.skip(8)}if(!(minor<=23))throw 1}validate(value,offset=0,size=value.length){this.reader.reset(value),this.reader.x=offset;const start=offset;this.skipAny();if(this.reader.x-start!==size)throw 8}decodeLevel(value){return this.reader.reset(value),this.readLevel()}readLevel(){const octet=this.reader.u8(),minor=31&octet;switch(octet>>5){case 4:return this.readArrLevel(minor);case 5:return this.readObjLevel(minor);default:return super.readAnyRaw(octet)}}readPrimitiveOrVal(){switch(this.reader.peak()>>5){case 4:case 5:return this.readAsValue();default:return this.val()}}readAsValue(){const reader=this.reader,start=reader.x;this.skipAny();const end=reader.x;return new JsonPackValue_1.JsonPackValue(reader.uint8.subarray(start,end))}readObjLevel(minor){const length=this.readMinorLen(minor);return length>=0?this.readObjRawLevel(length):this.readObjIndefLevel()}readObjRawLevel(length){const obj={};for(let i=0;i<length;i++){const key=this.key(),value=this.readPrimitiveOrVal();obj[key]=value}return obj}readObjIndefLevel(){const obj={};for(;255!==this.reader.peak();){const key=this.key();if(255===this.reader.peak())throw 7;const value=this.readPrimitiveOrVal();obj[key]=value}return this.reader.x++,obj}readArrLevel(minor){const length=this.readMinorLen(minor);return length>=0?this.readArrRawLevel(length):this.readArrIndefLevel()}readArrRawLevel(length){const arr=[];for(let i=0;i<length;i++)arr.push(this.readPrimitiveOrVal());return arr}readArrIndefLevel(){const arr=[];for(;255!==this.reader.peak();)arr.push(this.readPrimitiveOrVal());return this.reader.x++,arr}readHdr(expectedMajor){const octet=this.reader.u8();if(octet>>5!==expectedMajor)throw 0;const minor=31&octet;if(minor<24)return minor;switch(minor){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1}throw 1}readStrHdr(){return this.readHdr(3)}readObjHdr(){return this.readHdr(5)}readArrHdr(){return this.readHdr(4)}findKey(key){const size=this.readObjHdr();for(let i=0;i<size;i++){if(this.key()===key)return this;this.skipAny()}throw 9}findIndex(index){if(index>=this.readArrHdr())throw 10;for(let i=0;i<index;i++)this.skipAny();return this}find(path){for(let i=0;i<path.length;i++){const segment=path[i];"string"==typeof segment?this.findKey(segment):this.findIndex(segment)}return this}}exports.CborDecoder=CborDecoder},"./node_modules/json-joy/es2020/json-pack/cbor/CborDecoderBase.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CborDecoderBase=void 0;const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),f16_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/f16.js"),JsonPackExtension_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/JsonPackExtension.js"),JsonPackValue_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/JsonPackValue.js"),Reader_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/Reader.js"),sharedCachedUtf8Decoder_1=tslib_1.__importDefault(__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/sharedCachedUtf8Decoder.js"));exports.CborDecoderBase=class CborDecoderBase{constructor(reader=new Reader_1.Reader,keyDecoder=sharedCachedUtf8Decoder_1.default){this.reader=reader,this.keyDecoder=keyDecoder}read(uint8){return this.reader.reset(uint8),this.val()}decode(uint8){return this.reader.reset(uint8),this.val()}val(){const octet=this.reader.u8(),major=octet>>5,minor=31&octet;return major<4?major<2?0===major?this.readUint(minor):this.readNint(minor):2===major?this.readBin(minor):this.readStr(minor):major<6?4===major?this.readArr(minor):this.readObj(minor):6===major?this.readTag(minor):this.readTkn(minor)}readAnyRaw(octet){const major=octet>>5,minor=31&octet;return major<4?major<2?0===major?this.readUint(minor):this.readNint(minor):2===major?this.readBin(minor):this.readStr(minor):major<6?4===major?this.readArr(minor):this.readObj(minor):6===major?this.readTag(minor):this.readTkn(minor)}readMinorLen(minor){if(minor<24)return minor;switch(minor){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}readUint(minor){if(minor<25)return 24===minor?this.reader.u8():minor;if(minor<27)return 25===minor?this.reader.u16():this.reader.u32();{const num=this.reader.u64();return num>9007199254740991?num:Number(num)}}readNint(minor){if(minor<25)return 24===minor?-this.reader.u8()-1:-minor-1;if(minor<27)return 25===minor?-this.reader.u16()-1:-this.reader.u32()-1;{const num=this.reader.u64();return num>9007199254740990?-num-BigInt(1):-Number(num)-1}}readBin(minor){const reader=this.reader;if(minor<=23)return reader.buf(minor);switch(minor){case 24:return reader.buf(reader.u8());case 25:return reader.buf(reader.u16());case 26:return reader.buf(reader.u32());case 27:return reader.buf(Number(reader.u64()));case 31:{let size=0;const list=[];for(;255!==this.reader.peak();){const uint8=this.readBinChunk();size+=uint8.length,list.push(uint8)}this.reader.x++;const res=new Uint8Array(size);let offset=0;const length=list.length;for(let i=0;i<length;i++){const arr=list[i];res.set(arr,offset),offset+=arr.length}return res}default:throw 1}}readBinChunk(){const octet=this.reader.u8(),minor=31&octet;if(2!==octet>>5)throw 2;if(minor>27)throw 3;return this.readBin(minor)}readAsStr(){const octet=this.reader.u8(),minor=31&octet;if(3!==octet>>5)throw 11;return this.readStr(minor)}readStr(minor){const reader=this.reader;if(minor<=23)return reader.utf8(minor);switch(minor){case 24:return reader.utf8(reader.u8());case 25:return reader.utf8(reader.u16());case 26:return reader.utf8(reader.u32());case 27:return reader.utf8(Number(reader.u64()));case 31:{let str="";for(;255!==reader.peak();)str+=this.readStrChunk();return this.reader.x++,str}default:throw 1}}readStrLen(minor){if(minor<=23)return minor;switch(minor){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());default:throw 1}}readStrChunk(){const octet=this.reader.u8(),minor=31&octet;if(3!==octet>>5)throw 4;if(minor>27)throw 5;return this.readStr(minor)}readArr(minor){const length=this.readMinorLen(minor);return length>=0?this.readArrRaw(length):this.readArrIndef()}readArrRaw(length){const arr=[];for(let i=0;i<length;i++)arr.push(this.val());return arr}readArrIndef(){const arr=[];for(;255!==this.reader.peak();)arr.push(this.val());return this.reader.x++,arr}readObj(minor){if(minor<28){let length=minor;switch(minor){case 24:length=this.reader.u8();break;case 25:length=this.reader.u16();break;case 26:length=this.reader.u32();break;case 27:length=Number(this.reader.u64())}const obj={};for(let i=0;i<length;i++){const key=this.key();if("__proto__"===key)throw 6;const value=this.val();obj[key]=value}return obj}if(31===minor)return this.readObjIndef();throw 1}readObjRaw(length){const obj={};for(let i=0;i<length;i++){const key=this.key(),value=this.val();obj[key]=value}return obj}readObjIndef(){const obj={};for(;255!==this.reader.peak();){const key=this.key();if(255===this.reader.peak())throw 7;const value=this.val();obj[key]=value}return this.reader.x++,obj}key(){const octet=this.reader.u8(),minor=31&octet;if(3!==octet>>5)return String(this.readAnyRaw(octet));const length=this.readStrLen(minor);if(length>31)return this.reader.utf8(length);const key=this.keyDecoder.decode(this.reader.uint8,this.reader.x,length);return this.reader.skip(length),key}readTag(minor){if(minor<=23)return this.readTagRaw(minor);switch(minor){case 24:return this.readTagRaw(this.reader.u8());case 25:return this.readTagRaw(this.reader.u16());case 26:return this.readTagRaw(this.reader.u32());case 27:return this.readTagRaw(Number(this.reader.u64()));default:throw 1}}readTagRaw(tag){return new JsonPackExtension_1.JsonPackExtension(tag,this.val())}readTkn(minor){switch(minor){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 24:return new JsonPackValue_1.JsonPackValue(this.reader.u8());case 25:return this.f16();case 26:return this.reader.f32();case 27:return this.reader.f64()}if(minor<=23)return new JsonPackValue_1.JsonPackValue(minor);throw 1}f16(){return(0,f16_1.decodeF16)(this.reader.u16())}}},"./node_modules/json-joy/es2020/json-pack/cbor/CborEncoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CborEncoder=void 0;const isFloat32_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/isFloat32.js"),JsonPackExtension_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/JsonPackExtension.js"),CborEncoderFast_1=__webpack_require__("./node_modules/json-joy/es2020/json-pack/cbor/CborEncoderFast.js");class CborEncoder extends CborEncoderFast_1.CborEncoderFast{writeUnknown(value){this.writeNull()}writeAny(value){switch(typeof value){case"number":return this.writeNumber(value);case"string":return this.writeStr(value);case"boolean":return this.writer.u8(+value+244);case"object":if(!value)return this.writer.u8(246);switch(value.constructor){case Object:return this.writeObj(value);case Array:return this.writeArr(value);case Uint8Array:return this.writeBin(value);case Map:return this.writeMap(value);case JsonPackExtension_1.JsonPackExtension:return this.writeTag(value.tag,value.val);default:return this.writeUnknown(value)}case"undefined":return this.writeUndef();case"bigint":return this.writeBigInt(value);default:return this.writeUnknown(value)}}writeFloat(float){(0,isFloat32_1.isFloat32)(float)?this.writer.u8f32(250,float):this.writer.u8f64(251,float)}writeMap(map){this.writeMapHdr(map.size),map.forEach(((value,key)=>{this.writeAny(key),this.writeAny(value)}))}writeUndef(){this.writer.u8(247)}}exports.CborEncoder=CborEncoder},"./node_modules/json-joy/es2020/json-pack/cbor/CborEncoderFast.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CborEncoderFast=void 0;const Writer_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/Writer.js"),isSafeInteger=Number.isSafeInteger;exports.CborEncoderFast=class CborEncoderFast{constructor(writer=new Writer_1.Writer){this.writer=writer}encode(value){return this.writeAny(value),this.writer.flush()}encodeToSlice(value){return this.writeAny(value),this.writer.flushSlice()}writeAny(value){switch(typeof value){case"number":return this.writeNumber(value);case"string":return this.writeStr(value);case"boolean":return this.writer.u8(+value+244);case"object":if(!value)return this.writer.u8(246);return value.constructor===Array?this.writeArr(value):this.writeObj(value)}}writeCbor(){this.writer.u8u16(217,55799)}writeEnd(){this.writer.u8(255)}writeNull(){this.writer.u8(246)}writeBoolean(bool){bool?this.writer.u8(245):this.writer.u8(244)}writeNumber(num){isSafeInteger(num)?this.writeInteger(num):"bigint"==typeof num?this.writeBigInt(num):this.writeFloat(num)}writeBigInt(int){int>=0?this.writeBigUint(int):this.writeBigSint(int)}writeBigUint(uint){if(uint<=Number.MAX_SAFE_INTEGER)return this.writeUInteger(Number(uint));this.writer.u8u64(27,uint)}writeBigSint(int){if(int>=Number.MIN_SAFE_INTEGER)return this.encodeNint(Number(int));const uint=-BigInt(1)-int;this.writer.u8u64(59,uint)}writeInteger(int){int>=0?this.writeUInteger(int):this.encodeNint(int)}writeUInteger(uint){const writer=this.writer;writer.ensureCapacity(9);const uint8=writer.uint8;let x=writer.x;uint<=23?uint8[x++]=0+uint:uint<=255?(uint8[x++]=24,uint8[x++]=uint):uint<=65535?(uint8[x++]=25,writer.view.setUint16(x,uint),x+=2):uint<=4294967295?(uint8[x++]=26,writer.view.setUint32(x,uint),x+=4):(uint8[x++]=27,writer.view.setBigUint64(x,BigInt(uint)),x+=8),writer.x=x}encodeNumber(num){this.writeNumber(num)}encodeInteger(int){this.writeInteger(int)}encodeUint(uint){this.writeUInteger(uint)}encodeNint(int){const uint=-1-int,writer=this.writer;writer.ensureCapacity(9);const uint8=writer.uint8;let x=writer.x;uint<24?uint8[x++]=32+uint:uint<=255?(uint8[x++]=56,uint8[x++]=uint):uint<=65535?(uint8[x++]=57,writer.view.setUint16(x,uint),x+=2):uint<=4294967295?(uint8[x++]=58,writer.view.setUint32(x,uint),x+=4):(uint8[x++]=59,writer.view.setBigUint64(x,BigInt(uint)),x+=8),writer.x=x}writeFloat(float){this.writer.u8f64(251,float)}writeBin(buf){const length=buf.length;this.writeBinHdr(length),this.writer.buf(buf,length)}writeBinHdr(length){const writer=this.writer;length<=23?writer.u8(64+length):length<=255?writer.u16(22528+length):length<=65535?writer.u8u16(89,length):length<=4294967295?writer.u8u32(90,length):writer.u8u64(91,length)}writeStartBin(){this.writer.u8(95)}writeStr(str){const writer=this.writer,maxSize=4*str.length;writer.ensureCapacity(5+maxSize);const uint8=writer.uint8;let lengthOffset=writer.x;maxSize<=23?writer.x++:maxSize<=255?(uint8[writer.x++]=120,lengthOffset=writer.x,writer.x++):maxSize<=65535?(uint8[writer.x++]=121,lengthOffset=writer.x,writer.x+=2):(uint8[writer.x++]=122,lengthOffset=writer.x,writer.x+=4);const bytesWritten=writer.utf8(str);maxSize<=23?uint8[lengthOffset]=96+bytesWritten:maxSize<=255?uint8[lengthOffset]=bytesWritten:maxSize<=65535?writer.view.setUint16(lengthOffset,bytesWritten):writer.view.setUint32(lengthOffset,bytesWritten)}writeStrHdr(length){const writer=this.writer;length<=23?writer.u8(96+length):length<=255?writer.u16(30720+length):length<=65535?writer.u8u16(121,length):writer.u8u32(122,length)}writeAsciiStr(str){this.writeStrHdr(str.length),this.writer.ascii(str)}writeStartStr(){this.writer.u8(127)}writeArr(arr){const length=arr.length;this.writeArrHdr(length);for(let i=0;i<length;i++)this.writeAny(arr[i])}writeArrHdr(length){const writer=this.writer;length<=23?writer.u8(128+length):length<=255?writer.u16(38912+length):length<=65535?writer.u8u16(153,length):length<=4294967295?writer.u8u32(154,length):writer.u8u64(155,length)}writeStartArr(){this.writer.u8(159)}writeEndArr(){this.writer.u8(255)}writeObj(obj){const keys=Object.keys(obj),length=keys.length;this.writeObjHdr(length);for(let i=0;i<length;i++){const key=keys[i];this.writeStr(key),this.writeAny(obj[key])}}writeObjHdr(length){const writer=this.writer;length<=23?writer.u8(160+length):length<=255?writer.u16(47104+length):length<=65535?writer.u8u16(185,length):length<=4294967295?writer.u8u32(186,length):writer.u8u64(187,length)}writeMapHdr(length){this.writeObjHdr(length)}writeStartMap(){this.writer.u8(191)}writeStartObj(){this.writer.u8(191)}writeEndObj(){this.writer.u8(255)}writeTag(tag,value){this.writeTagHdr(tag),this.writeAny(value)}writeTagHdr(tag){const writer=this.writer;tag<=23?writer.u8(192+tag):tag<=255?writer.u16(55296+tag):tag<=65535?writer.u8u16(217,tag):tag<=4294967295?writer.u8u32(218,tag):writer.u8u64(219,tag)}writeTkn(value){const writer=this.writer;value<=23?writer.u8(224+value):value<=255&&writer.u16(63488+value)}}},"./node_modules/json-joy/es2020/json-pointer/find.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObjectReference=exports.isArrayEnd=exports.isArrayReference=exports.find=void 0;const hasOwnProperty_1=__webpack_require__("./node_modules/json-joy/es2020/util/hasOwnProperty.js"),{isArray}=Array;exports.find=(val,path)=>{const pathLength=path.length;if(!pathLength)return{val};let obj,key;for(let i=0;i<pathLength;i++)if(obj=val,key=path[i],isArray(obj)){const length=obj.length;if("-"===key)key=length;else if("string"==typeof key){const key2=~~key;if(""+key2!==key)throw new Error("INVALID_INDEX");if(key=key2,key<0)throw new Error("INVALID_INDEX")}val=obj[key]}else{if("object"!=typeof obj||!obj)throw new Error("NOT_FOUND");val=(0,hasOwnProperty_1.hasOwnProperty)(obj,key)?obj[key]:void 0}return{val,obj,key}};exports.isArrayReference=ref=>isArray(ref.obj)&&"number"==typeof ref.key;exports.isArrayEnd=ref=>ref.obj.length===ref.key;exports.isObjectReference=ref=>"object"==typeof ref.obj&&"string"==typeof ref.key},"./node_modules/json-joy/es2020/json-pointer/findByPointer/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/findByPointer/v5.js"),exports)},"./node_modules/json-joy/es2020/json-pointer/findByPointer/v5.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.findByPointer=void 0;const hasOwnProperty_1=__webpack_require__("./node_modules/json-joy/es2020/util/hasOwnProperty.js"),util_1=__webpack_require__("./node_modules/json-joy/es2020/json-pointer/util.js"),{isArray}=Array;exports.findByPointer=(pointer,val)=>{if(!pointer)return{val};let obj,key,indexOfSlash=0,indexAfterSlash=1;for(;indexOfSlash>-1;)if(indexOfSlash=pointer.indexOf("/",indexAfterSlash),key=indexOfSlash>-1?pointer.substring(indexAfterSlash,indexOfSlash):pointer.substring(indexAfterSlash),indexAfterSlash=indexOfSlash+1,obj=val,isArray(obj)){const length=obj.length;if("-"===key)key=length;else{const key2=~~key;if(""+key2!==key)throw new Error("INVALID_INDEX");if(key=key2,key<0)throw"INVALID_INDEX"}val=obj[key]}else{if("object"!=typeof obj||!obj)throw"NOT_FOUND";key=(0,util_1.unescapeComponent)(key),val=(0,hasOwnProperty_1.hasOwnProperty)(obj,key)?obj[key]:void 0}return{val,obj,key}}},"./node_modules/json-joy/es2020/json-pointer/get.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.get=void 0;const hasOwnProperty_1=__webpack_require__("./node_modules/json-joy/es2020/util/hasOwnProperty.js");exports.get=(val,path)=>{const pathLength=path.length;let key;if(!pathLength)return val;for(let i=0;i<pathLength;i++)if(key=path[i],val instanceof Array){val.length;if("-"===key)return;const key2=~~key;if(""+key2!==key)return;if(key=key2,key<0)return;val=val[key]}else{if("object"!=typeof val)return;if(!val||!(0,hasOwnProperty_1.hasOwnProperty)(val,key))return;val=val[key]}return val}},"./node_modules/json-joy/es2020/json-pointer/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/types.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/util.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/validate.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/get.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/find.js"),exports),tslib_1.__exportStar(__webpack_require__("./node_modules/json-joy/es2020/json-pointer/findByPointer/index.js"),exports)},"./node_modules/json-joy/es2020/json-pointer/types.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},"./node_modules/json-joy/es2020/json-pointer/util.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isInteger=exports.isValidIndex=exports.parent=exports.isRoot=exports.isPathEqual=exports.isChild=exports.toPath=exports.formatJsonPointer=exports.parseJsonPointer=exports.escapeComponent=exports.unescapeComponent=void 0;const r1=/~1/g,r2=/~0/g,r3=/~/g,r4=/\//g;function unescapeComponent(component){return-1===component.indexOf("~")?component:component.replace(r1,"/").replace(r2,"~")}function escapeComponent(component){return-1===component.indexOf("/")&&-1===component.indexOf("~")?component:component.replace(r3,"~0").replace(r4,"~1")}function parseJsonPointer(pointer){return pointer?pointer.slice(1).split("/").map(unescapeComponent):[]}exports.unescapeComponent=unescapeComponent,exports.escapeComponent=escapeComponent,exports.parseJsonPointer=parseJsonPointer,exports.formatJsonPointer=function formatJsonPointer(path){return(0,exports.isRoot)(path)?"":"/"+path.map((component=>escapeComponent(String(component)))).join("/")};exports.toPath=pointer=>"string"==typeof pointer?parseJsonPointer(pointer):pointer,exports.isChild=function isChild(parent,child){if(parent.length>=child.length)return!1;for(let i=0;i<parent.length;i++)if(parent[i]!==child[i])return!1;return!0},exports.isPathEqual=function isPathEqual(p1,p2){if(p1.length!==p2.length)return!1;for(let i=0;i<p1.length;i++)if(p1[i]!==p2[i])return!1;return!0};exports.isRoot=path=>!path.length,exports.parent=function parent(path){if(path.length<1)throw new Error("NO_PARENT");return path.slice(0,path.length-1)},exports.isValidIndex=function isValidIndex(index){if("number"==typeof index)return!0;const n=parseInt(index,10);return String(n)===index&&n>=0};exports.isInteger=str=>{const len=str.length;let charCode,i=0;for(;i<len;){if(charCode=str.charCodeAt(i),!(charCode>=48&&charCode<=57))return!1;i++}return!0}},"./node_modules/json-joy/es2020/json-pointer/validate.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validatePath=exports.validateJsonPointer=void 0;exports.validateJsonPointer=pointer=>{if("string"==typeof pointer){if(pointer){if("/"!==pointer[0])throw new Error("POINTER_INVALID");if(pointer.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,exports.validatePath)(pointer)};const{isArray}=Array;exports.validatePath=path=>{if(!isArray(path))throw new Error("Invalid path.");if(path.length>256)throw new Error("Path too long.");for(const step of path)switch(typeof step){case"string":case"number":continue;default:throw new Error("Invalid path step.")}}},"./node_modules/json-joy/es2020/json-text/stringify.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stringify=void 0;exports.stringify=(value,spacing=" ")=>{switch(value){case null:return"!n";case void 0:return"!u";case!0:return"!t";case!1:return"!f"}if(Array.isArray(value))return`[${spacing}${value.map((v=>(0,exports.stringify)(v,spacing))).join(","+spacing)}${spacing}]`;if(value instanceof Uint8Array)return`${value}`;switch(typeof value){case"number":return`${value}`;case"string":return JSON.stringify(value);case"object":{const keys=Object.keys(value);return`{${spacing}${keys.map((k=>`${k}${spacing}=${spacing}${(0,exports.stringify)(value[k],spacing)}`)).join(","+spacing)}${spacing}}`}}return"?"}},"./node_modules/json-joy/es2020/util/buffers/Reader.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Reader=void 0;const decodeUtf8_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/index.js");exports.Reader=class Reader{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(uint8){this.x=0,this.uint8=uint8,this.view=new DataView(uint8.buffer,uint8.byteOffset,uint8.length)}peak(){return this.view.getUint8(this.x)}skip(length){this.x+=length}buf(size){const end=this.x+size,bin=this.uint8.subarray(this.x,end);return this.x=end,bin}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let x=this.x;const num=(this.uint8[x++]<<8)+this.uint8[x++];return this.x=x,num}i16(){const num=this.view.getInt16(this.x);return this.x+=2,num}u32(){const num=this.view.getUint32(this.x);return this.x+=4,num}i32(){const num=this.view.getInt32(this.x);return this.x+=4,num}u64(){const num=this.view.getBigUint64(this.x);return this.x+=8,num}i64(){const num=this.view.getBigInt64(this.x);return this.x+=8,num}f32(){const pos=this.x;return this.x+=4,this.view.getFloat32(pos)}f64(){const pos=this.x;return this.x+=8,this.view.getFloat64(pos)}utf8(size){const start=this.x;return this.x+=size,(0,decodeUtf8_1.decodeUtf8)(this.uint8,start,size)}ascii(length){const uint8=this.uint8;let str="";const end=this.x+length;for(let i=this.x;i<end;i++)str+=String.fromCharCode(uint8[i]);return this.x=end,str}}},"./node_modules/json-joy/es2020/util/buffers/Slice.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Slice=void 0;exports.Slice=class Slice{constructor(uint8,view,start,end){this.uint8=uint8,this.view=view,this.start=start,this.end=end}subarray(){return this.uint8.subarray(this.start,this.end)}}},"./node_modules/json-joy/es2020/util/buffers/Writer.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Writer=void 0;const Slice_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/Slice.js"),EMPTY_UINT8=new Uint8Array([]),EMPTY_VIEW=new DataView(EMPTY_UINT8.buffer),hasBuffer="function"==typeof Buffer,utf8Write=hasBuffer?Buffer.prototype.utf8Write:null,from=hasBuffer?Buffer.from:null,textEncoder="undefined"!=typeof TextEncoder?new TextEncoder:null;exports.Writer=class Writer{constructor(allocSize=65536){this.allocSize=allocSize,this.view=EMPTY_VIEW,this.x0=0,this.x=0,this.uint8=new Uint8Array(allocSize),this.size=allocSize,this.view=new DataView(this.uint8.buffer)}grow(size){const x0=this.x0,x=this.x,oldUint8=this.uint8,newUint8=new Uint8Array(size),view=new DataView(newUint8.buffer),activeSlice=oldUint8.subarray(x0,x);newUint8.set(activeSlice,0),this.x=x-x0,this.x0=0,this.uint8=newUint8,this.size=size,this.view=view}ensureCapacity(capacity){const byteLength=this.size,remaining=byteLength-this.x;if(remaining<capacity){const totalRequired=byteLength-this.x0+(capacity-remaining);this.grow(totalRequired<=this.allocSize?this.allocSize:2*totalRequired)}}move(capacity){this.ensureCapacity(capacity),this.x+=capacity}reset(){this.x0=this.x}newBuffer(size){const uint8=this.uint8=new Uint8Array(size);this.size=size,this.view=new DataView(uint8.buffer),this.x=this.x0=0}flush(){const result=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,result}flushSlice(){const slice=new Slice_1.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,slice}u8(char){this.ensureCapacity(1),this.uint8[this.x++]=char}u16(word){this.ensureCapacity(2),this.view.setUint16(this.x,word),this.x+=2}u32(dword){this.ensureCapacity(4),this.view.setUint32(this.x,dword),this.x+=4}i32(dword){this.ensureCapacity(4),this.view.setInt32(this.x,dword),this.x+=4}u64(qword){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(qword)),this.x+=8}f64(float){this.ensureCapacity(8),this.view.setFloat64(this.x,float),this.x+=8}u8u16(u8,u16){this.ensureCapacity(3);let x=this.x;this.uint8[x++]=u8,this.uint8[x++]=u16>>>8,this.uint8[x++]=255&u16,this.x=x}u8u32(u8,u32){this.ensureCapacity(5);let x=this.x;this.uint8[x++]=u8,this.view.setUint32(x,u32),this.x=x+4}u8u64(u8,u64){this.ensureCapacity(9);let x=this.x;this.uint8[x++]=u8,this.view.setBigUint64(x,BigInt(u64)),this.x=x+8}u8f32(u8,f32){this.ensureCapacity(5);let x=this.x;this.uint8[x++]=u8,this.view.setFloat32(x,f32),this.x=x+4}u8f64(u8,f64){this.ensureCapacity(9);let x=this.x;this.uint8[x++]=u8,this.view.setFloat64(x,f64),this.x=x+8}buf(buf,length){this.ensureCapacity(length);const x=this.x;this.uint8.set(buf,x),this.x=x+length}utf8(str){const maxLength=4*str.length;if(maxLength<168)return this.utf8Native(str);if(utf8Write){const writeLength=utf8Write.call(this.uint8,str,this.x,maxLength);return this.x+=writeLength,writeLength}if(from){const uint8=this.uint8,offset=uint8.byteOffset+this.x,writeLength=from(uint8.buffer).subarray(offset,offset+maxLength).write(str,0,maxLength,"utf8");return this.x+=writeLength,writeLength}if(maxLength>1024&&textEncoder){const writeLength=textEncoder.encodeInto(str,this.uint8.subarray(this.x,this.x+maxLength)).written;return this.x+=writeLength,writeLength}return this.utf8Native(str)}utf8Native(str){const length=str.length,uint8=this.uint8;let offset=this.x,pos=0;for(;pos<length;){let value=str.charCodeAt(pos++);if(0!=(4294967168&value)){if(0==(4294965248&value))uint8[offset++]=value>>6&31|192;else{if(value>=55296&&value<=56319&&pos<length){const extra=str.charCodeAt(pos);56320==(64512&extra)&&(pos++,value=((1023&value)<<10)+(1023&extra)+65536)}0==(4294901760&value)?(uint8[offset++]=value>>12&15|224,uint8[offset++]=value>>6&63|128):(uint8[offset++]=value>>18&7|240,uint8[offset++]=value>>12&63|128,uint8[offset++]=value>>6&63|128)}uint8[offset++]=63&value|128}else uint8[offset++]=value}const writeLength=offset-this.x;return this.x=offset,writeLength}ascii(str){const length=str.length;this.ensureCapacity(length);const uint8=this.uint8;let offset=this.x,pos=0;for(;pos<length;)uint8[offset++]=str.charCodeAt(pos++);this.x=offset}}},"./node_modules/json-joy/es2020/util/buffers/f16.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeF16=void 0;const pow=Math.pow;exports.decodeF16=binary=>{const exponent=(31744&binary)>>10,fraction=1023&binary;return(binary>>15?-1:1)*(exponent?31===exponent?fraction?NaN:1/0:pow(2,exponent-15)*(1+fraction/1024):fraction/1024*6103515625e-14)}},"./node_modules/json-joy/es2020/util/buffers/isFloat32.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isFloat32=void 0;const view=new DataView(new ArrayBuffer(4));exports.isFloat32=n=>(view.setFloat32(0,n),n===view.getFloat32(0))},"./node_modules/json-joy/es2020/util/buffers/isUint8Array.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isUint8Array=void 0,exports.isUint8Array="function"==typeof Buffer?x=>x instanceof Uint8Array||Buffer.isBuffer(x):x=>x instanceof Uint8Array},"./node_modules/json-joy/es2020/util/buffers/utf8/CachedUtf8Decoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CachedUtf8Decoder=void 0;const v10_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importDefault(__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/v10.js")),randomU32_1=__webpack_require__("./node_modules/hyperdyperid/lib/randomU32.js");class CacheItem{constructor(bytes,value){this.bytes=bytes,this.value=value}}exports.CachedUtf8Decoder=class CachedUtf8Decoder{constructor(){this.caches=[];for(let i=0;i<31;i++)this.caches.push([])}get(bytes,offset,size){const records=this.caches[size-1],len=records.length;FIND_CHUNK:for(let i=0;i<len;i++){const record=records[i],recordBytes=record.bytes;for(let j=0;j<size;j++)if(recordBytes[j]!==bytes[offset+j])continue FIND_CHUNK;return record.value}return null}store(bytes,value){const records=this.caches[bytes.length-1],record=new CacheItem(bytes,value);records.length>=16?records[(0,randomU32_1.randomU32)(0,15)]=record:records.push(record)}decode(bytes,offset,size){if(!size)return"";const cachedValue=this.get(bytes,offset,size);if(null!==cachedValue)return cachedValue;const value=(0,v10_1.default)(bytes,offset,size),copy=Uint8Array.prototype.slice.call(bytes,offset,offset+size);return this.store(copy,value),value}}},"./node_modules/json-joy/es2020/util/buffers/utf8/decodeAscii.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeAsciiMax15=exports.decodeAscii=void 0;const fromCharCode=String.fromCharCode;exports.decodeAscii=(src,position,length)=>{const bytes=[];for(let i=0;i<length;i++){const byte=src[position++];if(128&byte)return;bytes.push(byte)}return fromCharCode.apply(String,bytes)};exports.decodeAsciiMax15=(src,position,length)=>{if(length<4){if(length<2){if(0===length)return"";{const a=src[position++];return(128&a)>1?void(position-=1):fromCharCode(a)}}{const a=src[position++],b=src[position++];if((128&a)>0||(128&b)>0)return void(position-=2);if(length<3)return fromCharCode(a,b);const c=src[position++];return(128&c)>0?void(position-=3):fromCharCode(a,b,c)}}{const a=src[position++],b=src[position++],c=src[position++],d=src[position++];if((128&a)>0||(128&b)>0||(128&c)>0||(128&d)>0)return void(position-=4);if(length<6){if(4===length)return fromCharCode(a,b,c,d);{const e=src[position++];return(128&e)>0?void(position-=5):fromCharCode(a,b,c,d,e)}}if(length<8){const e=src[position++],f=src[position++];if((128&e)>0||(128&f)>0)return void(position-=6);if(length<7)return fromCharCode(a,b,c,d,e,f);const g=src[position++];return(128&g)>0?void(position-=7):fromCharCode(a,b,c,d,e,f,g)}{const e=src[position++],f=src[position++],g=src[position++],h=src[position++];if((128&e)>0||(128&f)>0||(128&g)>0||(128&h)>0)return void(position-=8);if(length<10){if(8===length)return fromCharCode(a,b,c,d,e,f,g,h);{const i=src[position++];return(128&i)>0?void(position-=9):fromCharCode(a,b,c,d,e,f,g,h,i)}}if(length<12){const i=src[position++],j=src[position++];if((128&i)>0||(128&j)>0)return void(position-=10);if(length<11)return fromCharCode(a,b,c,d,e,f,g,h,i,j);const k=src[position++];return(128&k)>0?void(position-=11):fromCharCode(a,b,c,d,e,f,g,h,i,j,k)}{const i=src[position++],j=src[position++],k=src[position++],l=src[position++];if((128&i)>0||(128&j)>0||(128&k)>0||(128&l)>0)return void(position-=12);if(length<14){if(12===length)return fromCharCode(a,b,c,d,e,f,g,h,i,j,k,l);{const m=src[position++];return(128&m)>0?void(position-=13):fromCharCode(a,b,c,d,e,f,g,h,i,j,k,l,m)}}{const m=src[position++],n=src[position++];if((128&m)>0||(128&n)>0)return void(position-=14);if(length<15)return fromCharCode(a,b,c,d,e,f,g,h,i,j,k,l,m,n);const o=src[position++];return(128&o)>0?void(position-=15):fromCharCode(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o)}}}}}},"./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeUtf8=void 0;const v16_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs").__importDefault(__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/v16.js"));exports.decodeUtf8=v16_1.default},"./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/v10.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const fromCharCode=String.fromCharCode;exports.default=(buf,start,length)=>{let offset=start;const end=offset+length;let str="";for(;offset<end;){const octet1=buf[offset++];if(0==(128&octet1)){str+=fromCharCode(octet1);continue}const octet2=63&buf[offset++];if(192==(224&octet1)){str+=fromCharCode((31&octet1)<<6|octet2);continue}const octet3=63&buf[offset++];if(224!=(240&octet1))if(240==(248&octet1)){let unit=(7&octet1)<<18|octet2<<12|octet3<<6|63&buf[offset++];if(unit>65535){unit-=65536;const unit0=unit>>>10&1023|55296;unit=56320|1023&unit,str+=fromCharCode(unit0,unit)}else str+=fromCharCode(unit)}else str+=fromCharCode(octet1);else str+=fromCharCode((31&octet1)<<12|octet2<<6|octet3)}return str}},"./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/v16.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),decodeAscii_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/decodeAscii.js"),v18_1=tslib_1.__importDefault(__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/v18.js")),hasBuffer="undefined"!=typeof Buffer,utf8Slice=hasBuffer?Buffer.prototype.utf8Slice:null,from=hasBuffer?Buffer.from:null,longDecoder=utf8Slice?(buf,start,length)=>utf8Slice.call(buf,start,start+length):from?(buf,start,length)=>from(buf).subarray(start,start+length).toString("utf8"):v18_1.default;exports.default=(buf,start,length)=>length<16?((buf,start,length)=>(0,decodeAscii_1.decodeAsciiMax15)(buf,start,length)??(0,v18_1.default)(buf,start,length))(buf,start,length):length<32?((buf,start,length)=>(0,decodeAscii_1.decodeAscii)(buf,start,length)??(0,v18_1.default)(buf,start,length))(buf,start,length):longDecoder(buf,start,length)},"./node_modules/json-joy/es2020/util/buffers/utf8/decodeUtf8/v18.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const fromCharCode=String.fromCharCode;exports.default=(buf,start,length)=>{let offset=start;const end=offset+length,points=[];for(;offset<end;){let code=buf[offset++];if(0!=(128&code)){const octet2=63&buf[offset++];if(192==(224&code))code=(31&code)<<6|octet2;else{const octet3=63&buf[offset++];if(224==(240&code))code=(31&code)<<12|octet2<<6|octet3;else if(240==(248&code)){let unit=(7&code)<<18|octet2<<12|octet3<<6|63&buf[offset++];if(unit>65535){unit-=65536;const unit0=unit>>>10&1023|55296;code=56320|1023&unit,points.push(unit0)}else code=unit}}}points.push(code)}return fromCharCode.apply(String,points)}},"./node_modules/json-joy/es2020/util/buffers/utf8/sharedCachedUtf8Decoder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const CachedUtf8Decoder_1=__webpack_require__("./node_modules/json-joy/es2020/util/buffers/utf8/CachedUtf8Decoder.js");exports.default=new CachedUtf8Decoder_1.CachedUtf8Decoder},"./node_modules/json-joy/es2020/util/events/Emitter.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Emitter=void 0;exports.Emitter=class Emitter{constructor(){this.et=new EventTarget}on(type,listener,options){this.et.addEventListener(type,listener,options)}emit(event){return this.et.dispatchEvent(event)}off(type,listener,options){this.et.removeEventListener(type,listener,options)}}},"./node_modules/json-joy/es2020/util/hasOwnProperty.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasOwnProperty=void 0;const has=Object.prototype.hasOwnProperty;exports.hasOwnProperty=function hasOwnProperty(obj,key){return has.call(obj,key)}},"./node_modules/json-joy/es2020/util/print/printBinary.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.printBinary=void 0;exports.printBinary=(tab="",children)=>{const[left,right]=children;let str="";return left&&(str+=`\n${tab}← ${left(tab+"  ")}`),right&&(str+=`\n${tab}→ ${right(tab+"  ")}`),str}},"./node_modules/json-joy/es2020/util/print/printTree.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.printTree=void 0;exports.printTree=(tab="",children)=>{children=children.filter(Boolean);let str="";for(let i=0;i<children.length;i++){const isLast=i>=children.length-1,fn=children[i];if(!fn)continue;const child=fn(tab+(isLast?" ":"│")+"  ");str+=`\n${tab}${child?isLast?"└─":"├─":"│ "} ${child}`}return str}},"./node_modules/json-joy/es2020/util/trees/avl/AvlMap.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AvlMap=exports.AvlNode=void 0;const util_1=__webpack_require__("./node_modules/json-joy/es2020/util/trees/avl/util.js"),printTree_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printTree.js"),util_2=__webpack_require__("./node_modules/json-joy/es2020/util/trees/util.js");class AvlNode{constructor(k,v){this.k=k,this.v=v,this.p=void 0,this.l=void 0,this.r=void 0,this.bf=0}}exports.AvlNode=AvlNode;const defaultComparator=(a,b)=>a===b?0:a<b?-1:1;exports.AvlMap=class AvlMap{constructor(comparator){this.root=void 0,this.comparator=comparator||defaultComparator}insert(k,v){const item=new AvlNode(k,v);return this.root=(0,util_1.insert)(this.root,item,this.comparator),item}set(k,v){const root=this.root;if(!root)return this.insert(k,v);const comparator=this.comparator;let next=root,curr=next,cmp=0;do{if(curr=next,cmp=comparator(k,curr.k),0===cmp)return curr.v=v,curr}while(next=cmp<0?curr.l:curr.r);const node=new AvlNode(k,v);return this.root=cmp<0?(0,util_1.insertLeft)(root,node,curr):(0,util_1.insertRight)(root,node,curr),node}find(k){const comparator=this.comparator;let curr=this.root;for(;curr;){const cmp=comparator(k,curr.k);if(0===cmp)return curr;curr=cmp<0?curr.l:curr.r}}get(k){return this.find(k)?.v}del(k){const node=this.find(k);node&&(this.root=(0,util_1.remove)(this.root,node))}has(k){return!!this.find(k)}getOrNextLower(k){return(0,util_2.findOrNextLower)(this.root,k,this.comparator)||void 0}forEach(fn){const root=this.root;if(!root)return;let curr=(0,util_2.first)(root);do{fn(curr)}while(curr=(0,util_2.next)(curr))}toString(tab){return this.constructor.name+(0,printTree_1.printTree)(tab,[tab=>(0,util_1.print)(this.root,tab)])}}},"./node_modules/json-joy/es2020/util/trees/avl/util.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.print=exports.remove=exports.insert=exports.insertLeft=exports.insertRight=void 0;const stringify_1=__webpack_require__("./node_modules/json-joy/es2020/json-text/stringify.js"),printBinary_1=__webpack_require__("./node_modules/json-joy/es2020/util/print/printBinary.js"),rebalanceAfterInsert=(root,node,child)=>{const p=node.p;if(!p)return root;const isLeft=node===p.l;let bf=0|p.bf;switch(p.bf=isLeft?++bf:--bf,bf){case 0:return root;case 1:case-1:return rebalanceAfterInsert(root,p,node);default:{const isChildLeft=child===node.l;return isLeft?isChildLeft?(llRotate(p,node),node.p?root:node):(lrRotate(p,node,child),child.p?root:child):isChildLeft?(rlRotate(p,node,child),child.p?root:child):(rrRotate(p,node),node.p?root:node)}}},llRotate=(n,nl)=>{const p=n.p,nlr=nl.r;nl.p=p,nl.r=n,n.p=nl,n.l=nlr,nlr&&(nlr.p=n),p&&(p.l===n?p.l=nl:p.r=nl);let nbf=n.bf,nlbf=nl.bf;nbf+=-1-(nlbf>0?nlbf:0),nlbf+=-1+(nbf<0?nbf:0),n.bf=nbf,nl.bf=nlbf},rrRotate=(n,nr)=>{const p=n.p,nrl=nr.l;nr.p=p,nr.l=n,n.p=nr,n.r=nrl,nrl&&(nrl.p=n),p&&(p.l===n?p.l=nr:p.r=nr);let nbf=n.bf,nrbf=nr.bf;nbf+=1-(nrbf<0?nrbf:0),nrbf+=1+(nbf>0?nbf:0),n.bf=nbf,nr.bf=nrbf},lrRotate=(n,nl,nlr)=>{rrRotate(nl,nlr),llRotate(n,nlr)},rlRotate=(n,nr,nrl)=>{llRotate(nr,nrl),rrRotate(n,nrl)};exports.insertRight=(root,n,p)=>(p.r=n,n.p=p,p.bf--,p.l?root:rebalanceAfterInsert(root,p,n));exports.insertLeft=(root,n,p)=>(p.l=n,n.p=p,p.bf++,p.r?root:rebalanceAfterInsert(root,p,n));exports.insert=(root,node,comparator)=>{if(!root)return node;const key=node.k;let next,curr=root,cmp=0;for(;next=(cmp=comparator(key,curr.k))<0?curr.l:curr.r;)curr=next;return cmp<0?(0,exports.insertLeft)(root,node,curr):(0,exports.insertRight)(root,node,curr)};exports.remove=(root,n)=>{if(!root)return n;const p=n.p,l=n.l,r=n.r;if(n.p=n.l=n.r=void 0,l&&r){if(l.r){let v=l,tmp=v;for(;tmp=v.r;)v=tmp;const vl=v.l,vp=v.p,vc=vl;return p&&(p.l===n?p.l=v:p.r=v),v.p=p,v.r=r,v.bf=n.bf,l!==v&&(v.l=l,l.p=v),r.p=v,vp&&(vp.l===v?vp.l=vc:vp.r=vc),vc&&(vc.p=vp),rRebalance(p?root:v,vp,1)}{p&&(p.l===n?p.l=l:p.r=l),l.p=p,l.r=r,r.p=l;const nbf=n.bf;if(p)return l.bf=nbf,lRebalance(root,l,1);const lbf=nbf-1;if(l.bf=lbf,lbf>=-1)return l;const rl=r.l;return r.bf>0?(rlRotate(l,r,rl),rl):(rrRotate(l,r),r)}}const c=l||r;return c&&(c.p=p),p?p.l===n?(p.l=c,lRebalance(root,p,1)):(p.r=c,rRebalance(root,p,1)):c};const lRebalance=(root,n,d)=>{let bf=0|n.bf;bf-=d,n.bf=bf;let nextD=d;if(-1===bf)return root;if(bf<-1){const u=n.r;if(u.bf<=0)u.l&&0===u.bf&&(nextD=0),rrRotate(n,u),n=u;else{const ul=u.l;rlRotate(n,u,ul),n=ul}}const p=n.p;return p?p.l===n?lRebalance(root,p,nextD):rRebalance(root,p,nextD):n},rRebalance=(root,n,d)=>{let bf=0|n.bf;bf+=d,n.bf=bf;let nextD=d;if(1===bf)return root;if(bf>1){const u=n.l;if(u.bf>=0)u.r&&0===u.bf&&(nextD=0),llRotate(n,u),n=u;else{const ur=u.r;lrRotate(n,u,ur),n=ur}}const p=n.p;return p?p.l===n?lRebalance(root,p,nextD):rRebalance(root,p,nextD):n};exports.print=(node,tab="")=>{if(!node)return"∅";const{bf,l,r,k,v}=node,content=void 0!==k?` { ${(0,stringify_1.stringify)(k)} = ${(0,stringify_1.stringify)(v)} }`:"",bfFormatted=bf?` [${bf}]`:"";return node.constructor.name+`${bfFormatted}`+content+(0,printBinary_1.printBinary)(tab,[l?tab=>(0,exports.print)(l,tab):null,r?tab=>(0,exports.print)(r,tab):null])}},"./node_modules/json-joy/es2020/util/trees/splay/util.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.rlSplay=exports.lrSplay=exports.llSplay=exports.rrSplay=exports.lSplay=exports.rSplay=exports.splay=void 0;exports.splay=(root,node,repeat)=>{const p=node.p;if(!p)return root;const pp=p.p,l2=p.l===node;if(!pp)return l2?(0,exports.rSplay)(node,p):(0,exports.lSplay)(node,p),node;return root=pp.l===p?l2?(0,exports.llSplay)(root,node,p,pp):(0,exports.lrSplay)(root,node,p,pp):l2?(0,exports.rlSplay)(root,node,p,pp):(0,exports.rrSplay)(root,node,p,pp),repeat>1?(0,exports.splay)(root,node,repeat-1):root};exports.rSplay=(c2,c1)=>{const b=c2.r;c2.p=void 0,c2.r=c1,c1.p=c2,c1.l=b,b&&(b.p=c1)};exports.lSplay=(c2,c1)=>{const b=c2.l;c2.p=void 0,c2.l=c1,c1.p=c2,c1.r=b,b&&(b.p=c1)};exports.rrSplay=(root,c3,c2,c1)=>{const b=c2.l,c=c3.l,p=c1.p;return c3.p=p,c3.l=c2,c2.p=c3,c2.l=c1,c2.r=c,c1.p=c2,c1.r=b,b&&(b.p=c1),c&&(c.p=c2),p?p.l===c1?p.l=c3:p.r=c3:root=c3,root};exports.llSplay=(root,c3,c2,c1)=>{const b=c2.r,c=c3.r,p=c1.p;return c3.p=p,c3.r=c2,c2.p=c3,c2.l=c,c2.r=c1,c1.p=c2,c1.l=b,b&&(b.p=c1),c&&(c.p=c2),p?p.l===c1?p.l=c3:p.r=c3:root=c3,root};exports.lrSplay=(root,c3,c2,c1)=>{const c=c3.l,d=c3.r,p=c1.p;return c3.p=p,c3.l=c2,c3.r=c1,c2.p=c3,c2.r=c,c1.p=c3,c1.l=d,c&&(c.p=c2),d&&(d.p=c1),p?p.l===c1?p.l=c3:p.r=c3:root=c3,root};exports.rlSplay=(root,c3,c2,c1)=>{const c=c3.r,d=c3.l,p=c1.p;return c3.p=p,c3.l=c1,c3.r=c2,c2.p=c3,c2.l=c,c1.p=c3,c1.r=d,c&&(c.p=c2),d&&(d.p=c1),p?p.l===c1?p.l=c3:p.r=c3:root=c3,root}},"./node_modules/json-joy/es2020/util/trees/splay/util2.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.splay2=void 0;exports.splay2=(root,node)=>{const p=node.p2;if(!p)return root;const pp=p.p2,l2=p.l2===node;if(!pp)return l2?rSplay2(node,p):lSplay2(node,p),node;return root=pp.l2===p?l2?llSplay2(root,node,p,pp):lrSplay2(root,node,p,pp):l2?rlSplay2(root,node,p,pp):rrSplay2(root,node,p,pp),(0,exports.splay2)(root,node)};const rSplay2=(c2,c1)=>{const b=c2.r2;c2.p2=void 0,c2.r2=c1,c1.p2=c2,c1.l2=b,b&&(b.p2=c1)},lSplay2=(c2,c1)=>{const b=c2.l2;c2.p2=void 0,c2.l2=c1,c1.p2=c2,c1.r2=b,b&&(b.p2=c1)},rrSplay2=(root,c3,c2,c1)=>{const b=c2.l2,c=c3.l2,p=c1.p2;return c3.p2=p,c3.l2=c2,c2.p2=c3,c2.l2=c1,c2.r2=c,c1.p2=c2,c1.r2=b,b&&(b.p2=c1),c&&(c.p2=c2),p?p.l2===c1?p.l2=c3:p.r2=c3:root=c3,root},llSplay2=(root,c3,c2,c1)=>{const b=c2.r2,c=c3.r2,p=c1.p2;return c3.p2=p,c3.r2=c2,c2.p2=c3,c2.l2=c,c2.r2=c1,c1.p2=c2,c1.l2=b,b&&(b.p2=c1),c&&(c.p2=c2),p?p.l2===c1?p.l2=c3:p.r2=c3:root=c3,root},lrSplay2=(root,c3,c2,c1)=>{const c=c3.l2,d=c3.r2,p=c1.p2;return c3.p2=p,c3.l2=c2,c3.r2=c1,c2.p2=c3,c2.r2=c,c1.p2=c3,c1.l2=d,c&&(c.p2=c2),d&&(d.p2=c1),p?p.l2===c1?p.l2=c3:p.r2=c3:root=c3,root},rlSplay2=(root,c3,c2,c1)=>{const c=c3.r2,d=c3.l2,p=c1.p2;return c3.p2=p,c3.l2=c1,c3.r2=c2,c2.p2=c3,c2.l2=c,c1.p2=c3,c1.r2=d,c&&(c.p2=c2),d&&(d.p2=c1),p?p.l2===c1?p.l2=c3:p.r2=c3:root=c3,root}},"./node_modules/json-joy/es2020/util/trees/util.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.remove=exports.insert=exports.insertLeft=exports.insertRight=exports.findOrNextLower=exports.find=exports.size=exports.prev=exports.next=exports.last=exports.first=void 0;exports.first=root=>{let curr=root;for(;curr;){if(!curr.l)return curr;curr=curr.l}return curr};exports.last=root=>{let curr=root;for(;curr;){if(!curr.r)return curr;curr=curr.r}return curr};exports.next=curr=>{if(curr.r){for(curr=curr.r;curr.l;)curr=curr.l;return curr}let p=curr.p;for(;p&&p.r===curr;)curr=p,p=p.p;return p};exports.prev=curr=>{if(curr.l){for(curr=curr.l;curr.r;)curr=curr.r;return curr}let p=curr.p;for(;p&&p.l===curr;)curr=p,p=p.p;return p};exports.size=root=>{if(!root)return 0;let curr=(0,exports.first)(root),result=1;for(;curr=(0,exports.next)(curr);)result++;return result};exports.find=(root,key,comparator)=>{let curr=root;for(;curr;){const cmp=comparator(key,curr.k);if(0===cmp)return curr;curr=cmp<0?curr.l:curr.r}return curr};exports.findOrNextLower=(root,key,comparator)=>{let result,curr=root;for(;curr;){const cmp=comparator(curr.k,key);if(0===cmp)return curr;if(cmp>0)curr=curr.l;else{const next=curr.r;if(result=curr,!next)return result;curr=next}}return result};exports.insertRight=(node,p)=>{const r=node.r=p.r;p.r=node,node.p=p,r&&(r.p=node)};exports.insertLeft=(node,p)=>{const l=node.l=p.l;p.l=node,node.p=p,l&&(l.p=node)};exports.insert=(root,node,comparator)=>{if(!root)return node;const key=node.k;let curr=root;for(;curr;){const cmp=comparator(key,curr.k),next=cmp<0?curr.l:curr.r;if(!next){cmp<0?(0,exports.insertLeft)(node,curr):(0,exports.insertRight)(node,curr);break}curr=next}return root};exports.remove=(root,node)=>{const p=node.p,l=node.l,r=node.r;if(node.p=node.l=node.r=void 0,!l&&!r){if(!p)return;return p.l===node?p.l=void 0:p.r=void 0,root}if(l&&r){let mostRightChildFromLeft=l;for(;mostRightChildFromLeft.r;)mostRightChildFromLeft=mostRightChildFromLeft.r;return mostRightChildFromLeft.r=r,r.p=mostRightChildFromLeft,p?(p.l===node?p.l=l:p.r=l,l.p=p,root):(l.p=void 0,l)}const child=l||r;return child.p=p,p?(p.l===node?p.l=child:p.r=child,root):child}},"./node_modules/json-joy/es2020/util/trees/util2.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.remove2=exports.insert2=exports.prev2=exports.next2=exports.last2=exports.first2=void 0;exports.first2=root=>{let curr=root;for(;curr;){if(!curr.l2)return curr;curr=curr.l2}return curr};exports.last2=root=>{let curr=root;for(;curr;){if(!curr.r2)return curr;curr=curr.r2}return curr};exports.next2=curr=>{if(curr.r2){for(curr=curr.r2;curr.l2;)curr=curr.l2;return curr}let p=curr.p2;for(;p&&p.r2===curr;)curr=p,p=p.p2;return p};exports.prev2=curr=>{if(curr.l2){for(curr=curr.l2;curr.r2;)curr=curr.r2;return curr}let p=curr.p2;for(;p&&p.l2===curr;)curr=p,p=p.p2;return p};const insertRight2=(node,p)=>{const r=node.r2=p.r2;p.r2=node,node.p2=p,r&&(r.p2=node)},insertLeft2=(node,p)=>{const l=node.l2=p.l2;p.l2=node,node.p2=p,l&&(l.p2=node)};exports.insert2=(root,node,comparator)=>{if(!root)return node;let curr=root;for(;curr;){const cmp=comparator(node,curr),next=cmp<0?curr.l2:curr.r2;if(!next){cmp<0?insertLeft2(node,curr):insertRight2(node,curr);break}curr=next}return root};exports.remove2=(root,node)=>{const p=node.p2,l=node.l2,r=node.r2;if(node.p2=node.l2=node.r2=void 0,!l&&!r){if(!p)return;return p.l2===node?p.l2=void 0:p.r2=void 0,root}if(l&&r){let mostRightChildFromLeft=l;for(;mostRightChildFromLeft.r2;)mostRightChildFromLeft=mostRightChildFromLeft.r2;return mostRightChildFromLeft.r2=r,r.p2=mostRightChildFromLeft,p?(p.l2===node?p.l2=l:p.r2=l,l.p2=p,root):(l.p2=void 0,l)}const child=l||r;return child.p2=p,p?(p.l2===node?p.l2=child:p.r2=child,root):child}},"./node_modules/json-joy/node_modules/thingies/es2020/fanout.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FanOut=void 0;exports.FanOut=class FanOut{constructor(){this.listeners=new Set}emit(data){this.listeners.forEach((listener=>listener(data)))}listen(listener){const listeners=this.listeners;return listeners.add(listener),()=>listeners.delete(listener)}}}}]);